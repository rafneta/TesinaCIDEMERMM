<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>y1996</title>

<script src="site_libs/header-attrs-2.5/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="estilo.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Tesina CIDE-ME Rafael Martínez-Martínez</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Estimacion.html">Estimación</a>
</li>
<li>
  <a href="ESRU2017.html">Datos ESRU - EMOVI</a>
</li>
<li>
  <a href="AA.html">Aprendizaje Automático</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">y1996</h1>

</div>


<pre class="r"><code>library(tidyverse)#filter, mutate, select, between (PIPES)
library(haven) # importa, entre otros software, de Stata
library(sjlabelled) # manejar labels de las variables 
library(openxlsx) # leer archivos de excel
library(DT) # visualizar a tablas
library(data.table) # convertir a tablas
library(highcharter) # gráficas interactivas
library(foreign)# lee archivos .dbf
library(stargazer)#tablas bonitas
library(ggplot2)#matplotlib de R
library(dplyr)#new_mtcars &lt;- mtcars %&gt;%  rename(miles_g = mpg,cylinder = cyl)</code></pre>
<div id="encuesta-nacional-de-ingresos-y-gasto-de-hogares-1996" class="section level1">
<h1>Encuesta nacional de ingresos y gasto de hogares 1996</h1>
<pre class="r"><code>poblacion&lt;-read.dbf(
              file=&quot;Datos/POBLA96.dbf&quot;
              )
poblacion &lt;- poblacion %&gt;% 
                rename(
                  parentesco = PARENTESCO,
                  folio = FOLIO,
                  num_ren = NUM_REN,
                  sexo = SEXO,
                  edad = EDAD,
                  per_ing=PER_ING,
                  ed_formal=ED_FORMAL,
                  ed_tecnica=ED_TECNICA,
                  ocupacion=OCUPACION
                  )
poblacion</code></pre>
<pre class="r"><code>poblacion_e96&lt;-poblacion%&gt;%
  filter(
    parentesco == &quot;01&quot;,#en el 98 era &quot;01&quot;
    between(edad,30,50),
    !is.na(ed_formal),
    !is.na(ed_tecnica),
    !is.na(ocupacion),
    N_EMPLEOS==1, # el entrevistado solo proporciona una ocupación
  )%&gt;%
  select(
    folio,
    num_ren,
    edad,
    sexo,
    ed_formal,
    ed_tecnica,
    ocupacion
  )%&gt;%
 mutate(
  ed_formal = as.integer(as.character(ed_formal)),
   ed_tecnica= as.integer(as.character(ed_tecnica)),
  estado = substr(folio,5,6)
 )</code></pre>
<pre class="r"><code>#En 1998 para hijos es &quot;04&quot; y &quot;05&quot;. En 1996 &quot;4&quot; abarca todos los hijos
#En 1998 se considera edad&lt;=18, en 1996 se considera edad&lt;=14
folios96&lt;-as.character(poblacion%&gt;%filter(parentesco %in% c(&quot;04&quot;,&quot;05&quot;),edad&lt;=18)%&gt;%select(folio)%&gt;%pull())
poblacion_e96&lt;-poblacion_e96%&gt;%filter(folio %in%  folios96 )</code></pre>
<pre class="r"><code>nrow(poblacion_e96)
head(poblacion_e96$ed_formal)
str(poblacion_e96$ed_formal)#caracter 2 espacios
unique(poblacion_e96$ed_formal)</code></pre>
<pre class="r"><code>head(poblacion_e96$ed_tecnica)
str(poblacion_e96$ed_tecnica)#caracter 1 espacio
unique(poblacion_e96$ed_tecnica)

names(poblacion_e96)
str(poblacion_e96$per_ing)</code></pre>
<pre class="r"><code># hacemos la codificación de ENIGH2018 a ESRU
# 1 Preescolar o kínder
# 2 Primaria
# 3 Secundaria técnica
# 4 Secundaria general
# 5 Preparatoria técnica
# 6 Preparatoria general
# 7 Técnica o comercial con secundaria
# 8 Técnica o comercial con preparatoria
# 9 Normal básica (con primaria o secundari
# 10 Normal de licenciatura
# 11 Profesional (licenciatura o ingeniería)
# 12 Postgrado (maestría o doctorado)
#_____________________________________________________
# 96 NS, no aplica porque pedimos la edución del pp como instrumento
comb&lt;-poblacion_e96%&gt;%
   mutate( combi = paste(as.character(ed_formal),as.character(ed_tecnica)))%&gt;%
  select(ed_formal,ed_tecnica,combi)
comb
sort(unique(comb$combi))</code></pre>
<pre class="r"><code>poblacion_e96c&lt;-poblacion_e96%&gt;%
   mutate(
   edu_a = ifelse(ed_formal==0 &amp; ed_tecnica==0,0,    #sin instruccion(1)
          ifelse((ed_formal %in% c(2:13)) &amp; (ed_tecnica %in% c(0,2,3)),ed_formal,
          ifelse((ed_formal %in% c(7:13)) &amp; (ed_tecnica %in% c(4,5,6,8)),ed_formal+1,
          ifelse(ed_formal==14 &amp; (ed_tecnica %in% c(0,2,4,5,6,8)),17,19))))
)</code></pre>
<pre class="r"><code>poblacion_e96c&lt;-poblacion_e96c%&gt;%
   mutate(
   edu_ac = ifelse(edu_a %in% 0:5,&quot;C1&quot;,    
          ifelse(edu_a %in% 6:10 ,&quot;C2&quot;,
          ifelse(edu_a %in% 11:12,&quot;C3&quot;,
          ifelse(edu_a %in% 13:14,&quot;C4&quot;,&quot;C5&quot;))))
  )</code></pre>
<pre class="r"><code>poblacion_e96c&lt;-poblacion_e96c%&gt;%
          mutate(
            region = ifelse(estado %in% c(&quot;02&quot;,&quot;26&quot;,&quot;08&quot;,&quot;05&quot;,&quot;19&quot;,&quot;28&quot;),1,
                ifelse(estado %in% c(&quot;12&quot;,&quot;20&quot;,&quot;07&quot;,&quot;30&quot;,&quot;27&quot;,&quot;04&quot;,&quot;31&quot;,&quot;23&quot;),4,
                ifelse(estado %in% c(&quot;03&quot;,&quot;25&quot;,&quot;18&quot;,&quot;10&quot;,&quot;32&quot;,&quot;16&quot;,&quot;06&quot;,&quot;14&quot;,&quot;01&quot;,&quot;24&quot;),2,3)))
          )</code></pre>
<div id="ingresos-96" class="section level2">
<h2>Ingresos 96</h2>
<pre class="r"><code>ingresos&lt;-read.dbf(
              file=&quot;Datos/ingresos.dbf&quot;
              )</code></pre>
<pre class="r"><code>familias_integrantes &lt;- function(df,nr){
  dfn &lt;- df %&gt;%
    filter(NUM_REN %in% nr)
  return(dfn)
}</code></pre>
<pre class="r"><code>ingresos_acu &lt;- function(df,clavs){
 dfn &lt;- df %&gt;%
   group_by(FOLIO, NUM_REN) %&gt;%
   filter(CLAVE %in% clavs)%&gt;%
   summarise(
   claves_a = paste(CLAVE,collapse = &quot;,&quot;),
  ing_tri_t = sum(ING_TRI),
  ing_men_p = ing_tri_t/3,
  ling_men_p = log(ing_men_p)
  ) %&gt;% ungroup()
 
 
 return(dfn)
}</code></pre>
<pre class="r"><code>#hogares &lt;- c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;)
personas_h &lt;- c(&#39;01&#39;)

a&lt;-familias_integrantes(ingresos,personas_h)
head(a)
#P001 Sueldos, salarios, jornal y horas extras 
#P002 Comisiones, propinas y destajo 
#P010:P018 de 1998 son las mismas que P006:P014 de 1996
#P020:P021 de 1998 son las mismas que P016:P017 de 1996
#P026 de 1998 es la misma que P022 de 1996, aunque no hay equivalente en 1996 a la P027 de 1998
#P035 de 1998 es la misma que P030 de 1996
#P040:P042 de 1998 son las mismas que P035:P037 de 1996
#P044:P045 de 1998 son las mismas que P039:P040 de 1996
claves&lt;-c(&quot;P001&quot;,&quot;P002&quot;,&quot;P006&quot;,&quot;P007&quot;,&quot;P008&quot;,&quot;P009&quot;,&quot;P010&quot;,&quot;P011&quot;, &quot;P012&quot;,&quot;P013&quot;,&quot;P014&quot;,&quot;P016&quot;,&quot;P017&quot;,&quot;P022&quot;,&quot;P030&quot;,&quot;P035&quot;,&quot;P036&quot;,&quot;P037&quot;,&quot;P039&quot;,&quot;P040&quot;)
ingresos_e96&lt;-ingresos_acu(a,claves) 
ingresos_e96&lt;-ingresos_e96%&gt;%
  select(FOLIO,NUM_REN,claves_a,ing_men_p,ling_men_p)%&gt;%
  rename(
    folio = FOLIO,
    num_ren = NUM_REN
  )
head(ingresos_e96)</code></pre>
<pre class="r"><code>enigh_96&lt;-full_join(poblacion_e96c,ingresos_e96)%&gt;%
  drop_na()%&gt;%
   mutate(
     ocupacion = substr(ocupacion,1,2)
   )#%&gt;%
  # rename(
  #   EDU=N_INSTR161,
  #   OCU = CMO121
  # )%&gt;%
  # mutate(
  #   EDU = as.character(EDU)
  # )
head(enigh_96)

unique(enigh_96$edad)

# ajuste para nivel de ecucación ESRU

#data_padres2005$EDU &lt;- factor(data_padres2005$EDU)
#data_padres2005$OCU &lt;- factor(data_padres2005$OCU)

#unique(data_padres2005$OCU)
sum(is.na(enigh_96))
names(enigh_96)

##### Guardamos base de padres final
saveRDS(enigh_96, file=&quot;Datos/enigh_96.Rda&quot;)</code></pre>
<pre class="r"><code>enigh_96X &lt;- readRDS(file = &quot;Datos/enigh_96.Rda&quot;)</code></pre>
</div>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
