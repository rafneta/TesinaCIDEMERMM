<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Rafael Martínez Martínez" />


<title>Datos ESRU-EMOVI</title>

<script src="site_libs/header-attrs-2.5/header-attrs.js"></script>
<script src="site_libs/jquery-3.5.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="site_libs/htmlwidgets-1.5.3.9000/htmlwidgets.js"></script>
<script src="site_libs/proj4js-2.3.15/proj4.js"></script>
<link href="site_libs/highcharts-8.1.2/css/motion.css" rel="stylesheet" />
<script src="site_libs/highcharts-8.1.2/highcharts.js"></script>
<script src="site_libs/highcharts-8.1.2/highcharts-3d.js"></script>
<script src="site_libs/highcharts-8.1.2/highcharts-more.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/stock.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/map.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/annotations.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/data.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/drilldown.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/item-series.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/offline-exporting.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/overlapping-datalabels.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/exporting.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/export-data.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/funnel.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/heatmap.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/treemap.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/sankey.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/dependency-wheel.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/organization.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/solid-gauge.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/streamgraph.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/sunburst.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/vector.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/wordcloud.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/xrange.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/tilemap.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/venn.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/gantt.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/timeline.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/parallel-coordinates.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/bullet.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/coloraxis.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/dumbbell.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/lollipop.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/series-label.js"></script>
<script src="site_libs/highcharts-8.1.2/plugins/motion.js"></script>
<script src="site_libs/highcharts-8.1.2/custom/reset.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/boost.js"></script>
<script src="site_libs/highchart-binding-0.8.2/highchart.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<link rel="stylesheet" href="estilo.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Tesina CIDE-ME Rafael Martínez-Martínez</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Estimacion.html">Estimación</a>
</li>
<li>
  <a href="ESRU2017.html">Datos ESRU - EMOVI 2017</a>
</li>
<li>
  <a href="MMSI2016.html">Datos MMSI 2016</a>
</li>
<li>
  <a href="ENIGH2016.html">Datos ENIGH 2016</a>
</li>
<li>
  <a href="hijos.html">Ingreso Hijos </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Datos ESRU-EMOVI</h1>
<h4 class="author">Rafael Martínez Martínez</h4>

</div>


<div id="justificar">
<p>Los datos se recuperaron del sitio del <a href="https://ceey.org.mx/contenido/que-hacemos/emovi/">CEEY</a> donde se tienen las encuestas ESRU-EMOVI (Las escuestas de la fundación Espinosa Rugarcía de Movilidad Soical en México) para los levantamientos: 2006, 2011 y 2017.</p>
<p>Cada una de las encuentas tiene distintos objetivos, que se explicarán en las siguientes secciones. Para mayores detalles sobre las encuetas se puede consultar el sitio oficial donde se encuetran alojados los datos <a href="https://ceey.org.mx/contenido/que-hacemos/emovi/">CEEY</a>.</p>
</div>
<pre class="r"><code>library(tidyverse)
library(haven) # importa, entre otros software, de Stata
library(sjlabelled) # manejar labels de las variables 
library(openxlsx) # leer archivos de excel
library(DT) # visualizar a tablas
library(data.table) # convertir a tablas
library(highcharter) # gráficas interactivas
library(foreign)</code></pre>
<div id="esru-emovi-2017" class="section level1">
<h1>ESRU-EMOVI 2017</h1>
<div id="justificar">
<p>Por primera vez y gracias al enfoque territorial de la ESRU – EMOVI 2017, es posible medir la movilidad social por regiones. La encuesta de 2017, al igual que las anteriores, tiene como finalidad principal medir la movilidad social intergeneracional. Cuenta con 17,665 entrevistas y es representativa de hombres y mujeres entre 25 y 64 años a nivel nacional, para la Ciudad de México y cinco regiones del país: norte, norte-occidente, centro, centro-norte y sur. Los objetivos de la ESRU-EMOVI 2017 son:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Contar con información actualizada en las distintas dimensiones de la movilidad social a nivel nacional.</p></li>
<li><p>Generar estimaciones de movilidad para cinco regiones del país y la Ciudad de México.</p></li>
<li><p>Analizar los patrones de movilidad social desde la perspectiva de la desigualdad de oportunidades.</p></li>
</ol>
<p>Encuesta financiada por la Fundación ESRU.</p>
</div>
<pre class="r"><code>des_var_entrevistado &lt;- read.xlsx(
                          xlsxFile = &quot;Datos/ESRU-EMOVI-2017/Diccionario-ESRU-EMOVI-2017.xlsx&quot;
                        )
datatable(as.data.table(des_var_entrevistado),options = list(pageLength = 5))</code></pre>
<pre class="r"><code>des_var_hogar &lt;- read.xlsx(
                   xlsxFile = &quot;Datos/ESRU-EMOVI-2017/Diccionario-ESRU-EMOVI-2017.xlsx&quot;,
                   sheet = 2
                 )
datatable(as.data.table(des_var_hogar),options = list(pageLength = 5))</code></pre>
<pre class="r"><code>cargar&lt;- function(){

datos_e &lt;&lt;- read_stata(
                     path = &quot;Datos/ESRU-EMOVI-2017/ESRU-EMOVI-2017-Entrevistado.dta&quot;,
                     atomic.to.fac = TRUE,
                     enc = NULL,
                     )
}

data_hogar &lt;- read_stata(
          path =  &quot;Datos/ESRU-EMOVI-2017/ESRU-EMOVI-2017-Hogar.dta&quot;,
                     atomic.to.fac = TRUE,
                     enc = NULL
                     )

cargar()
data_emovi2017&lt;-datos_e </code></pre>
<div id="justificar">
<p>Al momento de exportar a R, existen errores en las etiqeutas de las variables y de los valores. Las etiquetes de las variables describen con mayor precisión a dichas variables. Mientras que las etiquetas de los volores están asociadas a datos categóricos. Existen diversas formaas de lidiar con este problema. La forma que se utilizará (por el momento, esto se podría optimizar) es hacer una conversión de codificación entre los formatos de windows y mac, solo en caso de ser necesario. No es posible hacer una coversión general (por el momento, podría optimizarse) pues algunas codificaciones son correctas y otras no.</p>
</div>
<pre class="r"><code>#a &lt;- get_label(data_emovi2017$est_dis)
#b &lt;- get_labels(data_emovi2017$Estado)
#print(a)
#print(b)

codi_etiquetas &lt;- function(df_var, enco = &quot;ISO_8859-15&quot;){
return(set_labels(
                          df_var,
                          labels =unlist(
                                      lapply(
                                        get_labels(df_var),
                                        iconv,from= &quot;UTF-8&quot;,
                                        to=enco#
                                        )
                                  )
                      )
)
}

compro_eti &lt;- function(var, enco = &quot;ISO_8859-15&quot; ){
data_e2 &lt;- data_emovi2017
print(get_labels(data_e2[[var]]))
#codi_etiquetas(data_e2$ezona)
data_e2[[var]] &lt;- codi_etiquetas(data_e2[[var]],enco)
print(get_labels(data_e2[[var]]))
}

cambiar_eti &lt;- function(var, enco=&quot;ISO_8859-15&quot;){
data_emovi2017[[var]] &lt;&lt;- codi_etiquetas(data_emovi2017[[var]],enco)
print(get_labels(data_emovi2017[[var]]))
}



#get_labels(data_emovi2017)
#get_labels(data_emovi2017$ezona)
#str(get_labels(data_emovi2017))
#replace_labels(data_emovi2017,
#labels=iconv(get_labels(data_emovi2017),&quot;UTF-8&quot;,&quot;ISO_8859-15&quot;))
#lapply(get_labels(data_emovi2017), iconv,from= &quot;UTF-8&quot;,to=&quot;ISO_8859-15&quot;)

#get_labels(data_emovi2017$ezona)
#data_e2 &lt;- data_emovi2017
#print(get_labels(data_e2[&#39;ezona&#39;]))
#codi_etiquetas(data_e2$ezona)
#data_e2[&#39;ezona&#39;] &lt;- codi_etiquetas(data_e2[&#39;ezona&#39;])#
#print(get_labels(data_e2[&#39;ezona&#39;]))
#get_labels(data_e2$ezona)


#compro_eti(&quot;p13&quot;)
#cambiar_eti(&#39;p13&#39;)
#compro_eti(&#39;ezona&#39;)
#cambiar_eti(&#39;ezona&#39;)
cambiar_eti(&#39;p133&#39;,enco = &quot;Windows-1252&quot;)</code></pre>
<pre><code>## [1] &quot;Menor a 1 salario mínimo ($0 – $2,399)&quot;                
## [2] &quot;Igual a un salario mínimo ($2,400)&quot;                    
## [3] &quot;Más de 1 salario mínimo hasta 2 ($2,401 – $4,800)&quot;     
## [4] &quot;Más de 2 salarios mínimos hasta 3 ($4,801 – $7,200)&quot;   
## [5] &quot;Más de 3 salarios mínimos hasta 5 ($7,201 – $12,000)&quot;  
## [6] &quot;Más de 5 salarios mínimos hasta 10 ($12,001 – $24,000)&quot;
## [7] &quot;Más de 10 salarios mínimos ($24,001 o más)&quot;            
## [8] &quot;No quiso dar información&quot;                              
## [9] &quot;NS&quot;</code></pre>
<pre class="r"><code>str(data_emovi2017)
view(data_emovi2017)</code></pre>
<div id="entrevistados-por-estado" class="section level2">
<h2>Entrevistados por estado</h2>
<pre class="r"><code>myMenuItems &lt;- c(&quot;downloadPNG&quot;, &quot;downloadJPEG&quot;, &quot;downloadPDF&quot;, &#39;downloadSVG&#39;, &#39;printChart&#39;)
plota &lt;- data_emovi2017 %&gt;%
  count(Estado) %&gt;%
  hchart(&#39;treemap&#39;,
         hcaes(x = paste(get_labels(Estado),&#39; &#39;,&#39;(&#39;, n,&#39;)&#39;, sep = &#39;&#39;), value=&#39;n&#39;, color = &#39;n&#39;)
  ) %&gt;%
  hc_add_theme(hc_theme_ffx()) %&gt;%
  hc_title(
    text = &quot;Número de entrevistados por estado&quot;
  )%&gt;% 
  hc_subtitle(text = paste(&quot;Total de participates: &quot; , toString(nrow(data_emovi2017)))) %&gt;%
  hc_exporting(enabled = TRUE,
               filename = &quot;archivo&quot;,
               sourceWidth =  1000,
               sourceHeight = 640,
               scale = 10,
              
               buttons = list(contextButton = list(menuItems = myMenuItems))
  )
htmlwidgets::saveWidget(widget = plota, file = &quot;./plot.html&quot;)
setwd(&quot;~/OneDrive - Centro de Investigacion y Docencia Economicas CIDE/TesisME2019/TesinaCIDEMERMM&quot;)
webshot::webshot(url = &quot;~/Users/rafamtz/OneDrive - Centro de Investigacion y Docencia Economicas CIDE/TesisME2019/TesinaCIDEMERMM/plot.html&quot;, 
                  delay = 2)
plota</code></pre>
</div>
<div id="sexo-por-estado" class="section level2">
<h2>Sexo por estado</h2>
<pre class="r"><code>myMenuItems &lt;- c(&quot;downloadPNG&quot;, &quot;downloadJPEG&quot;, &quot;downloadPDF&quot;, &#39;downloadSVG&#39;, &#39;printChart&#39;)
gra_sex_est&lt;-function(df){
df %&gt;%
  count(Estado, p06)%&gt;% 
  hchart(&#39;column&#39;,
         hcaes( y = &#39;n&#39;,  group = as_label(p06)))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;Número de entrevistados por estado y sexo&quot;
  ) %&gt;%
  #hc_subtitle(text = &quot;Las edades están agrupadas en intervalos 
   #           de 10 años (da clic sobre F o M)&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Número de participantes&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Estados&quot;),
           categories = get_labels(df$Estado)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))
}
gra_sex_est(data_emovi2017)</code></pre>
<div id="htmlwidget-2b97b3280f75ad6989ab" style="width:100%;height:500px;" class="highchart html-widget"></div>
<script type="application/json" data-for="htmlwidget-2b97b3280f75ad6989ab">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":"Número de entrevistados por estado y sexo"},"yAxis":{"title":{"text":"Número de participantes"}},"credits":{"enabled":false},"exporting":{"enabled":true,"filename":"datos","buttons":{"contextButton":{"menuItems":["downloadPNG","downloadJPEG","downloadPDF","downloadSVG","printChart"]}}},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"showInLegend":true},"treemap":{"layoutAlgorithm":"squarified"},"scatter":{"marker":{"symbol":"circle"}}},"series":[{"name":"1 Hombre","data":[{"Estado":"1","p06":"1","n":256,"y":256},{"Estado":"2","p06":"1","n":206,"y":206},{"Estado":"3","p06":"1","n":274,"y":274},{"Estado":"4","p06":"1","n":202,"y":202},{"Estado":"5","p06":"1","n":192,"y":192},{"Estado":"6","p06":"1","n":207,"y":207},{"Estado":"7","p06":"1","n":202,"y":202},{"Estado":"8","p06":"1","n":225,"y":225},{"Estado":"9","p06":"1","n":1306,"y":1306},{"Estado":"10","p06":"1","n":152,"y":152},{"Estado":"11","p06":"1","n":166,"y":166},{"Estado":"12","p06":"1","n":149,"y":149},{"Estado":"13","p06":"1","n":100,"y":100},{"Estado":"14","p06":"1","n":244,"y":244},{"Estado":"15","p06":"1","n":159,"y":159},{"Estado":"16","p06":"1","n":198,"y":198},{"Estado":"17","p06":"1","n":114,"y":114},{"Estado":"18","p06":"1","n":172,"y":172},{"Estado":"19","p06":"1","n":217,"y":217},{"Estado":"20","p06":"1","n":144,"y":144},{"Estado":"21","p06":"1","n":93,"y":93},{"Estado":"22","p06":"1","n":142,"y":142},{"Estado":"23","p06":"1","n":209,"y":209},{"Estado":"24","p06":"1","n":193,"y":193},{"Estado":"25","p06":"1","n":180,"y":180},{"Estado":"26","p06":"1","n":228,"y":228},{"Estado":"27","p06":"1","n":233,"y":233},{"Estado":"28","p06":"1","n":197,"y":197},{"Estado":"29","p06":"1","n":77,"y":77},{"Estado":"30","p06":"1","n":113,"y":113},{"Estado":"31","p06":"1","n":195,"y":195},{"Estado":"32","p06":"1","n":174,"y":174}],"type":"column"},{"name":"2 Mujer","data":[{"Estado":"1","p06":"2","n":340,"y":340},{"Estado":"2","p06":"2","n":283,"y":283},{"Estado":"3","p06":"2","n":244,"y":244},{"Estado":"4","p06":"2","n":312,"y":312},{"Estado":"5","p06":"2","n":342,"y":342},{"Estado":"6","p06":"2","n":424,"y":424},{"Estado":"7","p06":"2","n":331,"y":331},{"Estado":"8","p06":"2","n":315,"y":315},{"Estado":"9","p06":"2","n":1811,"y":1811},{"Estado":"10","p06":"2","n":306,"y":306},{"Estado":"11","p06":"2","n":240,"y":240},{"Estado":"12","p06":"2","n":282,"y":282},{"Estado":"13","p06":"2","n":165,"y":165},{"Estado":"14","p06":"2","n":404,"y":404},{"Estado":"15","p06":"2","n":236,"y":236},{"Estado":"16","p06":"2","n":369,"y":369},{"Estado":"17","p06":"2","n":224,"y":224},{"Estado":"18","p06":"2","n":247,"y":247},{"Estado":"19","p06":"2","n":373,"y":373},{"Estado":"20","p06":"2","n":211,"y":211},{"Estado":"21","p06":"2","n":171,"y":171},{"Estado":"22","p06":"2","n":191,"y":191},{"Estado":"23","p06":"2","n":356,"y":356},{"Estado":"24","p06":"2","n":345,"y":345},{"Estado":"25","p06":"2","n":283,"y":283},{"Estado":"26","p06":"2","n":313,"y":313},{"Estado":"27","p06":"2","n":285,"y":285},{"Estado":"28","p06":"2","n":341,"y":341},{"Estado":"29","p06":"2","n":125,"y":125},{"Estado":"30","p06":"2","n":237,"y":237},{"Estado":"31","p06":"2","n":340,"y":340},{"Estado":"32","p06":"2","n":300,"y":300}],"type":"column"}],"xAxis":{"title":{"text":"Estados"},"categories":["Aguascalientes","Baja California","Baja California Sur","Campeche","Coahuila de Zaragoza","Colima","Chiapas","Chihuahua","Distrito Federal","Durango","Guanajuato","Guerrero","Hidalgo","Jalisco","México","Michoacán de Ocampo","Morelos","Nayarit","Nuevo León","Oaxaca","Puebla","Querétaro","Quintana Roo","San Luis Potosí","Sinaloa","Sonora","Tabasco","Tamaulipas","Tlaxcala","Veracruz de Ignacio de la Llave","Yucatán","Zacatecas"]}},"theme":{"colors":["#00AACC","#FF4E00","#B90000","#5F9B0A","#CD6723"],"chart":{"backgroundColor":{"linearGradient":[0,0,0,150],"stops":[[0,"#CAE1F4"],[1,"#EEEEEE"]]},"style":{"fontFamily":"Open Sans"}},"title":{"align":"left"},"subtitle":{"align":"left"},"legend":{"align":"right","verticalAlign":"bottom"},"xAxis":{"gridLineWidth":1,"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"yAxis":{"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1}},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","drillUpText":"Back to {series.name}","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"thousandsSep":" ","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":"Open+Sans","debug":false},"evals":[],"jsHooks":[]}</script>
</div>
<div id="escolaridad-sexo" class="section level2">
<h2>Escolaridad sexo</h2>
<pre class="r"><code>data_emovi2017 %&gt;%
  count(p13,p06)%&gt;% 
  hchart(&#39;column&#39;,
         hcaes( y = &#39;n&#39;,  group = as_label(p06)))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;Escolaridad por  sexo&quot;
  ) %&gt;%
  #hc_subtitle(text = &quot;Las edades están agrupadas en intervalos 
   #           de 10 años (da clic sobre F o M)&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Número de participantes&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Escolaridad&quot;),
           categories = get_labels(data_emovi2017$p13)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))</code></pre>
</div>
<div id="número-de-personas-que-aportan-al-ingreso" class="section level2">
<h2>Número de personas que aportan al ingreso</h2>
<pre class="r"><code>data_emovi2017 %&gt;%
  count(p132)%&gt;% 
  hchart(&#39;column&#39;,
         hcaes( y = &#39;n&#39;))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;Numero de miembros que aportan ingreso&quot;
  ) %&gt;%
  #hc_subtitle(text = &quot;Las edades están agrupadas en intervalos 
   #           de 10 años (da clic sobre F o M)&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Número de participantes&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Número de personas&quot;),
           categories = get_labels(data_emovi2017$p132)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))</code></pre>
</div>
</div>
<div id="percepción-de-movilidad" class="section level1">
<h1>Percepción de movilidad</h1>
<pre class="r"><code>data_emovi2017$p147&lt;-add_labels(
                          data_emovi2017$p147,
                          labels = c(&quot;1&quot; = 1,
                                     &quot;2&quot; = 2,
                                     &quot;3&quot; = 3,
                                     &quot;4&quot; = 4,
                                     &quot;5&quot; = 5,
                                     &quot;6&quot; = 6,
                                     &quot;7&quot; = 7,
                                     &quot;8&quot; = 8,
                                     &quot;9&quot; = 9,
                                     &quot;10&quot; = 10))</code></pre>
</div>
<div id="percepción-actual" class="section level1">
<h1>Percepción Actual</h1>
<pre class="r"><code>gra_per_eco_act&lt;- function(df){
  df%&gt;%
  count(p147)%&gt;% 
  hchart(&#39;column&#39;,
         hcaes( y = &#39;n&#39;))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;Opinión sobre situación económica actual&quot;
  ) %&gt;%
  #hc_subtitle(text = &quot;Las edades están agrupadas en intervalos 
   #           de 10 años (da clic sobre F o M)&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Número de participantes&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Posición económica&quot;),
           categories = get_labels(df$p147)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))
}
gra_per_eco_act(data_emovi2017)</code></pre>
<div id="htmlwidget-8e11f269f675aa756416" style="width:100%;height:500px;" class="highchart html-widget"></div>
<script type="application/json" data-for="htmlwidget-8e11f269f675aa756416">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":"Opinión sobre situación económica actual"},"yAxis":{"title":{"text":"Número de participantes"}},"credits":{"enabled":false},"exporting":{"enabled":true,"filename":"datos","buttons":{"contextButton":{"menuItems":["downloadPNG","downloadJPEG","downloadPDF","downloadSVG","printChart"]}}},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"showInLegend":false},"treemap":{"layoutAlgorithm":"squarified"},"scatter":{"marker":{"symbol":"circle"}}},"series":[{"group":"group","data":[{"p147":1,"n":624,"y":624},{"p147":2,"n":1178,"y":1178},{"p147":3,"n":2215,"y":2215},{"p147":4,"n":2863,"y":2863},{"p147":5,"n":4742,"y":4742},{"p147":6,"n":2437,"y":2437},{"p147":7,"n":2106,"y":2106},{"p147":8,"n":1205,"y":1205},{"p147":9,"n":186,"y":186},{"p147":10,"n":109,"y":109}],"type":"column"}],"xAxis":{"title":{"text":"Posición económica"},"categories":["1","2","3","4","5","6","7","8","9","10"]}},"theme":{"colors":["#00AACC","#FF4E00","#B90000","#5F9B0A","#CD6723"],"chart":{"backgroundColor":{"linearGradient":[0,0,0,150],"stops":[[0,"#CAE1F4"],[1,"#EEEEEE"]]},"style":{"fontFamily":"Open Sans"}},"title":{"align":"left"},"subtitle":{"align":"left"},"legend":{"align":"right","verticalAlign":"bottom"},"xAxis":{"gridLineWidth":1,"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"yAxis":{"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1}},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","drillUpText":"Back to {series.name}","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"thousandsSep":" ","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":"Open+Sans","debug":false},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>data_emovi2017$p148&lt;-add_labels(
                          data_emovi2017$p148,
                          labels = c(&quot;1&quot; = 1,
                                     &quot;2&quot; = 2,
                                     &quot;3&quot; = 3,
                                     &quot;4&quot; = 4,
                                     &quot;5&quot; = 5,
                                     &quot;6&quot; = 6,
                                     &quot;7&quot; = 7,
                                     &quot;8&quot; = 8,
                                     &quot;9&quot; = 9,
                                     &quot;10&quot; = 10))</code></pre>
</div>
<div id="percepción-pasada" class="section level1">
<h1>Percepción pasada</h1>
<pre class="r"><code>gra_per_eco_ant&lt;- function(df){
  df%&gt;%
  count(p148)%&gt;% 
  hchart(&#39;column&#39;,
         hcaes( y = &#39;n&#39;))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;Opinión sobre situación económica de los padres&quot;
  ) %&gt;%
  #hc_subtitle(text = &quot;Las edades están agrupadas en intervalos 
   #           de 10 años (da clic sobre F o M)&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Número de participantes&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Posición económica&quot;),
           categories = get_labels(df$p148)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))
}
gra_per_eco_ant(data_emovi2017)</code></pre>
<div id="htmlwidget-ee04d81efeaab6e859bc" style="width:100%;height:500px;" class="highchart html-widget"></div>
<script type="application/json" data-for="htmlwidget-ee04d81efeaab6e859bc">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":"Opinión sobre situación económica de los padres"},"yAxis":{"title":{"text":"Número de participantes"}},"credits":{"enabled":false},"exporting":{"enabled":true,"filename":"datos","buttons":{"contextButton":{"menuItems":["downloadPNG","downloadJPEG","downloadPDF","downloadSVG","printChart"]}}},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"showInLegend":false},"treemap":{"layoutAlgorithm":"squarified"},"scatter":{"marker":{"symbol":"circle"}}},"series":[{"group":"group","data":[{"p148":1,"n":2307,"y":2307},{"p148":2,"n":2209,"y":2209},{"p148":3,"n":2639,"y":2639},{"p148":4,"n":2502,"y":2502},{"p148":5,"n":3032,"y":3032},{"p148":6,"n":1814,"y":1814},{"p148":7,"n":1495,"y":1495},{"p148":8,"n":1093,"y":1093},{"p148":9,"n":342,"y":342},{"p148":10,"n":232,"y":232}],"type":"column"}],"xAxis":{"title":{"text":"Posición económica"},"categories":["1","2","3","4","5","6","7","8","9","10"]}},"theme":{"colors":["#00AACC","#FF4E00","#B90000","#5F9B0A","#CD6723"],"chart":{"backgroundColor":{"linearGradient":[0,0,0,150],"stops":[[0,"#CAE1F4"],[1,"#EEEEEE"]]},"style":{"fontFamily":"Open Sans"}},"title":{"align":"left"},"subtitle":{"align":"left"},"legend":{"align":"right","verticalAlign":"bottom"},"xAxis":{"gridLineWidth":1,"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"yAxis":{"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1}},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","drillUpText":"Back to {series.name}","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"thousandsSep":" ","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":"Open+Sans","debug":false},"evals":[],"jsHooks":[]}</script>
</div>
<div id="percepción-relativa" class="section level1">
<h1>Percepción relativa</h1>
<pre class="r"><code>skey&lt;-data_emovi2017%&gt;%
  select(p148,p147)%&gt;%
  data_to_sankey()

#skey

for (a in unique(skey$from)){
skey$from[skey$from == a] &lt;-paste(a,&#39;p&#39;)
}

#skey$weight&lt;-as.double(skey$weight)

#for (a in unique(skey$from)){
#skey[skey$from ==a, &quot;weight&quot;] &lt;- round(skey[skey$from ==a, &quot;weight&quot;] / #sum(skey[skey$from==a,3]),2)
#}

#skey

skey%&gt;%
hchart(&#39;sankey&#39;,nodeWidth=50,
       opacity=1, linkOpacity=0.05, minLinkWidth=2,
       name = &quot;Movilidad&quot;,nodePadding = 15,clip=FALSE,
       description = &quot;hola&quot;)%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;Percepción de movilidad relativa&quot;
  )%&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))</code></pre>
<div id="htmlwidget-10c8065dde5377bbe4d1" style="width:100%;height:500px;" class="highchart html-widget"></div>
<script type="application/json" data-for="htmlwidget-10c8065dde5377bbe4d1">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":"Percepción de movilidad relativa"},"yAxis":{"title":{"text":[]}},"credits":{"enabled":false},"exporting":{"enabled":true,"filename":"datos","buttons":{"contextButton":{"menuItems":["downloadPNG","downloadJPEG","downloadPDF","downloadSVG","printChart"]}}},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"showInLegend":false},"treemap":{"layoutAlgorithm":"squarified"},"scatter":{"marker":{"symbol":"circle"}}},"series":[{"group":"group","data":[{"from":"1 p","to":"1","weight":313,"id":"11"},{"from":"1 p","to":"2","weight":492,"id":"12"},{"from":"1 p","to":"3","weight":603,"id":"13"},{"from":"1 p","to":"4","weight":376,"id":"14"},{"from":"1 p","to":"5","weight":365,"id":"15"},{"from":"1 p","to":"6","weight":92,"id":"16"},{"from":"1 p","to":"7","weight":33,"id":"17"},{"from":"1 p","to":"8","weight":16,"id":"18"},{"from":"1 p","to":"9","weight":4,"id":"19"},{"from":"1 p","to":"10","weight":13,"id":"110"},{"from":"2 p","to":"1","weight":63,"id":"21"},{"from":"2 p","to":"2","weight":206,"id":"22"},{"from":"2 p","to":"3","weight":471,"id":"23"},{"from":"2 p","to":"4","weight":614,"id":"24"},{"from":"2 p","to":"5","weight":581,"id":"25"},{"from":"2 p","to":"6","weight":149,"id":"26"},{"from":"2 p","to":"7","weight":80,"id":"27"},{"from":"2 p","to":"8","weight":33,"id":"28"},{"from":"2 p","to":"9","weight":10,"id":"29"},{"from":"2 p","to":"10","weight":2,"id":"210"},{"from":"3 p","to":"1","weight":105,"id":"31"},{"from":"3 p","to":"2","weight":193,"id":"32"},{"from":"3 p","to":"3","weight":392,"id":"33"},{"from":"3 p","to":"4","weight":488,"id":"34"},{"from":"3 p","to":"5","weight":838,"id":"35"},{"from":"3 p","to":"6","weight":335,"id":"36"},{"from":"3 p","to":"7","weight":199,"id":"37"},{"from":"3 p","to":"8","weight":75,"id":"38"},{"from":"3 p","to":"9","weight":10,"id":"39"},{"from":"3 p","to":"10","weight":4,"id":"310"},{"from":"4 p","to":"1","weight":72,"id":"41"},{"from":"4 p","to":"2","weight":145,"id":"42"},{"from":"4 p","to":"3","weight":264,"id":"43"},{"from":"4 p","to":"4","weight":469,"id":"44"},{"from":"4 p","to":"5","weight":608,"id":"45"},{"from":"4 p","to":"6","weight":468,"id":"46"},{"from":"4 p","to":"7","weight":352,"id":"47"},{"from":"4 p","to":"8","weight":115,"id":"48"},{"from":"4 p","to":"9","weight":6,"id":"49"},{"from":"4 p","to":"10","weight":3,"id":"410"},{"from":"5 p","to":"1","weight":31,"id":"51"},{"from":"5 p","to":"2","weight":72,"id":"52"},{"from":"5 p","to":"3","weight":224,"id":"53"},{"from":"5 p","to":"4","weight":309,"id":"54"},{"from":"5 p","to":"5","weight":1298,"id":"55"},{"from":"5 p","to":"6","weight":393,"id":"56"},{"from":"5 p","to":"7","weight":486,"id":"57"},{"from":"5 p","to":"8","weight":191,"id":"58"},{"from":"5 p","to":"9","weight":23,"id":"59"},{"from":"5 p","to":"10","weight":5,"id":"510"},{"from":"6 p","to":"1","weight":15,"id":"61"},{"from":"6 p","to":"2","weight":26,"id":"62"},{"from":"6 p","to":"3","weight":110,"id":"63"},{"from":"6 p","to":"4","weight":291,"id":"64"},{"from":"6 p","to":"5","weight":386,"id":"65"},{"from":"6 p","to":"6","weight":471,"id":"66"},{"from":"6 p","to":"7","weight":285,"id":"67"},{"from":"6 p","to":"8","weight":201,"id":"68"},{"from":"6 p","to":"9","weight":23,"id":"69"},{"from":"6 p","to":"10","weight":6,"id":"610"},{"from":"7 p","to":"1","weight":10,"id":"71"},{"from":"7 p","to":"2","weight":21,"id":"72"},{"from":"7 p","to":"3","weight":90,"id":"73"},{"from":"7 p","to":"4","weight":200,"id":"74"},{"from":"7 p","to":"5","weight":368,"id":"75"},{"from":"7 p","to":"6","weight":265,"id":"76"},{"from":"7 p","to":"7","weight":371,"id":"77"},{"from":"7 p","to":"8","weight":133,"id":"78"},{"from":"7 p","to":"9","weight":27,"id":"79"},{"from":"7 p","to":"10","weight":10,"id":"710"},{"from":"8 p","to":"1","weight":8,"id":"81"},{"from":"8 p","to":"2","weight":11,"id":"82"},{"from":"8 p","to":"3","weight":39,"id":"83"},{"from":"8 p","to":"4","weight":88,"id":"84"},{"from":"8 p","to":"5","weight":225,"id":"85"},{"from":"8 p","to":"6","weight":191,"id":"86"},{"from":"8 p","to":"7","weight":185,"id":"87"},{"from":"8 p","to":"8","weight":311,"id":"88"},{"from":"8 p","to":"9","weight":24,"id":"89"},{"from":"8 p","to":"10","weight":11,"id":"810"},{"from":"9 p","to":"1","weight":1,"id":"91"},{"from":"9 p","to":"2","weight":6,"id":"92"},{"from":"9 p","to":"3","weight":10,"id":"93"},{"from":"9 p","to":"4","weight":16,"id":"94"},{"from":"9 p","to":"5","weight":37,"id":"95"},{"from":"9 p","to":"6","weight":49,"id":"96"},{"from":"9 p","to":"7","weight":92,"id":"97"},{"from":"9 p","to":"8","weight":87,"id":"98"},{"from":"9 p","to":"9","weight":41,"id":"99"},{"from":"9 p","to":"10","weight":3,"id":"910"},{"from":"10 p","to":"1","weight":6,"id":"101"},{"from":"10 p","to":"2","weight":6,"id":"102"},{"from":"10 p","to":"3","weight":12,"id":"103"},{"from":"10 p","to":"4","weight":12,"id":"104"},{"from":"10 p","to":"5","weight":36,"id":"105"},{"from":"10 p","to":"6","weight":24,"id":"106"},{"from":"10 p","to":"7","weight":23,"id":"107"},{"from":"10 p","to":"8","weight":43,"id":"108"},{"from":"10 p","to":"9","weight":18,"id":"109"},{"from":"10 p","to":"10","weight":52,"id":"1010"}],"type":"sankey","nodeWidth":50,"opacity":1,"linkOpacity":0.05,"minLinkWidth":2,"name":"Movilidad","nodePadding":15,"clip":false,"description":"hola"}],"xAxis":{"type":null,"title":{"text":[]},"categories":null}},"theme":{"colors":["#00AACC","#FF4E00","#B90000","#5F9B0A","#CD6723"],"chart":{"backgroundColor":{"linearGradient":[0,0,0,150],"stops":[[0,"#CAE1F4"],[1,"#EEEEEE"]]},"style":{"fontFamily":"Open Sans"}},"title":{"align":"left"},"subtitle":{"align":"left"},"legend":{"align":"right","verticalAlign":"bottom"},"xAxis":{"gridLineWidth":1,"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"yAxis":{"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1}},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","drillUpText":"Back to {series.name}","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"thousandsSep":" ","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":"Open+Sans","debug":false},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>skey&lt;-data_emovi2017%&gt;%
  filter(p06==1)%&gt;%
  select(p148,p147)%&gt;%
  data_to_sankey()


for (a in unique(skey$from)){
skey$from[skey$from == a] &lt;-paste(a,&#39;p&#39;)
}


skey%&gt;%
hchart(&#39;sankey&#39;,nodeWidth=50,
       opacity=1, linkOpacity=0.05, minLinkWidth=2,
       name = &quot;Movilidad&quot;,nodePadding = 15,clip=FALSE,
       description = &quot;hola&quot;)%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;Percepción de movilidad relativa&quot;
  )%&gt;%
  hc_subtitle(text = &quot;Hombres&quot;) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))</code></pre>
<pre class="r"><code>skey&lt;-data_emovi2017%&gt;%
  filter(p06==2)%&gt;%
  select(p148,p147)%&gt;%
  data_to_sankey()


for (a in unique(skey$from)){
skey$from[skey$from == a] &lt;-paste(a,&#39;p&#39;)
}


skey%&gt;%
hchart(&#39;sankey&#39;,nodeWidth=50,
       opacity=1, linkOpacity=0.05, minLinkWidth=2,
       name = &quot;Movilidad&quot;,nodePadding = 15,clip=FALSE,
       description = &quot;hola&quot;)%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;Percepción de movilidad relativa&quot;
  )%&gt;%
  hc_subtitle(text = &quot;Mujeres&quot;) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))</code></pre>
<pre class="r"><code>data_emovi2017&lt;-data_emovi2017%&gt;%
  mutate(mov = ifelse(p147&gt;p148,&quot;mejor&quot;,
                      ifelse(p147&lt;p148,&quot;peor&quot;,&quot;igual&quot;)),
         id_ho = as.integer(row.names(data_emovi2017)))
data_emovi2017$mov&lt;-set_labels(
                          data_emovi2017$mov,
                          labels = c(&quot;mejor&quot; = &quot;mejor&quot;,
                                     &quot;peor&quot; = &quot;peor&quot;,
                                     &quot;igual&quot; = &quot;igual&quot;))</code></pre>
</div>
<div id="percepción-cualitativa-total" class="section level1">
<h1>Percepción cualitativa total</h1>
<pre class="r"><code>data_emovi2017 %&gt;%
  count(mov)%&gt;% 
  mutate(freq = round(100 * n/sum(n), 0))%&gt;%
  hchart(&#39;column&#39;,
         hcaes( y = &#39;freq&#39;))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;Percepción de movilidad&quot;
  ) %&gt;%
  hc_subtitle(text = &quot;&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Porcentaje&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Tipo de percepción&quot;),
           categories = get_labels(data_emovi2017$mov)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))</code></pre>
<div id="htmlwidget-87399b9b0a85a2b10061" style="width:100%;height:500px;" class="highchart html-widget"></div>
<script type="application/json" data-for="htmlwidget-87399b9b0a85a2b10061">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":"Percepción de movilidad"},"yAxis":{"title":{"text":"Porcentaje"}},"credits":{"enabled":false},"exporting":{"enabled":true,"filename":"datos","buttons":{"contextButton":{"menuItems":["downloadPNG","downloadJPEG","downloadPDF","downloadSVG","printChart"]}}},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"showInLegend":false},"treemap":{"layoutAlgorithm":"squarified"},"scatter":{"marker":{"symbol":"circle"}}},"series":[{"group":"group","data":[{"mov":"igual","n":3924,"freq":22,"y":22},{"mov":"mejor","n":9256,"freq":52,"y":52},{"mov":"peor","n":4485,"freq":25,"y":25}],"type":"column"}],"xAxis":{"title":{"text":"Tipo de percepción"},"categories":["igual","mejor","peor"]},"subtitle":{"text":""}},"theme":{"colors":["#00AACC","#FF4E00","#B90000","#5F9B0A","#CD6723"],"chart":{"backgroundColor":{"linearGradient":[0,0,0,150],"stops":[[0,"#CAE1F4"],[1,"#EEEEEE"]]},"style":{"fontFamily":"Open Sans"}},"title":{"align":"left"},"subtitle":{"align":"left"},"legend":{"align":"right","verticalAlign":"bottom"},"xAxis":{"gridLineWidth":1,"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"yAxis":{"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1}},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","drillUpText":"Back to {series.name}","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"thousandsSep":" ","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":"Open+Sans","debug":false},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>data_emovi2017 %&gt;%
  count(p05,mov)%&gt;% 
  group_by(p05) %&gt;%
  mutate(freq = round(100 * n/sum(n), 0))%&gt;%
  hchart(&#39;column&#39;,
         hcaes( y = &#39;freq&#39;,  group = as_label(mov)))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;Percepción de movilidad de acuerdo a la edad&quot;
  ) %&gt;%
  hc_subtitle(text = &quot;Para el color de piel se revisa la escala&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Porcentaje&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Edad&quot;),
           categories = as.character(25:64)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))</code></pre>
<pre class="r"><code># Per_SitEco

data_emovi2017 %&gt;%
  count(p151,mov)%&gt;% 
  group_by(p151) %&gt;%
  mutate(freq = round(100 * n/sum(n), 0))%&gt;%
  hchart(&#39;column&#39;,
         hcaes( y = &#39;freq&#39;,  group = as_label(mov)))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;Percepción de movilidad de acuerdo al color de piel&quot;
  ) %&gt;%
  hc_subtitle(text = &quot;Para el color de piel se revisa la escala&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Porcentaje&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Color de piel&quot;),
           categories = get_labels(data_emovi2017$p151)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))</code></pre>
</div>
<div id="percepción-regional" class="section level1">
<h1>Percepción regional</h1>
<pre class="r"><code>data_emovi2017 %&gt;%
  count(region,mov)%&gt;% 
  group_by(region) %&gt;%
  mutate(freq = round(100 * n/sum(n), 0))%&gt;%
  hchart(&#39;column&#39;,
         hcaes( y = &#39;freq&#39;,  group = as_label(mov)))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;Percepción de movilidad de acuerdo region&quot;
  ) %&gt;%
  hc_subtitle(text = &quot;&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Porcentaje&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Region&quot;),
           categories = get_labels(data_emovi2017$region)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))</code></pre>
<div id="htmlwidget-bc3a933f88d848edded5" style="width:100%;height:500px;" class="highchart html-widget"></div>
<script type="application/json" data-for="htmlwidget-bc3a933f88d848edded5">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":"Percepción de movilidad de acuerdo region"},"yAxis":{"title":{"text":"Porcentaje"}},"credits":{"enabled":false},"exporting":{"enabled":true,"filename":"datos","buttons":{"contextButton":{"menuItems":["downloadPNG","downloadJPEG","downloadPDF","downloadSVG","printChart"]}}},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"showInLegend":true},"treemap":{"layoutAlgorithm":"squarified"},"scatter":{"marker":{"symbol":"circle"}}},"series":[{"name":"igual","data":[{"region":"1","mov":"igual","n":782,"freq":24,"y":24},{"region":"2","mov":"igual","n":614,"freq":26,"y":26},{"region":"3","mov":"igual","n":574,"freq":19,"y":19},{"region":"4","mov":"igual","n":1181,"freq":22,"y":22},{"region":"5","mov":"igual","n":773,"freq":20,"y":20}],"type":"column"},{"name":"mejor","data":[{"region":"1","mov":"mejor","n":1642,"freq":51,"y":51},{"region":"2","mov":"mejor","n":1245,"freq":53,"y":53},{"region":"3","mov":"mejor","n":1645,"freq":55,"y":55},{"region":"4","mov":"mejor","n":2595,"freq":49,"y":49},{"region":"5","mov":"mejor","n":2129,"freq":56,"y":56}],"type":"column"},{"name":"peor","data":[{"region":"1","mov":"peor","n":808,"freq":25,"y":25},{"region":"2","mov":"peor","n":473,"freq":20,"y":20},{"region":"3","mov":"peor","n":761,"freq":26,"y":26},{"region":"4","mov":"peor","n":1544,"freq":29,"y":29},{"region":"5","mov":"peor","n":899,"freq":24,"y":24}],"type":"column"}],"xAxis":{"title":{"text":"Region"},"categories":["Norte","Norte-occidente","Centro-norte","Centro","Sur"]},"subtitle":{"text":""}},"theme":{"colors":["#00AACC","#FF4E00","#B90000","#5F9B0A","#CD6723"],"chart":{"backgroundColor":{"linearGradient":[0,0,0,150],"stops":[[0,"#CAE1F4"],[1,"#EEEEEE"]]},"style":{"fontFamily":"Open Sans"}},"title":{"align":"left"},"subtitle":{"align":"left"},"legend":{"align":"right","verticalAlign":"bottom"},"xAxis":{"gridLineWidth":1,"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"yAxis":{"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1}},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","drillUpText":"Back to {series.name}","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"thousandsSep":" ","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":"Open+Sans","debug":false},"evals":[],"jsHooks":[]}</script>
</div>
<div id="percepción-por-cohort-de-ingreso" class="section level1">
<h1>Percepción por cohort de ingreso</h1>
<pre class="r"><code>data_emovi2017 %&gt;%
  count(p133,mov)%&gt;% 
  group_by(p133) %&gt;%
  mutate(freq = round(100 * n/sum(n), 0))%&gt;%
  hchart(&#39;column&#39;,
         hcaes( y = &#39;freq&#39;,  group = as_label(mov)))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;Percepción de movilidad de acuerdo a cohort de ingreso&quot;
  ) %&gt;%
  hc_subtitle(text = &quot;&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Porcentaje&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Region&quot;),
           categories = get_labels(data_emovi2017$p133)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))</code></pre>
<div id="htmlwidget-d7ab0310c73e43e4d96f" style="width:100%;height:500px;" class="highchart html-widget"></div>
<script type="application/json" data-for="htmlwidget-d7ab0310c73e43e4d96f">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":"Percepción de movilidad de acuerdo a cohort de ingreso"},"yAxis":{"title":{"text":"Porcentaje"}},"credits":{"enabled":false},"exporting":{"enabled":true,"filename":"datos","buttons":{"contextButton":{"menuItems":["downloadPNG","downloadJPEG","downloadPDF","downloadSVG","printChart"]}}},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"showInLegend":true},"treemap":{"layoutAlgorithm":"squarified"},"scatter":{"marker":{"symbol":"circle"}}},"series":[{"name":"igual","data":[{"p133":"1","mov":"igual","n":747,"freq":29,"y":29},{"p133":"2","mov":"igual","n":462,"freq":21,"y":21},{"p133":"3","mov":"igual","n":834,"freq":20,"y":20},{"p133":"4","mov":"igual","n":659,"freq":19,"y":19},{"p133":"5","mov":"igual","n":386,"freq":20,"y":20},{"p133":"6","mov":"igual","n":162,"freq":22,"y":22},{"p133":"7","mov":"igual","n":52,"freq":28,"y":28},{"p133":"8","mov":"igual","n":425,"freq":26,"y":26},{"p133":"9","mov":"igual","n":197,"freq":24,"y":24}],"type":"column"},{"name":"mejor","data":[{"p133":"1","mov":"mejor","n":1319,"freq":50,"y":50},{"p133":"2","mov":"mejor","n":1224,"freq":54,"y":54},{"p133":"3","mov":"mejor","n":2220,"freq":54,"y":54},{"p133":"4","mov":"mejor","n":1809,"freq":53,"y":53},{"p133":"5","mov":"mejor","n":1016,"freq":52,"y":52},{"p133":"6","mov":"mejor","n":392,"freq":54,"y":54},{"p133":"7","mov":"mejor","n":90,"freq":48,"y":48},{"p133":"8","mov":"mejor","n":754,"freq":47,"y":47},{"p133":"9","mov":"mejor","n":432,"freq":53,"y":53}],"type":"column"},{"name":"peor","data":[{"p133":"1","mov":"peor","n":551,"freq":21,"y":21},{"p133":"2","mov":"peor","n":561,"freq":25,"y":25},{"p133":"3","mov":"peor","n":1066,"freq":26,"y":26},{"p133":"4","mov":"peor","n":919,"freq":27,"y":27},{"p133":"5","mov":"peor","n":539,"freq":28,"y":28},{"p133":"6","mov":"peor","n":175,"freq":24,"y":24},{"p133":"7","mov":"peor","n":46,"freq":24,"y":24},{"p133":"8","mov":"peor","n":437,"freq":27,"y":27},{"p133":"9","mov":"peor","n":191,"freq":23,"y":23}],"type":"column"}],"xAxis":{"title":{"text":"Region"},"categories":["Menor a 1 salario mínimo ($0 – $2,399)","Igual a un salario mínimo ($2,400)","Más de 1 salario mínimo hasta 2 ($2,401 – $4,800)","Más de 2 salarios mínimos hasta 3 ($4,801 – $7,200)","Más de 3 salarios mínimos hasta 5 ($7,201 – $12,000)","Más de 5 salarios mínimos hasta 10 ($12,001 – $24,000)","Más de 10 salarios mínimos ($24,001 o más)","No quiso dar información","NS"]},"subtitle":{"text":""}},"theme":{"colors":["#00AACC","#FF4E00","#B90000","#5F9B0A","#CD6723"],"chart":{"backgroundColor":{"linearGradient":[0,0,0,150],"stops":[[0,"#CAE1F4"],[1,"#EEEEEE"]]},"style":{"fontFamily":"Open Sans"}},"title":{"align":"left"},"subtitle":{"align":"left"},"legend":{"align":"right","verticalAlign":"bottom"},"xAxis":{"gridLineWidth":1,"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"yAxis":{"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1}},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","drillUpText":"Back to {series.name}","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"thousandsSep":" ","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":"Open+Sans","debug":false},"evals":[],"jsHooks":[]}</script>
</div>
<div id="filtramos-a-los-hjos" class="section level1">
<h1>Filtramos a los hjos</h1>
<div id="selección-de-hijos" class="section level2">
<h2>Selección de hijos</h2>
<p>Criterios de filtrado - pregunta p2, comparten el mimso gasto para comer: 1 ) Si 2 ) No - pregunta 5 Edades entre 25 y 45 años - pregunta p08, es el jefe del hogar: 1 ) jefe 2) cónyuge NO IMPLEMENTADO - pregunta p12, actualmente estudia, 1)Si 2)No - p26 Había un jefe de hogar en la infancia (1 padre 2 madre) - p43 y p43m Reporta educación del padre o madre priciapl - p68, Personas que trabajan, 1. Si, 2. No - p69 si trabaja pero la semana pasada no - p132 numero de personas que aportan ingreso - p133 cohort de todas las personas y todos los ingresos (1 ingreso)</p>
<p>Variables de selección para estimar ingreso</p>
<ul>
<li><p>Estado</p></li>
<li><p>pregunta 5, edad</p></li>
<li><p>pregunta 6, sexo</p></li>
<li><p>Pregunta 13, nivel de escuela</p></li>
<li><p>p76 ocupación –SINCO3 codificación ocupación entrevistado</p></li>
<li><p>p133 cohort de todas las personas y todos los ingresos</p></li>
</ul>
<pre class="r"><code># pensamos que los datos se leeen como factores cando corresponda, si se leen como enteros no debe hacerse el casting
#data_emovi2017&lt;-datos_e
hijos &lt;- data_emovi2017 %&gt;%
  filter(p02 == 1)  %&gt;% #compartir gasot para comer
  filter(between(p05,25,40)) %&gt;% # edad
  #filter(p08 == 1)  %&gt;% 
  filter(p12 == 2)  %&gt;% # ya no estudia
  filter(p26 == 1 | p26==2 ) %&gt;% # sosten principal papa, mama, 
   filter((!is.na(p43) &amp; p43!=98 &amp; p26 == 1 ) |
            (!is.na(p43m) &amp; p43m!=98  &amp; p26 == 2 )) %&gt;% # reporta educación de pp
   filter(!is.na(p13))%&gt;% #  reporta educación
  filter(SINCO3 !=&quot;&quot;) %&gt;%# reporta oficio actual
   filter(p68 == 1 | p69 == 1)  %&gt;% # si trabaja
   filter(p132 %in% c(1)) %&gt;%# persona que aportan ingreso
  filter(!p133 %in% c(8,9,NA) ) # reporta ingresos
                                # no estan los ingresos  hogar aislados. 

#edad_promedio_padres &lt;- mean(hijos$p38_11, na.rm = TRUE)
#edad_promedio_padres-21
unique(hijos$p43)</code></pre>
<pre class="r"><code>gra_sex_est(hijos)</code></pre>
<pre class="r"><code>var&lt;-c(&quot;Estado&quot;,&quot;p05&quot;,&quot;p06&quot;,&quot;p13&quot;,&quot;SINCO3&quot;,&quot;p133&quot;,&quot;mov&quot;,&quot;id_ho&quot;,&quot;region&quot;)
hijos_para_sal&lt;-hijos%&gt;%
  select(var)%&gt;%
  mutate(p133 = ifelse(p133==1,2,p133)-1)# juntamos el cohort 1 y 2 

hijos_para_sal &lt;- hijos_para_sal%&gt;%
            mutate(estrato = ifelse(p133 %in% c(1,2),1,
                                    ifelse(p133 %in% c(3),2,
                                           ifelse(p133 %in% c(4,5),3,4))))

saveRDS(hijos_para_sal, file=&quot;Datos/hijos_emovi2017.Rda&quot;)</code></pre>
</div>
</div>
<div id="identificación-de-padres" class="section level1">
<h1>Identificación de padres</h1>
<pre class="r"><code>hijos_emovi_hp &lt;- readRDS(file=&quot;Datos/ingreso_hij_f_emovi.Rda&quot;)

# p05 edad act
# p06 sexo act
# p13 educ hijo
# SINCO3, ocupación hijo
# p23 en qeu estado vivia a los 14
# p26 principal sosten ecómico
# p38_11 edad padre 2016
# p38m_11 edad madre 2016
# p43 nivel educativo padre
#p43m nivel educativo madre
# cmo1_2 ocupacion del padre
# cmo2_2 ocupacion de la madre 


varp&lt;-c(&quot;Estado&quot;,&quot;p05&quot;,&quot;p06&quot;,&quot;p13&quot;,&quot;SINCO3&quot;,&quot;p23&quot;,&quot;p26&quot;,&quot;p38_11&quot;,&quot;p38m_11&quot;,
        &quot;p43&quot;,&quot;p43m&quot;,&quot;cmo1_2&quot;,&quot;cmo2_2&quot;,&quot;mov&quot;,&quot;id_ho&quot;,&quot;region&quot;)
padres_h&lt;-data_emovi2017%&gt;%
    filter(p02 == 1)  %&gt;% #compartir gasot para comer
  filter(between(p05,25,40)) %&gt;% # edad
  #filter(p08 == 1)  %&gt;% 
  filter(p12 == 2)  %&gt;%# ya no estudia
  filter(p26 == 1 | p26==2 ) %&gt;% # sosten principal papa, mama, 
   filter((!is.na(p43) &amp; p43!=98 &amp; p26 == 1 )|
            (!is.na(p43m) &amp; p43m!=98  &amp; p26 == 2 )) %&gt;% # reporta educación de pp
   filter(!is.na(p13))%&gt;% #  reporta educación
  filter(SINCO3 !=&quot;&quot;) %&gt;%# reporta oficio actual
   filter(p68 == 1 | p69 == 1)  %&gt;% # si trabaja
   filter(p132 %in% c(1)) %&gt;%# persona que aportan ingreso
  filter(!p133 %in% c(8,9,NA) )%&gt;%
  select(varp)%&gt;%
  slice(as.integer(unlist(hijos_emovi_hp%&gt;%select(id_hijo))))%&gt;%
  mutate(
         pp_id_hijo = hijos_emovi_hp%&gt;%pull(id_hijo),
         pp_id_hijoo= hijos_emovi_hp%&gt;%pull(id_ho),
         ing_h = hijos_emovi_hp%&gt;%pull(ing_men_p_h),
         ling_h = log (hijos_emovi_hp%&gt;%pull(ing_men_p_h)) 
         ) %&gt;%
  rename(
          edad_h = p05,
          sexo_h = p06,
          edu_h = p13,
          ocu_h = SINCO3,
          pp_estado = p23,
          pp = p26,
          p_edad_2016= p38_11,
          m_edad_2016 = p38m_11,
          p_edu = p43,
          m_edu = p43m,
          p_ocu = cmo1_2,
          m_ocu = cmo2_2
         )%&gt;%
  mutate(
        p_edu = as.integer(p_edu),
        m_edu = as.integer(m_edu)
  )
  
 
# las ocupaciones no encontradas las sustituimos por un NA
padres_h&lt;-padres_h%&gt;%
  mutate(p_ocu = ifelse(p_ocu==&quot;.&quot;,NA,p_ocu),
         m_ocu = ifelse(m_ocu==&quot;.&quot;,NA,m_ocu))

unique(padres_h$p_ocu)
unique(padres_h$m_ocu)
padres_h</code></pre>
</div>
<div id="est-per-de-25-años." class="section level1">
<h1>Est Per de 25 años.</h1>
<p>Estas personas se tiene qeu buscar en 2016-11=2005, es decir, la inforación que porporcionan es la correspondiente a la situación en el 2005,</p>
<pre class="r"><code>filtro_edad &lt;- function(df,edad){ 
  #recibe el df y regresa df con edad
        df %&gt;%
         filter(edad_h==edad)
  }



# hacemos la codificación de ESRU a ENIGH2005
padres_h25&lt;-padres_h%&gt;%
   mutate(
    p_edu = ifelse(p_edu%in% c(1),1,
                      ifelse( p_edu == 2,2,
                      ifelse(p_edu %in% c(3,4),3,
                      ifelse( p_edu %in% c(5,6),4,
                      ifelse(p_edu %in% c(7,8),6,
                      ifelse(p_edu %in% c(9,10),5,
                      ifelse(p_edu==11,7,8))))))),
    m_edu = ifelse(m_edu%in% c(1),1,
                      ifelse(m_edu == 2,2,
                      ifelse(m_edu %in% c(3,4),3,
                      ifelse(m_edu %in% c(5,6),4,
                      ifelse(m_edu %in% c(7,8),6,
                      ifelse(m_edu %in% c(9,10),5,
                      ifelse(m_edu==11,7,8)))))))
  )



#lista de 16(25 a 40) elementos cada elemento contiene los hijos por edad

peredades &lt;- lapply(25:40, filtro_edad, df = padres_h25)
peredades[[1]]

filtro_pp&lt;-function(df_1,edadh, general=0)
{
  #recibe un hijo de un dataframe, la edad del hijo, para polimorfismo
  # general = 0y regresa un data frame con los datos
  # ordenados del hijo
  if(df_1[&quot;pp&quot;]==1)
  {
    dfn &lt;- df_1%&gt;%
          filter(pp==1)%&gt;%
          select(starts_with(c(&quot;pp&quot;,&quot;p_&quot;)),ling_h,edu_h,ocu_h,edad_h)%&gt;%
          rename(
            id_hijo = pp_id_hijo,
            pp_sexo = pp,
            pp_edad = p_edad_2016,
            pp_educ = p_edu,
            pp_ocup = p_ocu
          )%&gt;%
        mutate(pp_edad = pp_edad + (14-edadh))
  }
  if(df_1[&quot;pp&quot;]==2)
    {
    dfn&lt;-df_1%&gt;%
        filter(pp==2)%&gt;%
        select(starts_with(c(&quot;pp&quot;,&quot;m_&quot;)),ling_h, edu_h,ocu_h,edad_h)%&gt;%
        rename(
          id_hijo = pp_id_hijo,
          pp_sexo = pp,
          pp_edad = m_edad_2016,
          pp_educ = m_edu,
          pp_ocup = m_ocu
        )%&gt;%
        mutate(pp_edad = pp_edad + (14-edadh))
  }
  if(is.na(dfn$pp_edad) &amp; general){
    return(&quot;ND&quot;)
  }
  return(dfn)
}

#comporbamos qeu funcione bien
filtro_pp(peredades[[1]][1,],25,0)


acomoda_df&lt;-function(df,edadh){
  #damos un dafa de una edad, con al edad, y
  # nos regresa un data frame acomodado
  aux&lt;-function(i){
    return(df[i,])
  }
  a&lt;-lapply(1:nrow(df),aux)
  L&lt;-lapply(a,filtro_pp,edadh=edadh)
  dfn &lt;-bind_rows(L[1:length(L)])
  return(dfn)
}

dfh25&lt;-acomoda_df(peredades[[1]],25)
dfh25


pro_edad_p &lt;- function(L,edad_h){
  #promedio de edad de lso padres por edad de los hijos
  ed&lt;-c()
  dro &lt;- 0
  for(i in 1:nrow(L[[edad_h-24]])){
    a&lt;-peredades[[edad_h-24]][i,]
    df&lt;-filtro_pp(a,edad_h)
    
    if(is.data.frame(df)){
      ed &lt;-c(ed,df$edad)  
    }
    else{
      dro&lt;-dro+1
    }
  }
  return(c(mean(ed),dro,nrow(L[[edad_h-24]])))
}

edades_pro&lt;- lapply(25:40,pro_edad_p,L=peredades)</code></pre>
<div id="sel-padres-poblacion" class="section level2">
<h2>sel padres poblacion</h2>
<pre class="r"><code>poblacion&lt;-read.dbf(
              file=&quot;Datos/ENIGH-Historica/2005/poblacion.dbf&quot;
              )



pobla_enigh2005&lt;-poblacion%&gt;%
  filter(
    PARENTESCO == 100,
    between(EDAD,30,50),
    !is.na(N_INSTR161),
    !is.na(CMO121),
    is.na(CMO251)
  )%&gt;%
  select(
    FOLIO,
    NUM_REN,
    EDAD,
    N_INSTR161,
    CMO121
  )

unique(pobla_enigh2005$N_INSTR161)</code></pre>
<p>##sel ingresos padres</p>
<pre class="r"><code>ingresos&lt;-read.dbf(
              file=&quot;Datos/ENIGH-Historica/2005/ingresos.dbf&quot;
              )</code></pre>
<pre class="r"><code>familias_integrantes &lt;- function(df,nr){
  dfn &lt;- df %&gt;%
    filter(NUM_REN %in% nr)
  return(dfn)
} 



ingresos_acu &lt;- function(df,clavs){
 dfn &lt;- df %&gt;%
   group_by(FOLIO, NUM_REN) %&gt;%
   filter(CLAVE %in% clavs)%&gt;%
   summarise(
   claves_a = paste(CLAVE,collapse = &quot;,&quot;),
  ing_tri_t = sum(ING_TRI),
  ing_men_p = ing_tri_t/3,
  ling_men_p = log(ing_men_p)
  ) %&gt;% ungroup()
 
 
 return(dfn)
}

#hogares &lt;- c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;)
personas_h &lt;- c(&#39;01&#39;)

a&lt;-familias_integrantes(ingresos,personas_h)
a
claves&lt;-c(&quot;P001&quot;,&quot;P002&quot;,&quot;P003&quot;,&quot;P011&quot;,&quot;P023&quot;,&quot;P024&quot;,&quot;P054&quot;,&quot;P055&quot;,&quot;P056&quot;, &quot;P059&quot;,&quot;P060&quot;,&quot;P061&quot;,&quot;P063&quot;,&quot;P068&quot;,&quot;P060&quot;,&quot;P070&quot;,&quot;P071&quot;,&quot;P072&quot;,&quot;P073&quot;,&quot;P074&quot;,&quot;P075&quot;,&quot;P076&quot;,&quot;P077&quot;,&quot;P078&quot;,&quot;P079&quot;,&quot;P080&quot;)
ingre_enigh2005&lt;-ingresos_acu(a,claves) 
ingre_enigh2005&lt;-ingre_enigh2005%&gt;%
  select(FOLIO,ling_men_p)
ingre_enigh2005</code></pre>
</div>
<div id="regresion-padres" class="section level2">
<h2>Regresion padres</h2>
<pre class="r"><code>data_padres2005&lt;-full_join(pobla_enigh2005,ingre_enigh2005)%&gt;%
  drop_na()%&gt;%
  mutate(
    CMO121 = substr(CMO121,1,2)
  )%&gt;%
  rename(
    EDU=N_INSTR161,
    OCU = CMO121
  )%&gt;%
  mutate(
    EDU = as.character(EDU)
  )

unique(data_padres2005$EDU)

# ajuste para nivel de ecucación ESRU
data_padres2005$EDU[data_padres2005$EDU == &quot;9&quot;] &lt;- 8

data_padres2005$EDU &lt;- factor(data_padres2005$EDU)
data_padres2005$OCU &lt;- factor(data_padres2005$OCU)

unique(data_padres2005$OCU)</code></pre>
<pre class="r"><code>reg_padres&lt;-lm(
  formula = ling_men_p ~ EDU +  OCU + EDAD +I(EDAD*EDAD),
  data = data_padres2005
)
summary(reg_padres)</code></pre>
</div>
<div id="inser-padre-en-hijo" class="section level2">
<h2>Inser padre en hijo</h2>
<p>sacamso coeficeicneite de educación y ocupación</p>
<pre class="r"><code>#str(data_padres2005$EDU[1])
# Factor w/ 10 levels &quot;0&quot;,&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,..: 4

#str(data_padres2005$OCU[2])
# chr &quot;55&quot;

#str(data_padres2005$EDAD[5])
# int 36

# predicción 8.354147

dfh25_na&lt;-dfh25%&gt;%
  drop_na()

 data&lt;- data.frame(
   EDU= as.character(dfh25_na$pp_educ),
  OCU= as.character(dfh25_na$pp_ocup),
  EDAD = 0
 )

# data&lt;- data.frame(
#   EDU= &quot;1&quot;,
#   OCU= &quot;11&quot;,
#   EDAD= 0
# 
# )
# 
# 
# fh25$pp_ocup

dfhp25&lt;- dfh25_na%&gt;%
  mutate(ling_p = predict(object = reg_padres,   
        newdata = data)) 
dfhp25
hchart(dfhp25,&quot;scatter&quot;,hcaes( x = ling_p, y = ling_h) )</code></pre>
</div>
<div id="eii-25-años" class="section level2">
<h2>EII 25 años</h2>
<pre class="r"><code>reg_hp&lt;-lm(
  formula = ling_h ~ ling_p  ,
  data = dfhp25
)
summary(reg_hp)</code></pre>
</div>
<div id="comprobación-de-resueltado" class="section level2">
<h2>Comprobación de resueltado</h2>
<pre class="r"><code>padres_h %&gt;%
  filter(edad_h==25)%&gt;%
  count(mov)%&gt;%
  mutate(freq = round(100 * n/sum(n), 0))%&gt;%
  hchart(&#39;column&#39;,
         hcaes( y = &#39;freq&#39;))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;Percepción de movilidad de acuerdo a la edad&quot;
  ) %&gt;%
  hc_subtitle(text = &quot;Para el color de piel se revisa la escala&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Porcentaje&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Edad&quot;),
           categories = get_labels(padres_h$mov)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))</code></pre>
</div>
</div>
<div id="est-muestar-completa" class="section level1">
<h1>Est Muestar completa</h1>
<pre class="r"><code>hijos_emovi_hp &lt;- readRDS(file=&quot;Datos/ingreso_hij_f_emovi.Rda&quot;)

# p05 edad act
# p06 sexo act
# p13 educ hijo
# SINCO3, ocupación hijo
# p23 en qeu estado vivia a los 14
# p26 principal sosten ecómico
# p38_11 edad padre 2016
# p38m_11 edad madre 2016
# p43 nivel educativo padre
#p43m nivel educativo madre
# cmo1_2 ocupacion del padre
# cmo2_2 ocupacion de la madre 


varp&lt;-c(&quot;Estado&quot;,&quot;p05&quot;,&quot;p06&quot;,&quot;p13&quot;,&quot;SINCO3&quot;,&quot;p23&quot;,&quot;p26&quot;,&quot;p38_11&quot;,&quot;p38m_11&quot;,&quot;p43&quot;,&quot;p44&quot;,
        &quot;p43m&quot;,&quot;p44m&quot;,&quot;cmo1_2&quot;,&quot;cmo2_2&quot;,&quot;mov&quot;,&quot;region&quot;)
padres_h&lt;-data_emovi2017%&gt;%
    filter(p02 == 1)  %&gt;% #compartir gasot para comer
  filter(between(p05,25,40)) %&gt;% # edad
  #filter(p08 == 1)  %&gt;% 
  filter(p12 == 2)  %&gt;%# ya no estudia
  filter(p26 == 1 | p26==2 ) %&gt;% # sosten principal papa, mama, 
   filter((!is.na(p43) &amp; p43!=98 &amp; p26 == 1 )|
            (!is.na(p43m) &amp; p43m!=98  &amp; p26 == 2 )) %&gt;% # reporta educación de pp
   filter(!is.na(p13))%&gt;% #  reporta educación
  filter(SINCO3 !=&quot;&quot;) %&gt;%# reporta oficio actual
   filter(p68 == 1 | p69 == 1)  %&gt;% # si trabaja
   filter(p132 %in% c(1)) %&gt;%# persona que aportan ingreso
  filter(!p133 %in% c(8,9,NA) )%&gt;%
  select(varp)%&gt;%
  slice(as.integer(unlist(hijos_emovi_hp%&gt;%select(id_hijo))))%&gt;%
  mutate(
         pp_id_hijo = hijos_emovi_hp%&gt;%pull(id_hijo),
         ing_h = hijos_emovi_hp%&gt;%pull(ing_men_p_h),
         ling_h = log (hijos_emovi_hp%&gt;%pull(ing_men_p_h)) 
         ) %&gt;%
  rename(
          edad_h = p05,
          sexo_h = p06,
          edu_h = p13,
          ocu_h = SINCO3,
          pp_estado = p23,
          pp = p26,
          p_edad_2016= p38_11,
          m_edad_2016 = p38m_11,
          p_edu = p43,
          p_edug = p44,
          m_edu = p43m,
          m_edug = p44m,
          p_ocu = cmo1_2,
          m_ocu = cmo2_2
         )%&gt;%
  mutate(
        p_edu = as.integer(p_edu),
        m_edu = as.integer(m_edu)
  )
  
 
# las ocupaciones no encontradas las sustituimos por un NA
padres_h&lt;-padres_h%&gt;%
  mutate(p_ocu = ifelse(p_ocu==&quot;.&quot;,NA,p_ocu),
         m_ocu = ifelse(m_ocu==&quot;.&quot;,NA,m_ocu))

unique(padres_h$p_ocu)
unique(padres_h$m_ocu)
padres_h</code></pre>
<p>#Crear base limpia</p>
<pre class="r"><code>filtro_pp_c&lt;-function(df_1,general = 0)
{
  #recibe un hijo de un dataframe, para polimorfismo
  # general = 0y regresa un data frame con los datos
  # ordenados del hijo
  if(df_1[&quot;pp&quot;]==1)
  {
    dfn &lt;- df_1%&gt;%
          filter(pp==1)%&gt;%
          select(starts_with(c(&quot;pp&quot;,&quot;p_&quot;)),
                 ling_h,edu_h,ocu_h,edad_h,p_edad_2016,region)%&gt;%
          mutate(pp_edad2016 = p_edad_2016)%&gt;%
          rename(
            id_hijo = pp_id_hijo,
            pp_sexo = pp,
            pp_edad = p_edad_2016,
            pp_educ = p_edu,
            pp_educg = p_edug,
            pp_ocup = p_ocu
          )%&gt;%
        mutate(pp_edad = pp_edad + (14-edad_h))
  }
  if(df_1[&quot;pp&quot;]==2)
    {
    dfn&lt;-df_1%&gt;%
        filter(pp==2)%&gt;%
        select(starts_with(c(&quot;pp&quot;,&quot;m_&quot;)),
               ling_h, edu_h,ocu_h,edad_h,m_edad_2016,region)%&gt;%
       mutate(pp_edad2016 = m_edad_2016)%&gt;%
        rename(
          id_hijo = pp_id_hijo,
          pp_sexo = pp,
          pp_edad = m_edad_2016,
          pp_educ = m_edu,
          pp_educg = m_edug,
          pp_ocup = m_ocu
        )%&gt;%
        mutate(pp_edad = pp_edad + (14-edad_h))
  }
  if(is.na(dfn$pp_edad) &amp; general){
    return(&quot;ND&quot;)
  }
  return(dfn)
}

#comporbamos qeu funcione bien
filtro_pp_c(padres_h[1,])


acomoda_df_c&lt;-function(df){
  #damos un df de una edad,  y
  # nos regresa un data frame acomodado
  aux&lt;-function(i){
    return(df[i,])
  }
  a&lt;-lapply(1:nrow(df),aux)
  L&lt;-lapply(a,filtro_pp_c)
  dfn &lt;-bind_rows(L[1:length(L)])
  return(dfn)
}

dfh&lt;-acomoda_df_c(padres_h)



pro_edad_c &lt;- function(df){
  #le damos el df y nos regresa el promedio de la edade  los padres
  df%&gt;%summarise(
    promedi_edad_padres = mean(pp_edad2016,na.rm=TRUE))
  }

edades_pro&lt;- pro_edad_c(dfh)

edades_pro
#edades de padres faltantes
sum(is.na(dfh$pp_edad2016))
# 13 de 337</code></pre>
<div id="sel-padres-poblacion-1" class="section level2">
<h2>sel padres poblacion</h2>
<p>Seleccionamos de la ENIGH 1997, no hay entonces 1998</p>
<pre class="r"><code>poblacion&lt;-read.dbf(
              file=&quot;Datos/ENIGH-Historica/1998/POBLA98.dbf&quot;
              )



pobla_enigh1998&lt;-poblacion%&gt;%
  filter(
    parentesco == &quot;01&quot;,
    between(edad,30,50),
    !is.na(ed_formal),
    !is.na(ed_tecnica),
    !is.na(ocupacion),
    n_empleos==1, # el entrevistado solo proporciona una ocupación
  )%&gt;%
  select(
    folio,
    num_ren,
    edad,
    ed_formal,
    ed_tecnica,
    ocupacion
  )%&gt;%
 mutate(
  ed_formal = as.integer(as.character(ed_formal)),
   ed_tecnica= as.integer(as.character(ed_tecnica)),
  estado = substr(folio,5,6)
 )

#unique(pobla_enigh1998$ed_formal)
#pobla_enigh1998$ed_formal
nrow(pobla_enigh1998)
head(pobla_enigh1998$ed_formal)
str(pobla_enigh1998$ed_formal)#caracter 2 espacios
unique(pobla_enigh1998$ed_formal)
#pobla_enigh1998$ed_formal==&quot;03&quot;
head(pobla_enigh1998$ed_tecnica)
str(pobla_enigh1998$ed_tecnica)#caracter 1 espacio
unique(pobla_enigh1998$ed_tecnica)
#pobla_enigh1998%&gt;%count(n_empleos), se exploro para quitar una ocupacion
names(poblacion)
str(poblacion$per_ing)</code></pre>
</div>
<div id="cod-enigh-1998" class="section level2">
<h2>cod enigh 1998</h2>
<pre class="r"><code># hacemos la codificación de ENIGH2018 a ESRU
#1  Preescolar o kínder
# 2 Primaria
# 3 Secundaria técnica
# 4 Secundaria general
# 5 Preparatoria técnica
# 6 Preparatoria general
# 7 Técnica o comercial con secundaria
# 8 Técnica o comercial con preparatoria
# 9 Normal básica (con primaria o secundari
# 10 Normal de licenciatura
# 11 Profesional (licenciatura o ingeniería)
# 12 Postgrado (maestría o doctorado)
#_____________________________________________________
# 98 NS, no aplica porque pedimos la edución del pp como instrumento


# vemso las combinaciones de educación para codificar

comb&lt;-pobla_enigh1998%&gt;%
   mutate( combi = paste(as.character(ed_formal),as.character(ed_tecnica)))%&gt;%
  select(ed_formal,ed_tecnica,combi)

  
sort(unique(comb$combi))
# [1] &quot;01 1&quot; &quot;02 1&quot; &quot;03 1&quot; &quot;03 2&quot; &quot;04 1&quot; &quot;05 1&quot; &quot;06 1&quot; &quot;07 1&quot; &quot;07 2&quot; &quot;08 1&quot;
# [11] &quot;08 2&quot; &quot;08 3&quot; &quot;08 4&quot; &quot;08 5&quot; &quot;09 1&quot; &quot;09 4&quot; &quot;09 5&quot; &quot;10 1&quot; &quot;10 2&quot; &quot;10 4&quot;
# [21] &quot;10 5&quot; &quot;11 1&quot; &quot;11 3&quot; &quot;11 4&quot; &quot;11 5&quot; &quot;11 6&quot; &quot;11 7&quot; &quot;12 1&quot; &quot;12 3&quot; &quot;12 5&quot;
# [31] &quot;12 6&quot; &quot;12 7&quot; &quot;13 1&quot; &quot;13 5&quot; &quot;13 6&quot; &quot;13 7&quot; &quot;13 8&quot; &quot;13 9&quot; &quot;14 1&quot; &quot;14 3&quot;
# [41] &quot;14 5&quot; &quot;14 6&quot; &quot;14 7&quot; &quot;14 9&quot; &quot;15 1&quot; &quot;15 3&quot; &quot;15 4&quot; &quot;15 5&quot; &quot;15 6&quot; &quot;15 7&quot;
# [51] &quot;15 9&quot; &quot;16 1&quot; &quot;16 5&quot; &quot;16 7&quot; &quot;16 9&quot;




# &quot;16 1&quot; &quot;16 5&quot; &quot;16 7&quot; &quot;16 9&quot;

#codificamos a a años de educación
pobla_enighc1998&lt;-pobla_enigh1998%&gt;%
   mutate(
   edu_a = ifelse(ed_formal==1 &amp; ed_tecnica==1,0,    #sin instruccion(1)
          ifelse((ed_formal %in% c(2,3,4,5,6,7,8,9,10,11,12,13))
                 &amp; (ed_tecnica %in% c(1,2)),ed_formal-1,
          ifelse(ed_formal==8 &amp; (ed_tecnica %in% c(3,4,5)),9,
          ifelse(ed_formal==9 &amp; (ed_tecnica %in% c(4,5)),10,
          ifelse(ed_formal==10 &amp; (ed_tecnica %in% c(2,4,5)),11,
          ifelse(ed_formal==11 &amp; (ed_tecnica %in% c(3,4,5,5,7)),12,
          ifelse((ed_formal %in%c(12)) &amp; (ed_tecnica %in% c(3,5,6,7)),12,
          ifelse(ed_formal==13 &amp; (ed_tecnica %in% c(5,6,7,8,9)),13,
          ifelse(ed_formal==14 &amp; (ed_tecnica %in% c(1,3,5,6,7,9)),14,
          ifelse(ed_formal==15 &amp; (ed_tecnica %in% c(1,3,4,5,6,7,9)),17,19))))))))))
  )

unique(pobla_enighc1998$edu_a )

#codificamos a coghort de educación

pobla_enighc1998&lt;-pobla_enighc1998%&gt;%
   mutate(
   edu_ac = ifelse(edu_a %in% 0:5,&quot;C1&quot;,    
          ifelse(edu_a %in% 6:10 ,&quot;C2&quot;,
          ifelse(edu_a %in% 11:12,&quot;C3&quot;,
          ifelse(edu_a %in% 13:14,&quot;C4&quot;,&quot;C5&quot;))))
  )

unique(pobla_enighc1998$edu_ac )</code></pre>
</div>
<div id="etiquetamos-region" class="section level2">
<h2>etiquetamos region</h2>
<pre class="r"><code>pobla_enighc1998&lt;-pobla_enighc1998%&gt;%
          mutate(
            region = ifelse(estado %in% c(&quot;02&quot;,&quot;26&quot;,&quot;08&quot;,&quot;05&quot;,&quot;19&quot;,&quot;28&quot;),1,
                     ifelse(estado %in% c(&quot;12&quot;,&quot;20&quot;,&quot;07&quot;,&quot;30&quot;,&quot;27&quot;,&quot;04&quot;,&quot;31&quot;,&quot;23&quot;),5,0))
          )</code></pre>
</div>
<div id="cod-esru" class="section level2">
<h2>cod ESRU</h2>
<pre class="r"><code>dfh_c&lt;- dfh%&gt;%
   mutate(
   pp_educ_a = ifelse(pp_educ==1,1,    #sin instruccion(1)
          ifelse(pp_educ==2,1+pp_educg,
          ifelse(pp_educ %in% c(3,4),7+pp_educg,
          ifelse(pp_educ %in% c(5,6,7,8,9),10+pp_educg,
          ifelse(pp_educ %in% c(10,11),13+pp_educg,17+pp_educg)))))
  )

  

unique(dfh_c$pp_educ_a)

dfh_c&lt;-dfh_c%&gt;%
  mutate(
   pp_educ_ac = ifelse(pp_educ_a %in% 0:5,&quot;C1&quot;,    
          ifelse(pp_educ_a %in% 6:10 ,&quot;C2&quot;,
          ifelse(pp_educ_a %in% 11:12,&quot;C3&quot;,
          ifelse(pp_educ_a %in% 13:14,&quot;C4&quot;,&quot;C5&quot;))))
  )</code></pre>
<p>##sel ingresos padres</p>
<pre class="r"><code>ingresos&lt;-read.dbf(
              file=&quot;Datos/ENIGH-Historica/1998/ingresos.dbf&quot;
              )</code></pre>
<pre class="r"><code>familias_integrantes &lt;- function(df,nr){
  dfn &lt;- df %&gt;%
    filter(NUM_REN %in% nr)
  return(dfn)
} 



ingresos_acu &lt;- function(df,clavs){
 dfn &lt;- df %&gt;%
   group_by(FOLIO, NUM_REN) %&gt;%
   filter(CLAVE %in% clavs)%&gt;%
   summarise(
   claves_a = paste(CLAVE,collapse = &quot;,&quot;),
  ing_tri_t = sum(ING_TRI),
  ing_men_p = ing_tri_t/3,
  ling_men_p = log(ing_men_p)
  ) %&gt;% ungroup()
 
 
 return(dfn)
}

#hogares &lt;- c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;)
personas_h &lt;- c(&#39;01&#39;)

a&lt;-familias_integrantes(ingresos,personas_h)
a
claves&lt;-c(&quot;P001&quot;,&quot;P002&quot;,&quot;P003&quot;,&quot;P010&quot;,&quot;P011&quot;,&quot;P012&quot;,&quot;P013&quot;,&quot;P014&quot;,&quot;P015&quot;, &quot;P016&quot;,&quot;P017&quot;,&quot;P018&quot;,&quot;P020&quot;,&quot;P021&quot;,&quot;P026&quot;,&quot;P027&quot;,&quot;P035&quot;,&quot;P040&quot;,&quot;P041&quot;,&quot;P042&quot;,&quot;P044&quot;,&quot;P045&quot;)
ingre_enigh1998&lt;-ingresos_acu(a,claves) 
ingre_enigh1998&lt;-ingre_enigh1998%&gt;%
  select(FOLIO,NUM_REN,ling_men_p)%&gt;%
  rename(
    folio = FOLIO,
    num_ren = NUM_REN
  )
ingre_enigh1998</code></pre>
</div>
<div id="regresion-padres-1" class="section level2">
<h2>Regresion padres</h2>
<pre class="r"><code>data_padres1998&lt;-full_join(pobla_enighc1998,ingre_enigh1998)%&gt;%
  drop_na()%&gt;%
   mutate(
     ocupacion = substr(ocupacion,1,2)
   )#%&gt;%
  # rename(
  #   EDU=N_INSTR161,
  #   OCU = CMO121
  # )%&gt;%
  # mutate(
  #   EDU = as.character(EDU)
  # )
data_padres1998

unique(data_padres1998$edad)

# ajuste para nivel de ecucación ESRU

#data_padres2005$EDU &lt;- factor(data_padres2005$EDU)
#data_padres2005$OCU &lt;- factor(data_padres2005$OCU)

#unique(data_padres2005$OCU)</code></pre>
<pre class="r"><code>reg_padres&lt;-lm(
  formula = ling_men_p ~ edu_ac + ocupacion + edad +I(edad*edad),
  data = data_padres1998
)
summary(reg_padres)</code></pre>
</div>
<div id="inser-padre-en-hijo-1" class="section level2">
<h2>Inser padre en hijo</h2>
<p>sacamso coeficeicneite de educación y ocupación</p>
<pre class="r"><code># data&lt;- data.frame(
#    edu_ac= &quot;C1&quot;,
#   ocupacion= &quot;11&quot;,
#   edad = 0
#  )
# 
# predict(object = reg_padres,   
#         newdata = data)
 
#unique(dfh_c$pp_ocup)
#sum(is.na(dfh_c$pp_ocup)) podemos utiizar la ocupación como instrumento tambien, solo se pierden 12 muestras

dfh_cna&lt;-dfh_c%&gt;%drop_na(pp_ocup,pp_edad)

data&lt;- data.frame(
    edu_ac= dfh_cna$pp_educ_ac,
   ocupacion= dfh_cna$pp_ocup,
   edad = 0
  )

dfhpf&lt;- dfh_cna%&gt;%
  mutate(ling_p = predict(object = reg_padres,   
        newdata = data)) 
dfhpf


# SI solo instrumentamos por eduacion




hchart(dfhpf,&quot;scatter&quot;,hcaes( x = ling_p, y = ling_h) )</code></pre>
</div>
<div id="eii-todos" class="section level2">
<h2>EII Todos</h2>
<pre class="r"><code>reg_hp&lt;-lm(
  formula = ling_h ~ ling_p + edad_h+ I(edad_h*edad_h)+ substr(ocu_h,1,2),
  data = dfhpf
)
summary(reg_hp)</code></pre>
<pre class="r"><code>padres_h %&gt;%
  count(mov)%&gt;% 
  mutate(freq = round(100 * n/sum(n), 0))%&gt;%
  hchart(&#39;column&#39;,
         hcaes( y = &#39;freq&#39;))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;Percepción de movilidad&quot;
  ) %&gt;%
  hc_subtitle(text = &quot;&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Porcentaje&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Tipo de percepción&quot;),
           categories = get_labels(padres_h$mov)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))</code></pre>
</div>
</div>
<div id="estimación-regional" class="section level1">
<h1>Estimación regional</h1>
<pre class="r"><code>reg_padres&lt;-lm(
  formula = ling_men_p ~ edu_ac + ocupacion + edad +I(edad*edad),
  data = data_padres1998, subset=(region==1))
summary(reg_padres)</code></pre>
<div id="inser-padre-en-hijo-2" class="section level2">
<h2>Inser padre en hijo</h2>
<p>sacamso coeficeicneite de educación y ocupación</p>
<pre class="r"><code># data&lt;- data.frame(
#    edu_ac= &quot;C1&quot;,
#   ocupacion= &quot;11&quot;,
#   edad = 0
#  )
# 
# predict(object = reg_padres,   
#         newdata = data)
 
#unique(dfh_c$pp_ocup)
#sum(is.na(dfh_c$pp_ocup)) podemos utiizar la ocupación como instrumento tambien, solo se pierden 12 muestras

dfh_cna&lt;-dfh_c%&gt;%
  filter(region==&quot;1&quot;)%&gt;%
  drop_na(pp_ocup)

data&lt;- data.frame(
    edu_ac= dfh_cna$pp_educ_ac,
   ocupacion= dfh_cna$pp_ocup,
   edad = 0
  )

dfhpf&lt;- dfh_cna%&gt;%
  mutate(ling_p = predict(object = reg_padres,   
        newdata = data)) 
dfhpf






hchart(dfhpf,&quot;scatter&quot;,hcaes( x = ling_p, y = ling_h) )</code></pre>
</div>
<div id="eii-regional-1" class="section level2">
<h2>EII regional 1</h2>
<pre class="r"><code>reg_hp&lt;-lm(
  formula = ling_h ~ ling_p + edad_h+ I(edad_h*edad_h)+ substr(ocu_h,1,2),
  data = dfhpf
)
summary(reg_hp)</code></pre>
</div>
<div id="comprobación-de-resueltado-1" class="section level2">
<h2>Comprobación de resueltado</h2>
<pre class="r"><code>padres_h %&gt;%
  filter(region==&quot;1&quot;)%&gt;%
  count(mov)%&gt;%
  mutate(freq = round(100 * n/sum(n), 0))%&gt;%
  hchart(&#39;column&#39;,
         hcaes( y = &#39;freq&#39;))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;Percepción de movilidad region 1&quot;
  ) %&gt;%
  hc_subtitle(text = &quot;Para el color de piel se revisa la escala&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Porcentaje&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Edad&quot;),
           categories = get_labels(padres_h$vo)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))</code></pre>
</div>
</div>
<div id="estimación-regional-5" class="section level1">
<h1>Estimación regional 5</h1>
<pre class="r"><code>reg_padres&lt;-lm(
  formula = ling_men_p ~ edu_ac + ocupacion + edad +I(edad*edad),
  data = data_padres1998, subset=(region==5))
summary(reg_padres)</code></pre>
<div id="inser-padre-en-hijo-3" class="section level2">
<h2>Inser padre en hijo</h2>
<p>sacamso coeficeicneite de educación y ocupación</p>
<pre class="r"><code># data&lt;- data.frame(
#    edu_ac= &quot;C1&quot;,
#   ocupacion= &quot;11&quot;,
#   edad = 0
#  )
# 
# predict(object = reg_padres,   
#         newdata = data)
 
#unique(dfh_c$pp_ocup)
#sum(is.na(dfh_c$pp_ocup)) podemos utiizar la ocupación como instrumento tambien, solo se pierden 12 muestras

dfh_cna&lt;-dfh_c%&gt;%
  filter(region==&quot;5&quot;)%&gt;%
  drop_na(pp_ocup)

data&lt;- data.frame(
    edu_ac= dfh_cna$pp_educ_ac,
   ocupacion= dfh_cna$pp_ocup,
   edad = 0
  )

dfhpf&lt;- dfh_cna%&gt;%
  mutate(ling_p = predict(object = reg_padres,   
        newdata = data)) 
dfhpf






hchart(dfhpf,&quot;scatter&quot;,hcaes( x = ling_p, y = ling_h) )</code></pre>
</div>
<div id="eii-regional-1-1" class="section level2">
<h2>EII regional 1</h2>
<pre class="r"><code>reg_hp&lt;-lm(
  formula = ling_h ~ ling_p + edad_h+ I(edad_h*edad_h)+ substr(ocu_h,1,2),
  data = dfhpf
)
summary(reg_hp)</code></pre>
</div>
<div id="comprobación-de-resueltado-2" class="section level2">
<h2>Comprobación de resueltado</h2>
<pre class="r"><code>padres_h %&gt;%
  filter(region==&quot;5&quot;)%&gt;%
  count(mov)%&gt;%
  mutate(freq = round(100 * n/sum(n), 0))%&gt;%
  hchart(&#39;column&#39;,
         hcaes( y = &#39;freq&#39;))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;Percepción de movilidad region 1&quot;
  ) %&gt;%
  hc_subtitle(text = &quot;Para el color de piel se revisa la escala&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Porcentaje&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Tipo de percepción&quot;),
           categories = get_labels(padres_h$vo)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))</code></pre>
</div>
</div>
<div id="recuperadoas" class="section level1">
<h1>recuperadoas</h1>
<pre class="r"><code># un solo ingreso, el jefe responde

# pregunta p2, comparten el mimso gasto para comer: 1 ) Si 2 ) No
# pregunta p08, es el jefe del hogar: 1 ) Si 
# pregunta p12. actualmente estudia, 1)Si 2)No
# p68, Personas que trabajan, 1. Si, 2. No
cambiar_eti(&#39;p133&#39;,enco = &quot;Windows-1252&quot;)

data1_emovi2017 &lt;-  data_emovi2017 %&gt;% 
  filter(p02 == 1)  %&gt;%
  filter(p08 == 1)  %&gt;% 
  filter(p12 == 2)  %&gt;%
  filter(p68 == 1 | p69 == 1)  %&gt;%
  filter(p132 == 1) %&gt;%
  filter(!p133 %in% c(8,9,NA) ) %&gt;%
  filter(p134a != 8) %&gt;%
  filter(p134b != 8) %&gt;%
  filter(p134c != 8) %&gt;%
  filter(p134d != 8) %&gt;%
  filter(p134e != 8) %&gt;%
  filter(p134f != 8) %&gt;%
  filter(p134g != 8) %&gt;%
  filter(p134h != 8) %&gt;%
  filter(p134i != 8) 


plota &lt;- data1_emovi2017 %&gt;%
  count(Estado) %&gt;%
  hchart(&#39;treemap&#39;,
         hcaes(x = paste(get_labels(Estado),&#39; &#39;,&#39;(&#39;, n,&#39;)&#39;, sep = &#39;&#39;), value=&#39;n&#39;, color = &#39;n&#39;)) %&gt;%
  hc_add_theme(hc_theme_ffx()) %&gt;%
  hc_title(
    text = &quot;Número de entrevistados por estado&quot;
  )%&gt;% 
  hc_subtitle(text = paste(&quot;Total de participates: &quot; , toString(nrow(data1_emovi2017)))) %&gt;%
  hc_exporting(enabled = TRUE,
               filename = &quot;archivo&quot;,
               sourceWidth =  1000,
               sourceHeight = 640,
               scale = 10,
              
               buttons = list(contextButton = list(menuItems = myMenuItems))
  )


plota

data1_emovi2017 %&gt;%
  count(Estado, p06)%&gt;% 
  hchart(&#39;column&#39;,
         hcaes( y = &#39;n&#39;,  group = as_label(p06)))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;Número de entrevistados por estado y sexo&quot;
  ) %&gt;%
  #hc_subtitle(text = &quot;Las edades están agrupadas en intervalos 
   #           de 10 años (da clic sobre F o M)&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Número de participantes&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Estados&quot;),
           categories = get_labels(data1_emovi2017$Estado)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))

data1_emovi2017 %&gt;%
  count(p13,p06)%&gt;% 
  hchart(&#39;column&#39;,
         hcaes( y = &#39;n&#39;,  group = as_label(p06)))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;Escolaridad por  sexo&quot;
  ) %&gt;%
  #hc_subtitle(text = &quot;Las edades están agrupadas en intervalos 
   #           de 10 años (da clic sobre F o M)&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Número de participantes&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Escolaridad&quot;),
           categories = get_labels(data1_emovi2017$p13)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))

data1_emovi2017 %&gt;%
  count(p133,p06)%&gt;% 
  hchart(&#39;column&#39;,
         hcaes( y = &#39;n&#39;,  group = as_label(p06)))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;Ingreso por sexo por  sexo&quot;
  ) %&gt;%
  #hc_subtitle(text = &quot;Las edades están agrupadas en intervalos 
   #           de 10 años (da clic sobre F o M)&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Número de participantes&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Catehoria de ingreso&quot;),
           categories = get_labels(data1_emovi2017$p133)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))

data1_emovi2017 %&gt;%
  count(p133,p13)%&gt;% 
  hchart(&#39;column&#39;,
         hcaes( y = &#39;n&#39;,  group = as_label(p13)))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;Educación por cohort de ingreso (1 solo ingreso)&quot;
  ) %&gt;%
  #hc_subtitle(text = &quot;Las edades están agrupadas en intervalos 
   #           de 10 años (da clic sobre F o M)&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Número de participantes&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Categoria de ingreso&quot;),
           categories = get_labels(data1_emovi2017$p133)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))



data1_emovi2017 %&gt;%
  count(p133,p131)%&gt;% 
  hchart(&#39;column&#39;,
         hcaes( y = &#39;n&#39;,  group = as_label(p131)))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;Carros por cohort de ingreso (1 solo ingreso)&quot;
  ) %&gt;%
  #hc_subtitle(text = &quot;Las edades están agrupadas en intervalos 
   #           de 10 años (da clic sobre F o M)&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Número de participantes&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Categoria de ingreso&quot;),
           categories = get_labels(data1_emovi2017$p133)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))


data1_emovi2017 %&gt;%
  count(p133,p122)%&gt;% 
  hchart(&#39;column&#39;,
         hcaes( y = &#39;n&#39;,  group = as_label(p122)))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;Cuartos por cohort de ingreso (1 solo ingreso)&quot;
  ) %&gt;%
  #hc_subtitle(text = &quot;Las edades están agrupadas en intervalos 
   #           de 10 años (da clic sobre F o M)&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Número de participantes&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Categoria de ingreso&quot;),
           categories = get_labels(data1_emovi2017$p133)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))</code></pre>
</div>
<div id="esru-emovi-2011" class="section level1">
<h1>ESRU-EMOVI 2011</h1>
<div id="justificar">
<p>La ESRU – EMOVI 2011 se diseñó para continuar el estudio nacional sobre la movilidad social iniciado en 2006. Para esta ocasión, se realizaron 11,001 entrevistas efectivas con información representativa a nivel nacional de hombres y mujeres entre 25 y 64 años de edad, por tipo de jefatura del hogar y de ámbitos urbano y no urbano. Los principales objetivos de la ESRU – EMOVI 2011 son:</p>
<ol style="list-style-type: lower-alpha">
<li>Conocer el grado de asociación entre los recursos de los padres y el logro socioeconómico de los hijos.</li>
<li>Identificar las barreras que limitan la posibilidad de que las personas experimenten movilidad social.</li>
</ol>
<p>Encuesta dirigida por el Programa de Movilidad Social del CEEY y financiada por la Fundación ESRU.</p>
</div>
</div>
<div id="esru-emovi-2006" class="section level1">
<h1>ESRU-EMOVI 2006</h1>
<div id="justificar">
<p>La ESRU – EMOVI 2006 es una de las primeras encuestas de cobertura nacional diseñada con el objetivo de medir la movilidad social en México. La encuesta es un corte transversal que incluye preguntas retrospectivas sobre la situación socioeconómica de los padres del entrevistado con el objetivo de observar la influencia que tienen los recursos de los padres en la posición socioeconómica de sus hijos.</p>
<p>Para este levantamiento se realizaron 7,288 entrevistas efectivas con información representativa a nivel nacional de hombres, jefes de hogar, entre 25 y 64 años de edad.</p>
<p>Encuesta dirigida por Florencia Torche y financiada por la Fundación ESRU.</p>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiRGF0b3MgRVNSVS1FTU9WSSIKYXV0aG9yOiAiUmFmYWVsIE1hcnTDrW5leiBNYXJ0w61uZXoiCm91dHB1dDogCiAgaHRtbF9kb2N1bWVudDoKICAgIHRvYzogdHJ1ZQogICAgdG9jX2Zsb2F0OiB0cnVlCiAgICBudW1iZXJfc2VjdGlvbnM6IGZhbHNlCiAgICBjb2RlX2Rvd25sb2FkOiB0cnVlCiAgICBjb2RlX2ZvbGRpbmc6IGhpZGUKLS0tCgpgYGB7ciBzZXR1cCwgaW5jbHVkZT1GQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLCBtZXNzYWdlID0gRkFMU0UsIGV2YWw9RkFMU0UsIHdhcm5pbmcgPSBGQUxTRSkKYGBgCjxkaXYgaWQgPSAianVzdGlmaWNhciI+CkxvcyBkYXRvcyBzZSByZWN1cGVyYXJvbiBkZWwgc2l0aW8gZGVsIFtDRUVZXVtdIGRvbmRlIHNlIHRpZW5lbiBsYXMgZW5jdWVzdGFzIEVTUlUtRU1PVkkgKExhcyBlc2N1ZXN0YXMgZGUgbGEgZnVuZGFjacOzbiBFc3Bpbm9zYSBSdWdhcmPDrWEgZGUgTW92aWxpZGFkIFNvaWNhbCBlbiBNw6l4aWNvKSBwYXJhIGxvcyBsZXZhbnRhbWllbnRvczogMjAwNiwgMjAxMSB5IDIwMTcuIAoKQ2FkYSB1bmEgZGUgbGFzIGVuY3VlbnRhcyB0aWVuZSBkaXN0aW50b3Mgb2JqZXRpdm9zLCBxdWUgc2UgZXhwbGljYXLDoW4gZW4gbGFzIHNpZ3VpZW50ZXMgc2VjY2lvbmVzLiBQYXJhIG1heW9yZXMgZGV0YWxsZXMgc29icmUgbGFzIGVuY3VldGFzIHNlIHB1ZWRlIGNvbnN1bHRhciBlbCBzaXRpbyBvZmljaWFsIGRvbmRlIHNlIGVuY3VldHJhbiBhbG9qYWRvcyBsb3MgZGF0b3MgW0NFRVldW10uCjwvZGl2PgogIFtDRUVZXTogaHR0cHM6Ly9jZWV5Lm9yZy5teC9jb250ZW5pZG8vcXVlLWhhY2Vtb3MvZW1vdmkvCgoKCgoKCmBgYHtyIGNhcmdhcl9iaWxpb3RlY2FzLCBldmFsID0gVFJVRX0KbGlicmFyeSh0aWR5dmVyc2UpCmxpYnJhcnkoaGF2ZW4pICMgaW1wb3J0YSwgZW50cmUgb3Ryb3Mgc29mdHdhcmUsIGRlIFN0YXRhCmxpYnJhcnkoc2psYWJlbGxlZCkgIyBtYW5lamFyIGxhYmVscyBkZSBsYXMgdmFyaWFibGVzIApsaWJyYXJ5KG9wZW54bHN4KSAjIGxlZXIgYXJjaGl2b3MgZGUgZXhjZWwKbGlicmFyeShEVCkgIyB2aXN1YWxpemFyIGEgdGFibGFzCmxpYnJhcnkoZGF0YS50YWJsZSkgIyBjb252ZXJ0aXIgYSB0YWJsYXMKbGlicmFyeShoaWdoY2hhcnRlcikgIyBncsOhZmljYXMgaW50ZXJhY3RpdmFzCmxpYnJhcnkoZm9yZWlnbikKYGBgCgojIEVTUlUtRU1PVkkgMjAxNwoKPGRpdiBpZCA9ICJqdXN0aWZpY2FyIj4KUG9yIHByaW1lcmEgdmV6IHkgZ3JhY2lhcyBhbCBlbmZvcXVlIHRlcnJpdG9yaWFsIGRlIGxhIEVTUlUg4oCTIEVNT1ZJIDIwMTcsIGVzIHBvc2libGUgbWVkaXIgbGEgbW92aWxpZGFkIHNvY2lhbCBwb3IgcmVnaW9uZXMuIExhIGVuY3Vlc3RhIGRlIDIwMTcsIGFsIGlndWFsIHF1ZSBsYXMgYW50ZXJpb3JlcywgdGllbmUgY29tbyBmaW5hbGlkYWQgcHJpbmNpcGFsIG1lZGlyIGxhIG1vdmlsaWRhZCBzb2NpYWwgaW50ZXJnZW5lcmFjaW9uYWwuIEN1ZW50YSBjb24gMTcsNjY1IGVudHJldmlzdGFzIHkgZXMgcmVwcmVzZW50YXRpdmEgZGUgaG9tYnJlcyB5IG11amVyZXMgZW50cmUgMjUgeSA2NCBhw7FvcyBhIG5pdmVsIG5hY2lvbmFsLCBwYXJhIGxhIENpdWRhZCBkZSBNw6l4aWNvIHkgY2luY28gcmVnaW9uZXMgZGVsIHBhw61zOiBub3J0ZSwgbm9ydGUtb2NjaWRlbnRlLCBjZW50cm8sIGNlbnRyby1ub3J0ZSB5IHN1ci4gTG9zIG9iamV0aXZvcyBkZSBsYSBFU1JVLUVNT1ZJIDIwMTcgc29uOgoKYSkgQ29udGFyIGNvbiBpbmZvcm1hY2nDs24gYWN0dWFsaXphZGEgZW4gbGFzIGRpc3RpbnRhcyBkaW1lbnNpb25lcyBkZSBsYSBtb3ZpbGlkYWQgc29jaWFsIGEgbml2ZWwgbmFjaW9uYWwuCgphKSBHZW5lcmFyIGVzdGltYWNpb25lcyBkZSBtb3ZpbGlkYWQgcGFyYSBjaW5jbyByZWdpb25lcyBkZWwgcGHDrXMgeSBsYSBDaXVkYWQgZGUgTcOpeGljby4KCmEpIEFuYWxpemFyIGxvcyBwYXRyb25lcyBkZSBtb3ZpbGlkYWQgc29jaWFsIGRlc2RlIGxhIHBlcnNwZWN0aXZhIGRlIGxhIGRlc2lndWFsZGFkIGRlIG9wb3J0dW5pZGFkZXMuCgpFbmN1ZXN0YSBmaW5hbmNpYWRhIHBvciBsYSBGdW5kYWNpw7NuIEVTUlUuCgo8L2Rpdj4KCmBgYHtyIHZhcl9lbnRyZV9lbW92aTIwMTd9CmRlc192YXJfZW50cmV2aXN0YWRvIDwtIHJlYWQueGxzeCgKICAgICAgICAgICAgICAgICAgICAgICAgICB4bHN4RmlsZSA9ICJEYXRvcy9FU1JVLUVNT1ZJLTIwMTcvRGljY2lvbmFyaW8tRVNSVS1FTU9WSS0yMDE3Lnhsc3giCiAgICAgICAgICAgICAgICAgICAgICAgICkKZGF0YXRhYmxlKGFzLmRhdGEudGFibGUoZGVzX3Zhcl9lbnRyZXZpc3RhZG8pLG9wdGlvbnMgPSBsaXN0KHBhZ2VMZW5ndGggPSA1KSkKYGBgCgoKYGBge3J9CmRlc192YXJfaG9nYXIgPC0gcmVhZC54bHN4KAogICAgICAgICAgICAgICAgICAgeGxzeEZpbGUgPSAiRGF0b3MvRVNSVS1FTU9WSS0yMDE3L0RpY2Npb25hcmlvLUVTUlUtRU1PVkktMjAxNy54bHN4IiwKICAgICAgICAgICAgICAgICAgIHNoZWV0ID0gMgogICAgICAgICAgICAgICAgICkKZGF0YXRhYmxlKGFzLmRhdGEudGFibGUoZGVzX3Zhcl9ob2dhciksb3B0aW9ucyA9IGxpc3QocGFnZUxlbmd0aCA9IDUpKQpgYGAKCgoKCmBgYHtyIGNhcmdhciBkYXRvcywgZXZhbCA9IFRSVUV9CgpjYXJnYXI8LSBmdW5jdGlvbigpewoKZGF0b3NfZSA8PC0gcmVhZF9zdGF0YSgKICAgICAgICAgICAgICAgICAgICAgcGF0aCA9ICJEYXRvcy9FU1JVLUVNT1ZJLTIwMTcvRVNSVS1FTU9WSS0yMDE3LUVudHJldmlzdGFkby5kdGEiLAogICAgICAgICAgICAgICAgICAgICBhdG9taWMudG8uZmFjID0gVFJVRSwKICAgICAgICAgICAgICAgICAgICAgZW5jID0gTlVMTCwKICAgICAgICAgICAgICAgICAgICAgKQp9CgpkYXRhX2hvZ2FyIDwtIHJlYWRfc3RhdGEoCiAgICAgICAgICBwYXRoID0gICJEYXRvcy9FU1JVLUVNT1ZJLTIwMTcvRVNSVS1FTU9WSS0yMDE3LUhvZ2FyLmR0YSIsCiAgICAgICAgICAgICAgICAgICAgIGF0b21pYy50by5mYWMgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICBlbmMgPSBOVUxMCiAgICAgICAgICAgICAgICAgICAgICkKCmNhcmdhcigpCmRhdGFfZW1vdmkyMDE3PC1kYXRvc19lIApgYGAKCgoKCgo8ZGl2IGlkID0gImp1c3RpZmljYXIiPgpBbCBtb21lbnRvIGRlIGV4cG9ydGFyIGEgUiwgZXhpc3RlbiBlcnJvcmVzIGVuIGxhcyBldGlxZXV0YXMgZGUgbGFzIHZhcmlhYmxlcyB5IGRlIGxvcyB2YWxvcmVzLiBMYXMgZXRpcXVldGVzIGRlIGxhcyB2YXJpYWJsZXMgZGVzY3JpYmVuIGNvbiBtYXlvciBwcmVjaXNpw7NuIGEgZGljaGFzIHZhcmlhYmxlcy4gTWllbnRyYXMgcXVlIGxhcyBldGlxdWV0YXMgZGUgbG9zIHZvbG9yZXMgZXN0w6FuIGFzb2NpYWRhcyBhIGRhdG9zIGNhdGVnw7NyaWNvcy4gRXhpc3RlbiBkaXZlcnNhcyBmb3JtYWFzIGRlIGxpZGlhciBjb24gZXN0ZSBwcm9ibGVtYS4gTGEgZm9ybWEgcXVlIHNlIHV0aWxpemFyw6EgKHBvciBlbCBtb21lbnRvLCBlc3RvIHNlIHBvZHLDrWEgb3B0aW1pemFyKSBlcyBoYWNlciB1bmEgY29udmVyc2nDs24gZGUgY29kaWZpY2FjacOzbiBlbnRyZSBsb3MgZm9ybWF0b3MgZGUgd2luZG93cyB5IG1hYywgc29sbyBlbiBjYXNvIGRlIHNlciBuZWNlc2FyaW8uIE5vIGVzIHBvc2libGUgaGFjZXIgdW5hIGNvdmVyc2nDs24gZ2VuZXJhbCAocG9yIGVsIG1vbWVudG8sIHBvZHLDrWEgb3B0aW1pemFyc2UpIHB1ZXMgYWxndW5hcyBjb2RpZmljYWNpb25lcyBzb24gY29ycmVjdGFzIHkgb3RyYXMgbm8uCjwvZGl2PgoKYGBge3IgZnVuY2lvbmVzIGNvZGlmaWNhciwgZXZhbCA9IFRSVUV9CiNhIDwtIGdldF9sYWJlbChkYXRhX2Vtb3ZpMjAxNyRlc3RfZGlzKQojYiA8LSBnZXRfbGFiZWxzKGRhdGFfZW1vdmkyMDE3JEVzdGFkbykKI3ByaW50KGEpCiNwcmludChiKQoKY29kaV9ldGlxdWV0YXMgPC0gZnVuY3Rpb24oZGZfdmFyLCBlbmNvID0gIklTT184ODU5LTE1Iil7CnJldHVybihzZXRfbGFiZWxzKAogICAgICAgICAgICAgICAgICAgICAgICAgIGRmX3ZhciwKICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbHMgPXVubGlzdCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXBwbHkoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRfbGFiZWxzKGRmX3ZhciksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpY29udixmcm9tPSAiVVRGLTgiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG89ZW5jbyMKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAgICkKKQp9Cgpjb21wcm9fZXRpIDwtIGZ1bmN0aW9uKHZhciwgZW5jbyA9ICJJU09fODg1OS0xNSIgKXsKZGF0YV9lMiA8LSBkYXRhX2Vtb3ZpMjAxNwpwcmludChnZXRfbGFiZWxzKGRhdGFfZTJbW3Zhcl1dKSkKI2NvZGlfZXRpcXVldGFzKGRhdGFfZTIkZXpvbmEpCmRhdGFfZTJbW3Zhcl1dIDwtIGNvZGlfZXRpcXVldGFzKGRhdGFfZTJbW3Zhcl1dLGVuY28pCnByaW50KGdldF9sYWJlbHMoZGF0YV9lMltbdmFyXV0pKQp9CgpjYW1iaWFyX2V0aSA8LSBmdW5jdGlvbih2YXIsIGVuY289IklTT184ODU5LTE1Iil7CmRhdGFfZW1vdmkyMDE3W1t2YXJdXSA8PC0gY29kaV9ldGlxdWV0YXMoZGF0YV9lbW92aTIwMTdbW3Zhcl1dLGVuY28pCnByaW50KGdldF9sYWJlbHMoZGF0YV9lbW92aTIwMTdbW3Zhcl1dKSkKfQoKCgojZ2V0X2xhYmVscyhkYXRhX2Vtb3ZpMjAxNykKI2dldF9sYWJlbHMoZGF0YV9lbW92aTIwMTckZXpvbmEpCiNzdHIoZ2V0X2xhYmVscyhkYXRhX2Vtb3ZpMjAxNykpCiNyZXBsYWNlX2xhYmVscyhkYXRhX2Vtb3ZpMjAxNywKI2xhYmVscz1pY29udihnZXRfbGFiZWxzKGRhdGFfZW1vdmkyMDE3KSwiVVRGLTgiLCJJU09fODg1OS0xNSIpKQojbGFwcGx5KGdldF9sYWJlbHMoZGF0YV9lbW92aTIwMTcpLCBpY29udixmcm9tPSAiVVRGLTgiLHRvPSJJU09fODg1OS0xNSIpCgojZ2V0X2xhYmVscyhkYXRhX2Vtb3ZpMjAxNyRlem9uYSkKI2RhdGFfZTIgPC0gZGF0YV9lbW92aTIwMTcKI3ByaW50KGdldF9sYWJlbHMoZGF0YV9lMlsnZXpvbmEnXSkpCiNjb2RpX2V0aXF1ZXRhcyhkYXRhX2UyJGV6b25hKQojZGF0YV9lMlsnZXpvbmEnXSA8LSBjb2RpX2V0aXF1ZXRhcyhkYXRhX2UyWydlem9uYSddKSMKI3ByaW50KGdldF9sYWJlbHMoZGF0YV9lMlsnZXpvbmEnXSkpCiNnZXRfbGFiZWxzKGRhdGFfZTIkZXpvbmEpCgoKI2NvbXByb19ldGkoInAxMyIpCiNjYW1iaWFyX2V0aSgncDEzJykKI2NvbXByb19ldGkoJ2V6b25hJykKI2NhbWJpYXJfZXRpKCdlem9uYScpCmNhbWJpYXJfZXRpKCdwMTMzJyxlbmNvID0gIldpbmRvd3MtMTI1MiIpCmBgYAoKYGBge3IsIGV2YWwgPSBGQUxTRX0Kc3RyKGRhdGFfZW1vdmkyMDE3KQp2aWV3KGRhdGFfZW1vdmkyMDE3KQpgYGAKCgojIyBFbnRyZXZpc3RhZG9zIHBvciBlc3RhZG8KCmBgYHtyIGVudHJldmlzdGFkb3NfZXN0YWRvLCBmaWcud2lkdGggPSAxMDAsIGZpZy5oZWlnaHQ9IDQwfQoKbXlNZW51SXRlbXMgPC0gYygiZG93bmxvYWRQTkciLCAiZG93bmxvYWRKUEVHIiwgImRvd25sb2FkUERGIiwgJ2Rvd25sb2FkU1ZHJywgJ3ByaW50Q2hhcnQnKQpwbG90YSA8LSBkYXRhX2Vtb3ZpMjAxNyAlPiUKICBjb3VudChFc3RhZG8pICU+JQogIGhjaGFydCgndHJlZW1hcCcsCiAgICAgICAgIGhjYWVzKHggPSBwYXN0ZShnZXRfbGFiZWxzKEVzdGFkbyksJyAnLCcoJywgbiwnKScsIHNlcCA9ICcnKSwgdmFsdWU9J24nLCBjb2xvciA9ICduJykKICApICU+JQogIGhjX2FkZF90aGVtZShoY190aGVtZV9mZngoKSkgJT4lCiAgaGNfdGl0bGUoCiAgICB0ZXh0ID0gIk7Dum1lcm8gZGUgZW50cmV2aXN0YWRvcyBwb3IgZXN0YWRvIgogICklPiUgCiAgaGNfc3VidGl0bGUodGV4dCA9IHBhc3RlKCJUb3RhbCBkZSBwYXJ0aWNpcGF0ZXM6ICIgLCB0b1N0cmluZyhucm93KGRhdGFfZW1vdmkyMDE3KSkpKSAlPiUKICBoY19leHBvcnRpbmcoZW5hYmxlZCA9IFRSVUUsCiAgICAgICAgICAgICAgIGZpbGVuYW1lID0gImFyY2hpdm8iLAogICAgICAgICAgICAgICBzb3VyY2VXaWR0aCA9ICAxMDAwLAogICAgICAgICAgICAgICBzb3VyY2VIZWlnaHQgPSA2NDAsCiAgICAgICAgICAgICAgIHNjYWxlID0gMTAsCiAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgIGJ1dHRvbnMgPSBsaXN0KGNvbnRleHRCdXR0b24gPSBsaXN0KG1lbnVJdGVtcyA9IG15TWVudUl0ZW1zKSkKICApCmh0bWx3aWRnZXRzOjpzYXZlV2lkZ2V0KHdpZGdldCA9IHBsb3RhLCBmaWxlID0gIi4vcGxvdC5odG1sIikKc2V0d2QoIn4vT25lRHJpdmUgLSBDZW50cm8gZGUgSW52ZXN0aWdhY2lvbiB5IERvY2VuY2lhIEVjb25vbWljYXMgQ0lERS9UZXNpc01FMjAxOS9UZXNpbmFDSURFTUVSTU0iKQp3ZWJzaG90Ojp3ZWJzaG90KHVybCA9ICJ+L1VzZXJzL3JhZmFtdHovT25lRHJpdmUgLSBDZW50cm8gZGUgSW52ZXN0aWdhY2lvbiB5IERvY2VuY2lhIEVjb25vbWljYXMgQ0lERS9UZXNpc01FMjAxOS9UZXNpbmFDSURFTUVSTU0vcGxvdC5odG1sIiwgCiAgICAgICAgICAgICAgICAgIGRlbGF5ID0gMikKcGxvdGEKYGBgCgojIyBTZXhvIHBvciBlc3RhZG8gCgpgYGB7ciBlc3RhZG9fc2V4bywgZmlnLndpZHRoPTEwLCBldmFsID0gVFJVRX0KbXlNZW51SXRlbXMgPC0gYygiZG93bmxvYWRQTkciLCAiZG93bmxvYWRKUEVHIiwgImRvd25sb2FkUERGIiwgJ2Rvd25sb2FkU1ZHJywgJ3ByaW50Q2hhcnQnKQpncmFfc2V4X2VzdDwtZnVuY3Rpb24oZGYpewpkZiAlPiUKICBjb3VudChFc3RhZG8sIHAwNiklPiUgCiAgaGNoYXJ0KCdjb2x1bW4nLAogICAgICAgICBoY2FlcyggeSA9ICduJywgIGdyb3VwID0gYXNfbGFiZWwocDA2KSkpJT4lCiAgaGNfYWRkX3RoZW1lKGhjX3RoZW1lX2ZmeCgpKSU+JQogIGhjX3RpdGxlKAogICAgdGV4dCA9ICJOw7ptZXJvIGRlIGVudHJldmlzdGFkb3MgcG9yIGVzdGFkbyB5IHNleG8iCiAgKSAlPiUKICAjaGNfc3VidGl0bGUodGV4dCA9ICJMYXMgZWRhZGVzIGVzdMOhbiBhZ3J1cGFkYXMgZW4gaW50ZXJ2YWxvcyAKICAgIyAgICAgICAgICAgZGUgMTAgYcOxb3MgKGRhIGNsaWMgc29icmUgRiBvIE0pIikgJT4lCiAgIyBoY19jcmVkaXRzKAogICMgIGVuYWJsZWQgPSBUUlVFLCB0ZXh0ID0gIlNvdXJjZTogU1NTIiwKICAjICBzdHlsZSA9IGxpc3QoZm9udFNpemUgPSAiMTJweCIpKSU+JQogIGhjX3lBeGlzKHRpdGxlID0gbGlzdCh0ZXh0ID0gIk7Dum1lcm8gZGUgcGFydGljaXBhbnRlcyIpKSU+JQogIGhjX3hBeGlzKHRpdGxlPWxpc3QodGV4dD0iRXN0YWRvcyIpLAogICAgICAgICAgIGNhdGVnb3JpZXMgPSBnZXRfbGFiZWxzKGRmJEVzdGFkbykpICU+JQogICAgaGNfZXhwb3J0aW5nKGVuYWJsZWQgPSBUUlVFLAogICAgICAgICAgICAgICBmaWxlbmFtZSA9ICJkYXRvcyIsCiAgICAgICAgICAgICAgIGJ1dHRvbnMgPSBsaXN0KGNvbnRleHRCdXR0b24gPSBsaXN0KG1lbnVJdGVtcyA9IG15TWVudUl0ZW1zKSkpCn0KZ3JhX3NleF9lc3QoZGF0YV9lbW92aTIwMTcpCmBgYAoKIyMgRXNjb2xhcmlkYWQgc2V4bwoKYGBge3IgZXNjb2xhcmlkYWRfc2V4bywgZmlnLndpZHRoPTEwfQoKCmRhdGFfZW1vdmkyMDE3ICU+JQogIGNvdW50KHAxMyxwMDYpJT4lIAogIGhjaGFydCgnY29sdW1uJywKICAgICAgICAgaGNhZXMoIHkgPSAnbicsICBncm91cCA9IGFzX2xhYmVsKHAwNikpKSU+JQogIGhjX2FkZF90aGVtZShoY190aGVtZV9mZngoKSklPiUKICBoY190aXRsZSgKICAgIHRleHQgPSAiRXNjb2xhcmlkYWQgcG9yICBzZXhvIgogICkgJT4lCiAgI2hjX3N1YnRpdGxlKHRleHQgPSAiTGFzIGVkYWRlcyBlc3TDoW4gYWdydXBhZGFzIGVuIGludGVydmFsb3MgCiAgICMgICAgICAgICAgIGRlIDEwIGHDsW9zIChkYSBjbGljIHNvYnJlIEYgbyBNKSIpICU+JQogICMgaGNfY3JlZGl0cygKICAjICBlbmFibGVkID0gVFJVRSwgdGV4dCA9ICJTb3VyY2U6IFNTUyIsCiAgIyAgc3R5bGUgPSBsaXN0KGZvbnRTaXplID0gIjEycHgiKSklPiUKICBoY195QXhpcyh0aXRsZSA9IGxpc3QodGV4dCA9ICJOw7ptZXJvIGRlIHBhcnRpY2lwYW50ZXMiKSklPiUKICBoY194QXhpcyh0aXRsZT1saXN0KHRleHQ9IkVzY29sYXJpZGFkIiksCiAgICAgICAgICAgY2F0ZWdvcmllcyA9IGdldF9sYWJlbHMoZGF0YV9lbW92aTIwMTckcDEzKSkgJT4lCiAgICBoY19leHBvcnRpbmcoZW5hYmxlZCA9IFRSVUUsCiAgICAgICAgICAgICAgIGZpbGVuYW1lID0gImRhdG9zIiwKICAgICAgICAgICAgICAgYnV0dG9ucyA9IGxpc3QoY29udGV4dEJ1dHRvbiA9IGxpc3QobWVudUl0ZW1zID0gbXlNZW51SXRlbXMpKSkKYGBgCgojIyBOw7ptZXJvIGRlIHBlcnNvbmFzIHF1ZSBhcG9ydGFuIGFsIGluZ3Jlc28KCmBgYHtyIHBlcnNvbmFzX2Fwb3J0YW4sIGZpZy53aWR0aD0xMH0KZGF0YV9lbW92aTIwMTcgJT4lCiAgY291bnQocDEzMiklPiUgCiAgaGNoYXJ0KCdjb2x1bW4nLAogICAgICAgICBoY2FlcyggeSA9ICduJykpJT4lCiAgaGNfYWRkX3RoZW1lKGhjX3RoZW1lX2ZmeCgpKSU+JQogIGhjX3RpdGxlKAogICAgdGV4dCA9ICJOdW1lcm8gZGUgbWllbWJyb3MgcXVlIGFwb3J0YW4gaW5ncmVzbyIKICApICU+JQogICNoY19zdWJ0aXRsZSh0ZXh0ID0gIkxhcyBlZGFkZXMgZXN0w6FuIGFncnVwYWRhcyBlbiBpbnRlcnZhbG9zIAogICAjICAgICAgICAgICBkZSAxMCBhw7FvcyAoZGEgY2xpYyBzb2JyZSBGIG8gTSkiKSAlPiUKICAjIGhjX2NyZWRpdHMoCiAgIyAgZW5hYmxlZCA9IFRSVUUsIHRleHQgPSAiU291cmNlOiBTU1MiLAogICMgIHN0eWxlID0gbGlzdChmb250U2l6ZSA9ICIxMnB4IikpJT4lCiAgaGNfeUF4aXModGl0bGUgPSBsaXN0KHRleHQgPSAiTsO6bWVybyBkZSBwYXJ0aWNpcGFudGVzIikpJT4lCiAgaGNfeEF4aXModGl0bGU9bGlzdCh0ZXh0PSJOw7ptZXJvIGRlIHBlcnNvbmFzIiksCiAgICAgICAgICAgY2F0ZWdvcmllcyA9IGdldF9sYWJlbHMoZGF0YV9lbW92aTIwMTckcDEzMikpICU+JQogICAgaGNfZXhwb3J0aW5nKGVuYWJsZWQgPSBUUlVFLAogICAgICAgICAgICAgICBmaWxlbmFtZSA9ICJkYXRvcyIsCiAgICAgICAgICAgICAgIGJ1dHRvbnMgPSBsaXN0KGNvbnRleHRCdXR0b24gPSBsaXN0KG1lbnVJdGVtcyA9IG15TWVudUl0ZW1zKSkpCmBgYAoKIyBQZXJjZXBjacOzbiBkZSBtb3ZpbGlkYWQgCgpgYGB7ciwgZXZhbCA9IFRSVUV9CmRhdGFfZW1vdmkyMDE3JHAxNDc8LWFkZF9sYWJlbHMoCiAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YV9lbW92aTIwMTckcDE0NywKICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbHMgPSBjKCIxIiA9IDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiMiIgPSAyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjMiID0gMywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICI0IiA9IDQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiNSIgPSA1LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjYiID0gNiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICI3IiA9IDcsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiOCIgPSA4LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjkiID0gOSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIxMCIgPSAxMCkpCmBgYAoKCiMgUGVyY2VwY2nDs24gQWN0dWFsCgpgYGB7ciwgZXZhbCA9IFRSVUV9CmdyYV9wZXJfZWNvX2FjdDwtIGZ1bmN0aW9uKGRmKXsKICBkZiU+JQogIGNvdW50KHAxNDcpJT4lIAogIGhjaGFydCgnY29sdW1uJywKICAgICAgICAgaGNhZXMoIHkgPSAnbicpKSU+JQogIGhjX2FkZF90aGVtZShoY190aGVtZV9mZngoKSklPiUKICBoY190aXRsZSgKICAgIHRleHQgPSAiT3BpbmnDs24gc29icmUgc2l0dWFjacOzbiBlY29uw7NtaWNhIGFjdHVhbCIKICApICU+JQogICNoY19zdWJ0aXRsZSh0ZXh0ID0gIkxhcyBlZGFkZXMgZXN0w6FuIGFncnVwYWRhcyBlbiBpbnRlcnZhbG9zIAogICAjICAgICAgICAgICBkZSAxMCBhw7FvcyAoZGEgY2xpYyBzb2JyZSBGIG8gTSkiKSAlPiUKICAjIGhjX2NyZWRpdHMoCiAgIyAgZW5hYmxlZCA9IFRSVUUsIHRleHQgPSAiU291cmNlOiBTU1MiLAogICMgIHN0eWxlID0gbGlzdChmb250U2l6ZSA9ICIxMnB4IikpJT4lCiAgaGNfeUF4aXModGl0bGUgPSBsaXN0KHRleHQgPSAiTsO6bWVybyBkZSBwYXJ0aWNpcGFudGVzIikpJT4lCiAgaGNfeEF4aXModGl0bGU9bGlzdCh0ZXh0PSJQb3NpY2nDs24gZWNvbsOzbWljYSIpLAogICAgICAgICAgIGNhdGVnb3JpZXMgPSBnZXRfbGFiZWxzKGRmJHAxNDcpKSAlPiUKICAgIGhjX2V4cG9ydGluZyhlbmFibGVkID0gVFJVRSwKICAgICAgICAgICAgICAgZmlsZW5hbWUgPSAiZGF0b3MiLAogICAgICAgICAgICAgICBidXR0b25zID0gbGlzdChjb250ZXh0QnV0dG9uID0gbGlzdChtZW51SXRlbXMgPSBteU1lbnVJdGVtcykpKQp9CmdyYV9wZXJfZWNvX2FjdChkYXRhX2Vtb3ZpMjAxNykKCmBgYAoKYGBge3IsIGV2YWwgPSBUUlVFfQpkYXRhX2Vtb3ZpMjAxNyRwMTQ4PC1hZGRfbGFiZWxzKAogICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFfZW1vdmkyMDE3JHAxNDgsCiAgICAgICAgICAgICAgICAgICAgICAgICAgbGFiZWxzID0gYygiMSIgPSAxLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjIiID0gMiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICIzIiA9IDMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiNCIgPSA0LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjUiID0gNSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICI2IiA9IDYsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiNyIgPSA3LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjgiID0gOCwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICI5IiA9IDksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiMTAiID0gMTApKQpgYGAKCgojIFBlcmNlcGNpw7NuIHBhc2FkYQoKYGBge3IsIGV2YWw9VFJVRX0KZ3JhX3Blcl9lY29fYW50PC0gZnVuY3Rpb24oZGYpewogIGRmJT4lCiAgY291bnQocDE0OCklPiUgCiAgaGNoYXJ0KCdjb2x1bW4nLAogICAgICAgICBoY2FlcyggeSA9ICduJykpJT4lCiAgaGNfYWRkX3RoZW1lKGhjX3RoZW1lX2ZmeCgpKSU+JQogIGhjX3RpdGxlKAogICAgdGV4dCA9ICJPcGluacOzbiBzb2JyZSBzaXR1YWNpw7NuIGVjb27Ds21pY2EgZGUgbG9zIHBhZHJlcyIKICApICU+JQogICNoY19zdWJ0aXRsZSh0ZXh0ID0gIkxhcyBlZGFkZXMgZXN0w6FuIGFncnVwYWRhcyBlbiBpbnRlcnZhbG9zIAogICAjICAgICAgICAgICBkZSAxMCBhw7FvcyAoZGEgY2xpYyBzb2JyZSBGIG8gTSkiKSAlPiUKICAjIGhjX2NyZWRpdHMoCiAgIyAgZW5hYmxlZCA9IFRSVUUsIHRleHQgPSAiU291cmNlOiBTU1MiLAogICMgIHN0eWxlID0gbGlzdChmb250U2l6ZSA9ICIxMnB4IikpJT4lCiAgaGNfeUF4aXModGl0bGUgPSBsaXN0KHRleHQgPSAiTsO6bWVybyBkZSBwYXJ0aWNpcGFudGVzIikpJT4lCiAgaGNfeEF4aXModGl0bGU9bGlzdCh0ZXh0PSJQb3NpY2nDs24gZWNvbsOzbWljYSIpLAogICAgICAgICAgIGNhdGVnb3JpZXMgPSBnZXRfbGFiZWxzKGRmJHAxNDgpKSAlPiUKICAgIGhjX2V4cG9ydGluZyhlbmFibGVkID0gVFJVRSwKICAgICAgICAgICAgICAgZmlsZW5hbWUgPSAiZGF0b3MiLAogICAgICAgICAgICAgICBidXR0b25zID0gbGlzdChjb250ZXh0QnV0dG9uID0gbGlzdChtZW51SXRlbXMgPSBteU1lbnVJdGVtcykpKQp9CmdyYV9wZXJfZWNvX2FudChkYXRhX2Vtb3ZpMjAxNykKYGBgCgojIFBlcmNlcGNpw7NuIHJlbGF0aXZhCgpgYGB7ciwgZXZhbCA9IFRSVUV9CgoKc2tleTwtZGF0YV9lbW92aTIwMTclPiUKICBzZWxlY3QocDE0OCxwMTQ3KSU+JQogIGRhdGFfdG9fc2Fua2V5KCkKCiNza2V5Cgpmb3IgKGEgaW4gdW5pcXVlKHNrZXkkZnJvbSkpewpza2V5JGZyb21bc2tleSRmcm9tID09IGFdIDwtcGFzdGUoYSwncCcpCn0KCiNza2V5JHdlaWdodDwtYXMuZG91YmxlKHNrZXkkd2VpZ2h0KQoKI2ZvciAoYSBpbiB1bmlxdWUoc2tleSRmcm9tKSl7CiNza2V5W3NrZXkkZnJvbSA9PWEsICJ3ZWlnaHQiXSA8LSByb3VuZChza2V5W3NrZXkkZnJvbSA9PWEsICJ3ZWlnaHQiXSAvICNzdW0oc2tleVtza2V5JGZyb209PWEsM10pLDIpCiN9Cgojc2tleQoKc2tleSU+JQpoY2hhcnQoJ3NhbmtleScsbm9kZVdpZHRoPTUwLAogICAgICAgb3BhY2l0eT0xLCBsaW5rT3BhY2l0eT0wLjA1LCBtaW5MaW5rV2lkdGg9MiwKICAgICAgIG5hbWUgPSAiTW92aWxpZGFkIixub2RlUGFkZGluZyA9IDE1LGNsaXA9RkFMU0UsCiAgICAgICBkZXNjcmlwdGlvbiA9ICJob2xhIiklPiUKICBoY19hZGRfdGhlbWUoaGNfdGhlbWVfZmZ4KCkpJT4lCiAgaGNfdGl0bGUoCiAgICB0ZXh0ID0gIlBlcmNlcGNpw7NuIGRlIG1vdmlsaWRhZCByZWxhdGl2YSIKICApJT4lCiAgICBoY19leHBvcnRpbmcoZW5hYmxlZCA9IFRSVUUsCiAgICAgICAgICAgICAgIGZpbGVuYW1lID0gImRhdG9zIiwKICAgICAgICAgICAgICAgYnV0dG9ucyA9IGxpc3QoY29udGV4dEJ1dHRvbiA9IGxpc3QobWVudUl0ZW1zID0gbXlNZW51SXRlbXMpKSkKCmBgYApgYGB7cn0KCnNrZXk8LWRhdGFfZW1vdmkyMDE3JT4lCiAgZmlsdGVyKHAwNj09MSklPiUKICBzZWxlY3QocDE0OCxwMTQ3KSU+JQogIGRhdGFfdG9fc2Fua2V5KCkKCgpmb3IgKGEgaW4gdW5pcXVlKHNrZXkkZnJvbSkpewpza2V5JGZyb21bc2tleSRmcm9tID09IGFdIDwtcGFzdGUoYSwncCcpCn0KCgpza2V5JT4lCmhjaGFydCgnc2Fua2V5Jyxub2RlV2lkdGg9NTAsCiAgICAgICBvcGFjaXR5PTEsIGxpbmtPcGFjaXR5PTAuMDUsIG1pbkxpbmtXaWR0aD0yLAogICAgICAgbmFtZSA9ICJNb3ZpbGlkYWQiLG5vZGVQYWRkaW5nID0gMTUsY2xpcD1GQUxTRSwKICAgICAgIGRlc2NyaXB0aW9uID0gImhvbGEiKSU+JQogIGhjX2FkZF90aGVtZShoY190aGVtZV9mZngoKSklPiUKICBoY190aXRsZSgKICAgIHRleHQgPSAiUGVyY2VwY2nDs24gZGUgbW92aWxpZGFkIHJlbGF0aXZhIgogICklPiUKICBoY19zdWJ0aXRsZSh0ZXh0ID0gIkhvbWJyZXMiKSAlPiUKICAgIGhjX2V4cG9ydGluZyhlbmFibGVkID0gVFJVRSwKICAgICAgICAgICAgICAgZmlsZW5hbWUgPSAiZGF0b3MiLAogICAgICAgICAgICAgICBidXR0b25zID0gbGlzdChjb250ZXh0QnV0dG9uID0gbGlzdChtZW51SXRlbXMgPSBteU1lbnVJdGVtcykpKQoKYGBgCgpgYGB7cn0KCnNrZXk8LWRhdGFfZW1vdmkyMDE3JT4lCiAgZmlsdGVyKHAwNj09MiklPiUKICBzZWxlY3QocDE0OCxwMTQ3KSU+JQogIGRhdGFfdG9fc2Fua2V5KCkKCgpmb3IgKGEgaW4gdW5pcXVlKHNrZXkkZnJvbSkpewpza2V5JGZyb21bc2tleSRmcm9tID09IGFdIDwtcGFzdGUoYSwncCcpCn0KCgpza2V5JT4lCmhjaGFydCgnc2Fua2V5Jyxub2RlV2lkdGg9NTAsCiAgICAgICBvcGFjaXR5PTEsIGxpbmtPcGFjaXR5PTAuMDUsIG1pbkxpbmtXaWR0aD0yLAogICAgICAgbmFtZSA9ICJNb3ZpbGlkYWQiLG5vZGVQYWRkaW5nID0gMTUsY2xpcD1GQUxTRSwKICAgICAgIGRlc2NyaXB0aW9uID0gImhvbGEiKSU+JQogIGhjX2FkZF90aGVtZShoY190aGVtZV9mZngoKSklPiUKICBoY190aXRsZSgKICAgIHRleHQgPSAiUGVyY2VwY2nDs24gZGUgbW92aWxpZGFkIHJlbGF0aXZhIgogICklPiUKICBoY19zdWJ0aXRsZSh0ZXh0ID0gIk11amVyZXMiKSAlPiUKICAgIGhjX2V4cG9ydGluZyhlbmFibGVkID0gVFJVRSwKICAgICAgICAgICAgICAgZmlsZW5hbWUgPSAiZGF0b3MiLAogICAgICAgICAgICAgICBidXR0b25zID0gbGlzdChjb250ZXh0QnV0dG9uID0gbGlzdChtZW51SXRlbXMgPSBteU1lbnVJdGVtcykpKQoKYGBgCgpgYGB7ciwgZXZhbD1UUlVFfQoKZGF0YV9lbW92aTIwMTc8LWRhdGFfZW1vdmkyMDE3JT4lCiAgbXV0YXRlKG1vdiA9IGlmZWxzZShwMTQ3PnAxNDgsIm1lam9yIiwKICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShwMTQ3PHAxNDgsInBlb3IiLCJpZ3VhbCIpKSwKICAgICAgICAgaWRfaG8gPSBhcy5pbnRlZ2VyKHJvdy5uYW1lcyhkYXRhX2Vtb3ZpMjAxNykpKQpkYXRhX2Vtb3ZpMjAxNyRtb3Y8LXNldF9sYWJlbHMoCiAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YV9lbW92aTIwMTckbW92LAogICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVscyA9IGMoIm1lam9yIiA9ICJtZWpvciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAicGVvciIgPSAicGVvciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaWd1YWwiID0gImlndWFsIikpCmBgYAoKIyBQZXJjZXBjacOzbiBjdWFsaXRhdGl2YSB0b3RhbCAKCmBgYHtyLCBldmFsPVRSVUUsIGV2YWwgPSBUUlVFfQpkYXRhX2Vtb3ZpMjAxNyAlPiUKICBjb3VudChtb3YpJT4lIAogIG11dGF0ZShmcmVxID0gcm91bmQoMTAwICogbi9zdW0obiksIDApKSU+JQogIGhjaGFydCgnY29sdW1uJywKICAgICAgICAgaGNhZXMoIHkgPSAnZnJlcScpKSU+JQogIGhjX2FkZF90aGVtZShoY190aGVtZV9mZngoKSklPiUKICBoY190aXRsZSgKICAgIHRleHQgPSAiUGVyY2VwY2nDs24gZGUgbW92aWxpZGFkIgogICkgJT4lCiAgaGNfc3VidGl0bGUodGV4dCA9ICIiKSAlPiUKICAjIGhjX2NyZWRpdHMoCiAgIyAgZW5hYmxlZCA9IFRSVUUsIHRleHQgPSAiU291cmNlOiBTU1MiLAogICMgIHN0eWxlID0gbGlzdChmb250U2l6ZSA9ICIxMnB4IikpJT4lCiAgaGNfeUF4aXModGl0bGUgPSBsaXN0KHRleHQgPSAiUG9yY2VudGFqZSIpKSU+JQogIGhjX3hBeGlzKHRpdGxlPWxpc3QodGV4dD0iVGlwbyBkZSBwZXJjZXBjacOzbiIpLAogICAgICAgICAgIGNhdGVnb3JpZXMgPSBnZXRfbGFiZWxzKGRhdGFfZW1vdmkyMDE3JG1vdikpICU+JQogICAgaGNfZXhwb3J0aW5nKGVuYWJsZWQgPSBUUlVFLAogICAgICAgICAgICAgICBmaWxlbmFtZSA9ICJkYXRvcyIsCiAgICAgICAgICAgICAgIGJ1dHRvbnMgPSBsaXN0KGNvbnRleHRCdXR0b24gPSBsaXN0KG1lbnVJdGVtcyA9IG15TWVudUl0ZW1zKSkpCmBgYAoKCgpgYGB7cn0KZGF0YV9lbW92aTIwMTcgJT4lCiAgY291bnQocDA1LG1vdiklPiUgCiAgZ3JvdXBfYnkocDA1KSAlPiUKICBtdXRhdGUoZnJlcSA9IHJvdW5kKDEwMCAqIG4vc3VtKG4pLCAwKSklPiUKICBoY2hhcnQoJ2NvbHVtbicsCiAgICAgICAgIGhjYWVzKCB5ID0gJ2ZyZXEnLCAgZ3JvdXAgPSBhc19sYWJlbChtb3YpKSklPiUKICBoY19hZGRfdGhlbWUoaGNfdGhlbWVfZmZ4KCkpJT4lCiAgaGNfdGl0bGUoCiAgICB0ZXh0ID0gIlBlcmNlcGNpw7NuIGRlIG1vdmlsaWRhZCBkZSBhY3VlcmRvIGEgbGEgZWRhZCIKICApICU+JQogIGhjX3N1YnRpdGxlKHRleHQgPSAiUGFyYSBlbCBjb2xvciBkZSBwaWVsIHNlIHJldmlzYSBsYSBlc2NhbGEiKSAlPiUKICAjIGhjX2NyZWRpdHMoCiAgIyAgZW5hYmxlZCA9IFRSVUUsIHRleHQgPSAiU291cmNlOiBTU1MiLAogICMgIHN0eWxlID0gbGlzdChmb250U2l6ZSA9ICIxMnB4IikpJT4lCiAgaGNfeUF4aXModGl0bGUgPSBsaXN0KHRleHQgPSAiUG9yY2VudGFqZSIpKSU+JQogIGhjX3hBeGlzKHRpdGxlPWxpc3QodGV4dD0iRWRhZCIpLAogICAgICAgICAgIGNhdGVnb3JpZXMgPSBhcy5jaGFyYWN0ZXIoMjU6NjQpKSAlPiUKICAgIGhjX2V4cG9ydGluZyhlbmFibGVkID0gVFJVRSwKICAgICAgICAgICAgICAgZmlsZW5hbWUgPSAiZGF0b3MiLAogICAgICAgICAgICAgICBidXR0b25zID0gbGlzdChjb250ZXh0QnV0dG9uID0gbGlzdChtZW51SXRlbXMgPSBteU1lbnVJdGVtcykpKQpgYGAKCmBgYHtyfQojIFBlcl9TaXRFY28KCmRhdGFfZW1vdmkyMDE3ICU+JQogIGNvdW50KHAxNTEsbW92KSU+JSAKICBncm91cF9ieShwMTUxKSAlPiUKICBtdXRhdGUoZnJlcSA9IHJvdW5kKDEwMCAqIG4vc3VtKG4pLCAwKSklPiUKICBoY2hhcnQoJ2NvbHVtbicsCiAgICAgICAgIGhjYWVzKCB5ID0gJ2ZyZXEnLCAgZ3JvdXAgPSBhc19sYWJlbChtb3YpKSklPiUKICBoY19hZGRfdGhlbWUoaGNfdGhlbWVfZmZ4KCkpJT4lCiAgaGNfdGl0bGUoCiAgICB0ZXh0ID0gIlBlcmNlcGNpw7NuIGRlIG1vdmlsaWRhZCBkZSBhY3VlcmRvIGFsIGNvbG9yIGRlIHBpZWwiCiAgKSAlPiUKICBoY19zdWJ0aXRsZSh0ZXh0ID0gIlBhcmEgZWwgY29sb3IgZGUgcGllbCBzZSByZXZpc2EgbGEgZXNjYWxhIikgJT4lCiAgIyBoY19jcmVkaXRzKAogICMgIGVuYWJsZWQgPSBUUlVFLCB0ZXh0ID0gIlNvdXJjZTogU1NTIiwKICAjICBzdHlsZSA9IGxpc3QoZm9udFNpemUgPSAiMTJweCIpKSU+JQogIGhjX3lBeGlzKHRpdGxlID0gbGlzdCh0ZXh0ID0gIlBvcmNlbnRhamUiKSklPiUKICBoY194QXhpcyh0aXRsZT1saXN0KHRleHQ9IkNvbG9yIGRlIHBpZWwiKSwKICAgICAgICAgICBjYXRlZ29yaWVzID0gZ2V0X2xhYmVscyhkYXRhX2Vtb3ZpMjAxNyRwMTUxKSkgJT4lCiAgICBoY19leHBvcnRpbmcoZW5hYmxlZCA9IFRSVUUsCiAgICAgICAgICAgICAgIGZpbGVuYW1lID0gImRhdG9zIiwKICAgICAgICAgICAgICAgYnV0dG9ucyA9IGxpc3QoY29udGV4dEJ1dHRvbiA9IGxpc3QobWVudUl0ZW1zID0gbXlNZW51SXRlbXMpKSkKCmBgYAoKCiMgUGVyY2VwY2nDs24gcmVnaW9uYWwKCmBgYHtyLCBldmFsID0gVFJVRX0KZGF0YV9lbW92aTIwMTcgJT4lCiAgY291bnQocmVnaW9uLG1vdiklPiUgCiAgZ3JvdXBfYnkocmVnaW9uKSAlPiUKICBtdXRhdGUoZnJlcSA9IHJvdW5kKDEwMCAqIG4vc3VtKG4pLCAwKSklPiUKICBoY2hhcnQoJ2NvbHVtbicsCiAgICAgICAgIGhjYWVzKCB5ID0gJ2ZyZXEnLCAgZ3JvdXAgPSBhc19sYWJlbChtb3YpKSklPiUKICBoY19hZGRfdGhlbWUoaGNfdGhlbWVfZmZ4KCkpJT4lCiAgaGNfdGl0bGUoCiAgICB0ZXh0ID0gIlBlcmNlcGNpw7NuIGRlIG1vdmlsaWRhZCBkZSBhY3VlcmRvIHJlZ2lvbiIKICApICU+JQogIGhjX3N1YnRpdGxlKHRleHQgPSAiIikgJT4lCiAgIyBoY19jcmVkaXRzKAogICMgIGVuYWJsZWQgPSBUUlVFLCB0ZXh0ID0gIlNvdXJjZTogU1NTIiwKICAjICBzdHlsZSA9IGxpc3QoZm9udFNpemUgPSAiMTJweCIpKSU+JQogIGhjX3lBeGlzKHRpdGxlID0gbGlzdCh0ZXh0ID0gIlBvcmNlbnRhamUiKSklPiUKICBoY194QXhpcyh0aXRsZT1saXN0KHRleHQ9IlJlZ2lvbiIpLAogICAgICAgICAgIGNhdGVnb3JpZXMgPSBnZXRfbGFiZWxzKGRhdGFfZW1vdmkyMDE3JHJlZ2lvbikpICU+JQogICAgaGNfZXhwb3J0aW5nKGVuYWJsZWQgPSBUUlVFLAogICAgICAgICAgICAgICBmaWxlbmFtZSA9ICJkYXRvcyIsCiAgICAgICAgICAgICAgIGJ1dHRvbnMgPSBsaXN0KGNvbnRleHRCdXR0b24gPSBsaXN0KG1lbnVJdGVtcyA9IG15TWVudUl0ZW1zKSkpCmBgYAoKIyBQZXJjZXBjacOzbiBwb3IgY29ob3J0IGRlIGluZ3Jlc28KYGBge3IsIGV2YWwgPSBUUlVFfQpkYXRhX2Vtb3ZpMjAxNyAlPiUKICBjb3VudChwMTMzLG1vdiklPiUgCiAgZ3JvdXBfYnkocDEzMykgJT4lCiAgbXV0YXRlKGZyZXEgPSByb3VuZCgxMDAgKiBuL3N1bShuKSwgMCkpJT4lCiAgaGNoYXJ0KCdjb2x1bW4nLAogICAgICAgICBoY2FlcyggeSA9ICdmcmVxJywgIGdyb3VwID0gYXNfbGFiZWwobW92KSkpJT4lCiAgaGNfYWRkX3RoZW1lKGhjX3RoZW1lX2ZmeCgpKSU+JQogIGhjX3RpdGxlKAogICAgdGV4dCA9ICJQZXJjZXBjacOzbiBkZSBtb3ZpbGlkYWQgZGUgYWN1ZXJkbyBhIGNvaG9ydCBkZSBpbmdyZXNvIgogICkgJT4lCiAgaGNfc3VidGl0bGUodGV4dCA9ICIiKSAlPiUKICAjIGhjX2NyZWRpdHMoCiAgIyAgZW5hYmxlZCA9IFRSVUUsIHRleHQgPSAiU291cmNlOiBTU1MiLAogICMgIHN0eWxlID0gbGlzdChmb250U2l6ZSA9ICIxMnB4IikpJT4lCiAgaGNfeUF4aXModGl0bGUgPSBsaXN0KHRleHQgPSAiUG9yY2VudGFqZSIpKSU+JQogIGhjX3hBeGlzKHRpdGxlPWxpc3QodGV4dD0iUmVnaW9uIiksCiAgICAgICAgICAgY2F0ZWdvcmllcyA9IGdldF9sYWJlbHMoZGF0YV9lbW92aTIwMTckcDEzMykpICU+JQogICAgaGNfZXhwb3J0aW5nKGVuYWJsZWQgPSBUUlVFLAogICAgICAgICAgICAgICBmaWxlbmFtZSA9ICJkYXRvcyIsCiAgICAgICAgICAgICAgIGJ1dHRvbnMgPSBsaXN0KGNvbnRleHRCdXR0b24gPSBsaXN0KG1lbnVJdGVtcyA9IG15TWVudUl0ZW1zKSkpCmBgYAoKCgojIEZpbHRyYW1vcyBhIGxvcyBoam9zCgojIyBTZWxlY2Npw7NuIGRlIGhpam9zCgoKCkNyaXRlcmlvcyBkZSBmaWx0cmFkbwotIHByZWd1bnRhIHAyLCBjb21wYXJ0ZW4gZWwgbWltc28gZ2FzdG8gcGFyYSBjb21lcjogMSApIFNpIDIgKSBObwotIHByZWd1bnRhIDUgRWRhZGVzIGVudHJlIDI1IHkgNDUgYcOxb3MKLSBwcmVndW50YSBwMDgsIGVzIGVsIGplZmUgZGVsIGhvZ2FyOiAxICkgamVmZSAyKSBjw7NueXVnZSBOTyBJTVBMRU1FTlRBRE8KLSBwcmVndW50YSBwMTIsIGFjdHVhbG1lbnRlIGVzdHVkaWEsIDEpU2kgMilObwotIHAyNiBIYWLDrWEgdW4gamVmZSBkZSBob2dhciBlbiBsYSBpbmZhbmNpYSAoMSBwYWRyZSAyIG1hZHJlKQotIHA0MyB5IHA0M20gUmVwb3J0YSBlZHVjYWNpw7NuIGRlbCBwYWRyZSBvIG1hZHJlIHByaWNpYXBsCi0gcDY4LCBQZXJzb25hcyBxdWUgdHJhYmFqYW4sIDEuIFNpLCAyLiBObwotIHA2OSBzaSB0cmFiYWphIHBlcm8gbGEgc2VtYW5hIHBhc2FkYSBubyAKLSBwMTMyIG51bWVybyBkZSBwZXJzb25hcyBxdWUgYXBvcnRhbiBpbmdyZXNvCi0gcDEzMyBjb2hvcnQgZGUgdG9kYXMgbGFzIHBlcnNvbmFzIHkgdG9kb3MgbG9zIGluZ3Jlc29zICgxIGluZ3Jlc28pCgoKClZhcmlhYmxlcyBkZSBzZWxlY2Npw7NuIHBhcmEgZXN0aW1hciBpbmdyZXNvCgotIEVzdGFkbwoKLSBwcmVndW50YSA1LCBlZGFkCgotIHByZWd1bnRhIDYsIHNleG8KCi0gUHJlZ3VudGEgMTMsIG5pdmVsIGRlIGVzY3VlbGEKCi0gcDc2IG9jdXBhY2nDs24KLS1TSU5DTzMgY29kaWZpY2FjacOzbiBvY3VwYWNpw7NuIGVudHJldmlzdGFkbwoKLSBwMTMzIGNvaG9ydCBkZSB0b2RhcyBsYXMgcGVyc29uYXMgeSB0b2RvcyBsb3MgaW5ncmVzb3MKCgoKCgpgYGB7ciBoaWpvc3NlbGVjY2lvbn0KIyBwZW5zYW1vcyBxdWUgbG9zIGRhdG9zIHNlIGxlZWVuIGNvbW8gZmFjdG9yZXMgY2FuZG8gY29ycmVzcG9uZGEsIHNpIHNlIGxlZW4gY29tbyBlbnRlcm9zIG5vIGRlYmUgaGFjZXJzZSBlbCBjYXN0aW5nCiNkYXRhX2Vtb3ZpMjAxNzwtZGF0b3NfZQpoaWpvcyA8LSBkYXRhX2Vtb3ZpMjAxNyAlPiUKICBmaWx0ZXIocDAyID09IDEpICAlPiUgI2NvbXBhcnRpciBnYXNvdCBwYXJhIGNvbWVyCiAgZmlsdGVyKGJldHdlZW4ocDA1LDI1LDQwKSkgJT4lICMgZWRhZAogICNmaWx0ZXIocDA4ID09IDEpICAlPiUgCiAgZmlsdGVyKHAxMiA9PSAyKSAgJT4lICMgeWEgbm8gZXN0dWRpYQogIGZpbHRlcihwMjYgPT0gMSB8IHAyNj09MiApICU+JSAjIHNvc3RlbiBwcmluY2lwYWwgcGFwYSwgbWFtYSwgCiAgIGZpbHRlcigoIWlzLm5hKHA0MykgJiBwNDMhPTk4ICYgcDI2ID09IDEgKSB8CiAgICAgICAgICAgICghaXMubmEocDQzbSkgJiBwNDNtIT05OCAgJiBwMjYgPT0gMiApKSAlPiUgIyByZXBvcnRhIGVkdWNhY2nDs24gZGUgcHAKICAgZmlsdGVyKCFpcy5uYShwMTMpKSU+JSAjICByZXBvcnRhIGVkdWNhY2nDs24KICBmaWx0ZXIoU0lOQ08zICE9IiIpICU+JSMgcmVwb3J0YSBvZmljaW8gYWN0dWFsCiAgIGZpbHRlcihwNjggPT0gMSB8IHA2OSA9PSAxKSAgJT4lICMgc2kgdHJhYmFqYQogICBmaWx0ZXIocDEzMiAlaW4lIGMoMSkpICU+JSMgcGVyc29uYSBxdWUgYXBvcnRhbiBpbmdyZXNvCiAgZmlsdGVyKCFwMTMzICVpbiUgYyg4LDksTkEpICkgIyByZXBvcnRhIGluZ3Jlc29zCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBubyBlc3RhbiBsb3MgaW5ncmVzb3MgIGhvZ2FyIGFpc2xhZG9zLiAKCiNlZGFkX3Byb21lZGlvX3BhZHJlcyA8LSBtZWFuKGhpam9zJHAzOF8xMSwgbmEucm0gPSBUUlVFKQojZWRhZF9wcm9tZWRpb19wYWRyZXMtMjEKdW5pcXVlKGhpam9zJHA0MykKYGBgCgpgYGB7cn0KZ3JhX3NleF9lc3QoaGlqb3MpCmBgYAoKCmBgYHtyIHBhcmFfcHJlX3NhbH0KCgp2YXI8LWMoIkVzdGFkbyIsInAwNSIsInAwNiIsInAxMyIsIlNJTkNPMyIsInAxMzMiLCJtb3YiLCJpZF9obyIsInJlZ2lvbiIpCmhpam9zX3BhcmFfc2FsPC1oaWpvcyU+JQogIHNlbGVjdCh2YXIpJT4lCiAgbXV0YXRlKHAxMzMgPSBpZmVsc2UocDEzMz09MSwyLHAxMzMpLTEpIyBqdW50YW1vcyBlbCBjb2hvcnQgMSB5IDIgCgpoaWpvc19wYXJhX3NhbCA8LSBoaWpvc19wYXJhX3NhbCU+JQogICAgICAgICAgICBtdXRhdGUoZXN0cmF0byA9IGlmZWxzZShwMTMzICVpbiUgYygxLDIpLDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShwMTMzICVpbiUgYygzKSwyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKHAxMzMgJWluJSBjKDQsNSksMyw0KSkpKQoKc2F2ZVJEUyhoaWpvc19wYXJhX3NhbCwgZmlsZT0iRGF0b3MvaGlqb3NfZW1vdmkyMDE3LlJkYSIpCgpgYGAKCgojIElkZW50aWZpY2FjacOzbiBkZSBwYWRyZXMKCgpgYGB7cn0KaGlqb3NfZW1vdmlfaHAgPC0gcmVhZFJEUyhmaWxlPSJEYXRvcy9pbmdyZXNvX2hpal9mX2Vtb3ZpLlJkYSIpCgojIHAwNSBlZGFkIGFjdAojIHAwNiBzZXhvIGFjdAojIHAxMyBlZHVjIGhpam8KIyBTSU5DTzMsIG9jdXBhY2nDs24gaGlqbwojIHAyMyBlbiBxZXUgZXN0YWRvIHZpdmlhIGEgbG9zIDE0CiMgcDI2IHByaW5jaXBhbCBzb3N0ZW4gZWPDs21pY28KIyBwMzhfMTEgZWRhZCBwYWRyZSAyMDE2CiMgcDM4bV8xMSBlZGFkIG1hZHJlIDIwMTYKIyBwNDMgbml2ZWwgZWR1Y2F0aXZvIHBhZHJlCiNwNDNtIG5pdmVsIGVkdWNhdGl2byBtYWRyZQojIGNtbzFfMiBvY3VwYWNpb24gZGVsIHBhZHJlCiMgY21vMl8yIG9jdXBhY2lvbiBkZSBsYSBtYWRyZSAKCgp2YXJwPC1jKCJFc3RhZG8iLCJwMDUiLCJwMDYiLCJwMTMiLCJTSU5DTzMiLCJwMjMiLCJwMjYiLCJwMzhfMTEiLCJwMzhtXzExIiwKICAgICAgICAicDQzIiwicDQzbSIsImNtbzFfMiIsImNtbzJfMiIsIm1vdiIsImlkX2hvIiwicmVnaW9uIikKcGFkcmVzX2g8LWRhdGFfZW1vdmkyMDE3JT4lCiAgICBmaWx0ZXIocDAyID09IDEpICAlPiUgI2NvbXBhcnRpciBnYXNvdCBwYXJhIGNvbWVyCiAgZmlsdGVyKGJldHdlZW4ocDA1LDI1LDQwKSkgJT4lICMgZWRhZAogICNmaWx0ZXIocDA4ID09IDEpICAlPiUgCiAgZmlsdGVyKHAxMiA9PSAyKSAgJT4lIyB5YSBubyBlc3R1ZGlhCiAgZmlsdGVyKHAyNiA9PSAxIHwgcDI2PT0yICkgJT4lICMgc29zdGVuIHByaW5jaXBhbCBwYXBhLCBtYW1hLCAKICAgZmlsdGVyKCghaXMubmEocDQzKSAmIHA0MyE9OTggJiBwMjYgPT0gMSApfAogICAgICAgICAgICAoIWlzLm5hKHA0M20pICYgcDQzbSE9OTggICYgcDI2ID09IDIgKSkgJT4lICMgcmVwb3J0YSBlZHVjYWNpw7NuIGRlIHBwCiAgIGZpbHRlcighaXMubmEocDEzKSklPiUgIyAgcmVwb3J0YSBlZHVjYWNpw7NuCiAgZmlsdGVyKFNJTkNPMyAhPSIiKSAlPiUjIHJlcG9ydGEgb2ZpY2lvIGFjdHVhbAogICBmaWx0ZXIocDY4ID09IDEgfCBwNjkgPT0gMSkgICU+JSAjIHNpIHRyYWJhamEKICAgZmlsdGVyKHAxMzIgJWluJSBjKDEpKSAlPiUjIHBlcnNvbmEgcXVlIGFwb3J0YW4gaW5ncmVzbwogIGZpbHRlcighcDEzMyAlaW4lIGMoOCw5LE5BKSApJT4lCiAgc2VsZWN0KHZhcnApJT4lCiAgc2xpY2UoYXMuaW50ZWdlcih1bmxpc3QoaGlqb3NfZW1vdmlfaHAlPiVzZWxlY3QoaWRfaGlqbykpKSklPiUKICBtdXRhdGUoCiAgICAgICAgIHBwX2lkX2hpam8gPSBoaWpvc19lbW92aV9ocCU+JXB1bGwoaWRfaGlqbyksCiAgICAgICAgIHBwX2lkX2hpam9vPSBoaWpvc19lbW92aV9ocCU+JXB1bGwoaWRfaG8pLAogICAgICAgICBpbmdfaCA9IGhpam9zX2Vtb3ZpX2hwJT4lcHVsbChpbmdfbWVuX3BfaCksCiAgICAgICAgIGxpbmdfaCA9IGxvZyAoaGlqb3NfZW1vdmlfaHAlPiVwdWxsKGluZ19tZW5fcF9oKSkgCiAgICAgICAgICkgJT4lCiAgcmVuYW1lKAogICAgICAgICAgZWRhZF9oID0gcDA1LAogICAgICAgICAgc2V4b19oID0gcDA2LAogICAgICAgICAgZWR1X2ggPSBwMTMsCiAgICAgICAgICBvY3VfaCA9IFNJTkNPMywKICAgICAgICAgIHBwX2VzdGFkbyA9IHAyMywKICAgICAgICAgIHBwID0gcDI2LAogICAgICAgICAgcF9lZGFkXzIwMTY9IHAzOF8xMSwKICAgICAgICAgIG1fZWRhZF8yMDE2ID0gcDM4bV8xMSwKICAgICAgICAgIHBfZWR1ID0gcDQzLAogICAgICAgICAgbV9lZHUgPSBwNDNtLAogICAgICAgICAgcF9vY3UgPSBjbW8xXzIsCiAgICAgICAgICBtX29jdSA9IGNtbzJfMgogICAgICAgICApJT4lCiAgbXV0YXRlKAogICAgICAgIHBfZWR1ID0gYXMuaW50ZWdlcihwX2VkdSksCiAgICAgICAgbV9lZHUgPSBhcy5pbnRlZ2VyKG1fZWR1KQogICkKICAKIAojIGxhcyBvY3VwYWNpb25lcyBubyBlbmNvbnRyYWRhcyBsYXMgc3VzdGl0dWltb3MgcG9yIHVuIE5BCnBhZHJlc19oPC1wYWRyZXNfaCU+JQogIG11dGF0ZShwX29jdSA9IGlmZWxzZShwX29jdT09Ii4iLE5BLHBfb2N1KSwKICAgICAgICAgbV9vY3UgPSBpZmVsc2UobV9vY3U9PSIuIixOQSxtX29jdSkpCgp1bmlxdWUocGFkcmVzX2gkcF9vY3UpCnVuaXF1ZShwYWRyZXNfaCRtX29jdSkKcGFkcmVzX2gKCmBgYAoKIyBFc3QgUGVyIGRlIDI1IGHDsW9zLiAKCkVzdGFzIHBlcnNvbmFzIHNlIHRpZW5lIHFldSBidXNjYXIgZW4gMjAxNi0xMT0yMDA1LCBlcyBkZWNpciwgbGEgaW5mb3JhY2nDs24gcXVlIHBvcnBvcmNpb25hbiBlcyBsYSBjb3JyZXNwb25kaWVudGUgYSBsYSBzaXR1YWNpw7NuIGVuIGVsIDIwMDUsIAoKYGBge3J9CmZpbHRyb19lZGFkIDwtIGZ1bmN0aW9uKGRmLGVkYWQpeyAKICAjcmVjaWJlIGVsIGRmIHkgcmVncmVzYSBkZiBjb24gZWRhZAogICAgICAgIGRmICU+JQogICAgICAgICBmaWx0ZXIoZWRhZF9oPT1lZGFkKQogIH0KCgoKIyBoYWNlbW9zIGxhIGNvZGlmaWNhY2nDs24gZGUgRVNSVSBhIEVOSUdIMjAwNQpwYWRyZXNfaDI1PC1wYWRyZXNfaCU+JQogICBtdXRhdGUoCiAgICBwX2VkdSA9IGlmZWxzZShwX2VkdSVpbiUgYygxKSwxLAogICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKCBwX2VkdSA9PSAyLDIsCiAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UocF9lZHUgJWluJSBjKDMsNCksMywKICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZSggcF9lZHUgJWluJSBjKDUsNiksNCwKICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShwX2VkdSAlaW4lIGMoNyw4KSw2LAogICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKHBfZWR1ICVpbiUgYyg5LDEwKSw1LAogICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKHBfZWR1PT0xMSw3LDgpKSkpKSkpLAogICAgbV9lZHUgPSBpZmVsc2UobV9lZHUlaW4lIGMoMSksMSwKICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShtX2VkdSA9PSAyLDIsCiAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UobV9lZHUgJWluJSBjKDMsNCksMywKICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShtX2VkdSAlaW4lIGMoNSw2KSw0LAogICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKG1fZWR1ICVpbiUgYyg3LDgpLDYsCiAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UobV9lZHUgJWluJSBjKDksMTApLDUsCiAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UobV9lZHU9PTExLDcsOCkpKSkpKSkKICApCgoKCiNsaXN0YSBkZSAxNigyNSBhIDQwKSBlbGVtZW50b3MgY2FkYSBlbGVtZW50byBjb250aWVuZSBsb3MgaGlqb3MgcG9yIGVkYWQKCnBlcmVkYWRlcyA8LSBsYXBwbHkoMjU6NDAsIGZpbHRyb19lZGFkLCBkZiA9IHBhZHJlc19oMjUpCnBlcmVkYWRlc1tbMV1dCgpmaWx0cm9fcHA8LWZ1bmN0aW9uKGRmXzEsZWRhZGgsIGdlbmVyYWw9MCkKewogICNyZWNpYmUgdW4gaGlqbyBkZSB1biBkYXRhZnJhbWUsIGxhIGVkYWQgZGVsIGhpam8sIHBhcmEgcG9saW1vcmZpc21vCiAgIyBnZW5lcmFsID0gMHkgcmVncmVzYSB1biBkYXRhIGZyYW1lIGNvbiBsb3MgZGF0b3MKICAjIG9yZGVuYWRvcyBkZWwgaGlqbwogIGlmKGRmXzFbInBwIl09PTEpCiAgewogICAgZGZuIDwtIGRmXzElPiUKICAgICAgICAgIGZpbHRlcihwcD09MSklPiUKICAgICAgICAgIHNlbGVjdChzdGFydHNfd2l0aChjKCJwcCIsInBfIikpLGxpbmdfaCxlZHVfaCxvY3VfaCxlZGFkX2gpJT4lCiAgICAgICAgICByZW5hbWUoCiAgICAgICAgICAgIGlkX2hpam8gPSBwcF9pZF9oaWpvLAogICAgICAgICAgICBwcF9zZXhvID0gcHAsCiAgICAgICAgICAgIHBwX2VkYWQgPSBwX2VkYWRfMjAxNiwKICAgICAgICAgICAgcHBfZWR1YyA9IHBfZWR1LAogICAgICAgICAgICBwcF9vY3VwID0gcF9vY3UKICAgICAgICAgICklPiUKICAgICAgICBtdXRhdGUocHBfZWRhZCA9IHBwX2VkYWQgKyAoMTQtZWRhZGgpKQogIH0KICBpZihkZl8xWyJwcCJdPT0yKQogICAgewogICAgZGZuPC1kZl8xJT4lCiAgICAgICAgZmlsdGVyKHBwPT0yKSU+JQogICAgICAgIHNlbGVjdChzdGFydHNfd2l0aChjKCJwcCIsIm1fIikpLGxpbmdfaCwgZWR1X2gsb2N1X2gsZWRhZF9oKSU+JQogICAgICAgIHJlbmFtZSgKICAgICAgICAgIGlkX2hpam8gPSBwcF9pZF9oaWpvLAogICAgICAgICAgcHBfc2V4byA9IHBwLAogICAgICAgICAgcHBfZWRhZCA9IG1fZWRhZF8yMDE2LAogICAgICAgICAgcHBfZWR1YyA9IG1fZWR1LAogICAgICAgICAgcHBfb2N1cCA9IG1fb2N1CiAgICAgICAgKSU+JQogICAgICAgIG11dGF0ZShwcF9lZGFkID0gcHBfZWRhZCArICgxNC1lZGFkaCkpCiAgfQogIGlmKGlzLm5hKGRmbiRwcF9lZGFkKSAmIGdlbmVyYWwpewogICAgcmV0dXJuKCJORCIpCiAgfQogIHJldHVybihkZm4pCn0KCiNjb21wb3JiYW1vcyBxZXUgZnVuY2lvbmUgYmllbgpmaWx0cm9fcHAocGVyZWRhZGVzW1sxXV1bMSxdLDI1LDApCgoKYWNvbW9kYV9kZjwtZnVuY3Rpb24oZGYsZWRhZGgpewogICNkYW1vcyB1biBkYWZhIGRlIHVuYSBlZGFkLCBjb24gYWwgZWRhZCwgeQogICMgbm9zIHJlZ3Jlc2EgdW4gZGF0YSBmcmFtZSBhY29tb2RhZG8KICBhdXg8LWZ1bmN0aW9uKGkpewogICAgcmV0dXJuKGRmW2ksXSkKICB9CiAgYTwtbGFwcGx5KDE6bnJvdyhkZiksYXV4KQogIEw8LWxhcHBseShhLGZpbHRyb19wcCxlZGFkaD1lZGFkaCkKICBkZm4gPC1iaW5kX3Jvd3MoTFsxOmxlbmd0aChMKV0pCiAgcmV0dXJuKGRmbikKfQoKZGZoMjU8LWFjb21vZGFfZGYocGVyZWRhZGVzW1sxXV0sMjUpCmRmaDI1CgoKcHJvX2VkYWRfcCA8LSBmdW5jdGlvbihMLGVkYWRfaCl7CiAgI3Byb21lZGlvIGRlIGVkYWQgZGUgbHNvIHBhZHJlcyBwb3IgZWRhZCBkZSBsb3MgaGlqb3MKICBlZDwtYygpCiAgZHJvIDwtIDAKICBmb3IoaSBpbiAxOm5yb3coTFtbZWRhZF9oLTI0XV0pKXsKICAgIGE8LXBlcmVkYWRlc1tbZWRhZF9oLTI0XV1baSxdCiAgICBkZjwtZmlsdHJvX3BwKGEsZWRhZF9oKQogICAgCiAgICBpZihpcy5kYXRhLmZyYW1lKGRmKSl7CiAgICAgIGVkIDwtYyhlZCxkZiRlZGFkKSAgCiAgICB9CiAgICBlbHNlewogICAgICBkcm88LWRybysxCiAgICB9CiAgfQogIHJldHVybihjKG1lYW4oZWQpLGRybyxucm93KExbW2VkYWRfaC0yNF1dKSkpCn0KCmVkYWRlc19wcm88LSBsYXBwbHkoMjU6NDAscHJvX2VkYWRfcCxMPXBlcmVkYWRlcykKCgoKCgpgYGAKCgojIyBzZWwgcGFkcmVzIHBvYmxhY2lvbgoKYGBge3J9CnBvYmxhY2lvbjwtcmVhZC5kYmYoCiAgICAgICAgICAgICAgZmlsZT0iRGF0b3MvRU5JR0gtSGlzdG9yaWNhLzIwMDUvcG9ibGFjaW9uLmRiZiIKICAgICAgICAgICAgICApCgoKCnBvYmxhX2VuaWdoMjAwNTwtcG9ibGFjaW9uJT4lCiAgZmlsdGVyKAogICAgUEFSRU5URVNDTyA9PSAxMDAsCiAgICBiZXR3ZWVuKEVEQUQsMzAsNTApLAogICAgIWlzLm5hKE5fSU5TVFIxNjEpLAogICAgIWlzLm5hKENNTzEyMSksCiAgICBpcy5uYShDTU8yNTEpCiAgKSU+JQogIHNlbGVjdCgKICAgIEZPTElPLAogICAgTlVNX1JFTiwKICAgIEVEQUQsCiAgICBOX0lOU1RSMTYxLAogICAgQ01PMTIxCiAgKQoKdW5pcXVlKHBvYmxhX2VuaWdoMjAwNSROX0lOU1RSMTYxKQoKYGBgCgojI3NlbCBpbmdyZXNvcyBwYWRyZXMKCmBgYHtyfQppbmdyZXNvczwtcmVhZC5kYmYoCiAgICAgICAgICAgICAgZmlsZT0iRGF0b3MvRU5JR0gtSGlzdG9yaWNhLzIwMDUvaW5ncmVzb3MuZGJmIgogICAgICAgICAgICAgICkKYGBgCgoKYGBge3J9CmZhbWlsaWFzX2ludGVncmFudGVzIDwtIGZ1bmN0aW9uKGRmLG5yKXsKICBkZm4gPC0gZGYgJT4lCiAgICBmaWx0ZXIoTlVNX1JFTiAlaW4lIG5yKQogIHJldHVybihkZm4pCn0gCgoKCmluZ3Jlc29zX2FjdSA8LSBmdW5jdGlvbihkZixjbGF2cyl7CiBkZm4gPC0gZGYgJT4lCiAgIGdyb3VwX2J5KEZPTElPLCBOVU1fUkVOKSAlPiUKICAgZmlsdGVyKENMQVZFICVpbiUgY2xhdnMpJT4lCiAgIHN1bW1hcmlzZSgKICAgY2xhdmVzX2EgPSBwYXN0ZShDTEFWRSxjb2xsYXBzZSA9ICIsIiksCiAgaW5nX3RyaV90ID0gc3VtKElOR19UUkkpLAogIGluZ19tZW5fcCA9IGluZ190cmlfdC8zLAogIGxpbmdfbWVuX3AgPSBsb2coaW5nX21lbl9wKQogICkgJT4lIHVuZ3JvdXAoKQogCiAKIHJldHVybihkZm4pCn0KCiNob2dhcmVzIDwtIGMoIjEiLCIyIiwiMyIsIjQiLCI1IikKcGVyc29uYXNfaCA8LSBjKCcwMScpCgphPC1mYW1pbGlhc19pbnRlZ3JhbnRlcyhpbmdyZXNvcyxwZXJzb25hc19oKQphCmNsYXZlczwtYygiUDAwMSIsIlAwMDIiLCJQMDAzIiwiUDAxMSIsIlAwMjMiLCJQMDI0IiwiUDA1NCIsIlAwNTUiLCJQMDU2IiwgIlAwNTkiLCJQMDYwIiwiUDA2MSIsIlAwNjMiLCJQMDY4IiwiUDA2MCIsIlAwNzAiLCJQMDcxIiwiUDA3MiIsIlAwNzMiLCJQMDc0IiwiUDA3NSIsIlAwNzYiLCJQMDc3IiwiUDA3OCIsIlAwNzkiLCJQMDgwIikKaW5ncmVfZW5pZ2gyMDA1PC1pbmdyZXNvc19hY3UoYSxjbGF2ZXMpIAppbmdyZV9lbmlnaDIwMDU8LWluZ3JlX2VuaWdoMjAwNSU+JQogIHNlbGVjdChGT0xJTyxsaW5nX21lbl9wKQppbmdyZV9lbmlnaDIwMDUKCmBgYAoKCiMjIFJlZ3Jlc2lvbiBwYWRyZXMKCmBgYHtyfQoKZGF0YV9wYWRyZXMyMDA1PC1mdWxsX2pvaW4ocG9ibGFfZW5pZ2gyMDA1LGluZ3JlX2VuaWdoMjAwNSklPiUKICBkcm9wX25hKCklPiUKICBtdXRhdGUoCiAgICBDTU8xMjEgPSBzdWJzdHIoQ01PMTIxLDEsMikKICApJT4lCiAgcmVuYW1lKAogICAgRURVPU5fSU5TVFIxNjEsCiAgICBPQ1UgPSBDTU8xMjEKICApJT4lCiAgbXV0YXRlKAogICAgRURVID0gYXMuY2hhcmFjdGVyKEVEVSkKICApCgp1bmlxdWUoZGF0YV9wYWRyZXMyMDA1JEVEVSkKCiMgYWp1c3RlIHBhcmEgbml2ZWwgZGUgZWN1Y2FjacOzbiBFU1JVCmRhdGFfcGFkcmVzMjAwNSRFRFVbZGF0YV9wYWRyZXMyMDA1JEVEVSA9PSAiOSJdIDwtIDgKCmRhdGFfcGFkcmVzMjAwNSRFRFUgPC0gZmFjdG9yKGRhdGFfcGFkcmVzMjAwNSRFRFUpCmRhdGFfcGFkcmVzMjAwNSRPQ1UgPC0gZmFjdG9yKGRhdGFfcGFkcmVzMjAwNSRPQ1UpCgp1bmlxdWUoZGF0YV9wYWRyZXMyMDA1JE9DVSkKCmBgYAoKYGBge3J9CnJlZ19wYWRyZXM8LWxtKAogIGZvcm11bGEgPSBsaW5nX21lbl9wIH4gRURVICsgIE9DVSArIEVEQUQgK0koRURBRCpFREFEKSwKICBkYXRhID0gZGF0YV9wYWRyZXMyMDA1CikKc3VtbWFyeShyZWdfcGFkcmVzKQpgYGAKCgojIyBJbnNlciBwYWRyZSBlbiBoaWpvCgpzYWNhbXNvIGNvZWZpY2VpY25laXRlIGRlIGVkdWNhY2nDs24geSBvY3VwYWNpw7NuCmBgYHtyfQojc3RyKGRhdGFfcGFkcmVzMjAwNSRFRFVbMV0pCiMgRmFjdG9yIHcvIDEwIGxldmVscyAiMCIsIjEiLCIyIiwiMyIsLi46IDQKCiNzdHIoZGF0YV9wYWRyZXMyMDA1JE9DVVsyXSkKIyBjaHIgIjU1IgoKI3N0cihkYXRhX3BhZHJlczIwMDUkRURBRFs1XSkKIyBpbnQgMzYKCiMgcHJlZGljY2nDs24gOC4zNTQxNDcKCmRmaDI1X25hPC1kZmgyNSU+JQogIGRyb3BfbmEoKQoKIGRhdGE8LSBkYXRhLmZyYW1lKAogICBFRFU9IGFzLmNoYXJhY3RlcihkZmgyNV9uYSRwcF9lZHVjKSwKICBPQ1U9IGFzLmNoYXJhY3RlcihkZmgyNV9uYSRwcF9vY3VwKSwKICBFREFEID0gMAogKQoKIyBkYXRhPC0gZGF0YS5mcmFtZSgKIyAgIEVEVT0gIjEiLAojICAgT0NVPSAiMTEiLAojICAgRURBRD0gMAojIAojICkKIyAKIyAKIyBmaDI1JHBwX29jdXAKCmRmaHAyNTwtIGRmaDI1X25hJT4lCiAgbXV0YXRlKGxpbmdfcCA9IHByZWRpY3Qob2JqZWN0ID0gcmVnX3BhZHJlcywgICAKICAgICAgICBuZXdkYXRhID0gZGF0YSkpIApkZmhwMjUKaGNoYXJ0KGRmaHAyNSwic2NhdHRlciIsaGNhZXMoIHggPSBsaW5nX3AsIHkgPSBsaW5nX2gpICkKYGBgCgojIyBFSUkgMjUgYcOxb3MKCmBgYHtyfQpyZWdfaHA8LWxtKAogIGZvcm11bGEgPSBsaW5nX2ggfiBsaW5nX3AgICwKICBkYXRhID0gZGZocDI1CikKc3VtbWFyeShyZWdfaHApCmBgYAoKCiMjIENvbXByb2JhY2nDs24gZGUgcmVzdWVsdGFkbyAKCmBgYHtyfQpwYWRyZXNfaCAlPiUKICBmaWx0ZXIoZWRhZF9oPT0yNSklPiUKICBjb3VudChtb3YpJT4lCiAgbXV0YXRlKGZyZXEgPSByb3VuZCgxMDAgKiBuL3N1bShuKSwgMCkpJT4lCiAgaGNoYXJ0KCdjb2x1bW4nLAogICAgICAgICBoY2FlcyggeSA9ICdmcmVxJykpJT4lCiAgaGNfYWRkX3RoZW1lKGhjX3RoZW1lX2ZmeCgpKSU+JQogIGhjX3RpdGxlKAogICAgdGV4dCA9ICJQZXJjZXBjacOzbiBkZSBtb3ZpbGlkYWQgZGUgYWN1ZXJkbyBhIGxhIGVkYWQiCiAgKSAlPiUKICBoY19zdWJ0aXRsZSh0ZXh0ID0gIlBhcmEgZWwgY29sb3IgZGUgcGllbCBzZSByZXZpc2EgbGEgZXNjYWxhIikgJT4lCiAgIyBoY19jcmVkaXRzKAogICMgIGVuYWJsZWQgPSBUUlVFLCB0ZXh0ID0gIlNvdXJjZTogU1NTIiwKICAjICBzdHlsZSA9IGxpc3QoZm9udFNpemUgPSAiMTJweCIpKSU+JQogIGhjX3lBeGlzKHRpdGxlID0gbGlzdCh0ZXh0ID0gIlBvcmNlbnRhamUiKSklPiUKICBoY194QXhpcyh0aXRsZT1saXN0KHRleHQ9IkVkYWQiKSwKICAgICAgICAgICBjYXRlZ29yaWVzID0gZ2V0X2xhYmVscyhwYWRyZXNfaCRtb3YpKSAlPiUKICAgIGhjX2V4cG9ydGluZyhlbmFibGVkID0gVFJVRSwKICAgICAgICAgICAgICAgZmlsZW5hbWUgPSAiZGF0b3MiLAogICAgICAgICAgICAgICBidXR0b25zID0gbGlzdChjb250ZXh0QnV0dG9uID0gbGlzdChtZW51SXRlbXMgPSBteU1lbnVJdGVtcykpKQpgYGAKCgojIEVzdCBNdWVzdGFyIGNvbXBsZXRhCgpgYGB7cn0KaGlqb3NfZW1vdmlfaHAgPC0gcmVhZFJEUyhmaWxlPSJEYXRvcy9pbmdyZXNvX2hpal9mX2Vtb3ZpLlJkYSIpCgojIHAwNSBlZGFkIGFjdAojIHAwNiBzZXhvIGFjdAojIHAxMyBlZHVjIGhpam8KIyBTSU5DTzMsIG9jdXBhY2nDs24gaGlqbwojIHAyMyBlbiBxZXUgZXN0YWRvIHZpdmlhIGEgbG9zIDE0CiMgcDI2IHByaW5jaXBhbCBzb3N0ZW4gZWPDs21pY28KIyBwMzhfMTEgZWRhZCBwYWRyZSAyMDE2CiMgcDM4bV8xMSBlZGFkIG1hZHJlIDIwMTYKIyBwNDMgbml2ZWwgZWR1Y2F0aXZvIHBhZHJlCiNwNDNtIG5pdmVsIGVkdWNhdGl2byBtYWRyZQojIGNtbzFfMiBvY3VwYWNpb24gZGVsIHBhZHJlCiMgY21vMl8yIG9jdXBhY2lvbiBkZSBsYSBtYWRyZSAKCgp2YXJwPC1jKCJFc3RhZG8iLCJwMDUiLCJwMDYiLCJwMTMiLCJTSU5DTzMiLCJwMjMiLCJwMjYiLCJwMzhfMTEiLCJwMzhtXzExIiwicDQzIiwicDQ0IiwKICAgICAgICAicDQzbSIsInA0NG0iLCJjbW8xXzIiLCJjbW8yXzIiLCJtb3YiLCJyZWdpb24iKQpwYWRyZXNfaDwtZGF0YV9lbW92aTIwMTclPiUKICAgIGZpbHRlcihwMDIgPT0gMSkgICU+JSAjY29tcGFydGlyIGdhc290IHBhcmEgY29tZXIKICBmaWx0ZXIoYmV0d2VlbihwMDUsMjUsNDApKSAlPiUgIyBlZGFkCiAgI2ZpbHRlcihwMDggPT0gMSkgICU+JSAKICBmaWx0ZXIocDEyID09IDIpICAlPiUjIHlhIG5vIGVzdHVkaWEKICBmaWx0ZXIocDI2ID09IDEgfCBwMjY9PTIgKSAlPiUgIyBzb3N0ZW4gcHJpbmNpcGFsIHBhcGEsIG1hbWEsIAogICBmaWx0ZXIoKCFpcy5uYShwNDMpICYgcDQzIT05OCAmIHAyNiA9PSAxICl8CiAgICAgICAgICAgICghaXMubmEocDQzbSkgJiBwNDNtIT05OCAgJiBwMjYgPT0gMiApKSAlPiUgIyByZXBvcnRhIGVkdWNhY2nDs24gZGUgcHAKICAgZmlsdGVyKCFpcy5uYShwMTMpKSU+JSAjICByZXBvcnRhIGVkdWNhY2nDs24KICBmaWx0ZXIoU0lOQ08zICE9IiIpICU+JSMgcmVwb3J0YSBvZmljaW8gYWN0dWFsCiAgIGZpbHRlcihwNjggPT0gMSB8IHA2OSA9PSAxKSAgJT4lICMgc2kgdHJhYmFqYQogICBmaWx0ZXIocDEzMiAlaW4lIGMoMSkpICU+JSMgcGVyc29uYSBxdWUgYXBvcnRhbiBpbmdyZXNvCiAgZmlsdGVyKCFwMTMzICVpbiUgYyg4LDksTkEpICklPiUKICBzZWxlY3QodmFycCklPiUKICBzbGljZShhcy5pbnRlZ2VyKHVubGlzdChoaWpvc19lbW92aV9ocCU+JXNlbGVjdChpZF9oaWpvKSkpKSU+JQogIG11dGF0ZSgKICAgICAgICAgcHBfaWRfaGlqbyA9IGhpam9zX2Vtb3ZpX2hwJT4lcHVsbChpZF9oaWpvKSwKICAgICAgICAgaW5nX2ggPSBoaWpvc19lbW92aV9ocCU+JXB1bGwoaW5nX21lbl9wX2gpLAogICAgICAgICBsaW5nX2ggPSBsb2cgKGhpam9zX2Vtb3ZpX2hwJT4lcHVsbChpbmdfbWVuX3BfaCkpIAogICAgICAgICApICU+JQogIHJlbmFtZSgKICAgICAgICAgIGVkYWRfaCA9IHAwNSwKICAgICAgICAgIHNleG9faCA9IHAwNiwKICAgICAgICAgIGVkdV9oID0gcDEzLAogICAgICAgICAgb2N1X2ggPSBTSU5DTzMsCiAgICAgICAgICBwcF9lc3RhZG8gPSBwMjMsCiAgICAgICAgICBwcCA9IHAyNiwKICAgICAgICAgIHBfZWRhZF8yMDE2PSBwMzhfMTEsCiAgICAgICAgICBtX2VkYWRfMjAxNiA9IHAzOG1fMTEsCiAgICAgICAgICBwX2VkdSA9IHA0MywKICAgICAgICAgIHBfZWR1ZyA9IHA0NCwKICAgICAgICAgIG1fZWR1ID0gcDQzbSwKICAgICAgICAgIG1fZWR1ZyA9IHA0NG0sCiAgICAgICAgICBwX29jdSA9IGNtbzFfMiwKICAgICAgICAgIG1fb2N1ID0gY21vMl8yCiAgICAgICAgICklPiUKICBtdXRhdGUoCiAgICAgICAgcF9lZHUgPSBhcy5pbnRlZ2VyKHBfZWR1KSwKICAgICAgICBtX2VkdSA9IGFzLmludGVnZXIobV9lZHUpCiAgKQogIAogCiMgbGFzIG9jdXBhY2lvbmVzIG5vIGVuY29udHJhZGFzIGxhcyBzdXN0aXR1aW1vcyBwb3IgdW4gTkEKcGFkcmVzX2g8LXBhZHJlc19oJT4lCiAgbXV0YXRlKHBfb2N1ID0gaWZlbHNlKHBfb2N1PT0iLiIsTkEscF9vY3UpLAogICAgICAgICBtX29jdSA9IGlmZWxzZShtX29jdT09Ii4iLE5BLG1fb2N1KSkKCnVuaXF1ZShwYWRyZXNfaCRwX29jdSkKdW5pcXVlKHBhZHJlc19oJG1fb2N1KQpwYWRyZXNfaAoKYGBgCgojQ3JlYXIgYmFzZSBsaW1waWEKCmBgYHtyfQoKCmZpbHRyb19wcF9jPC1mdW5jdGlvbihkZl8xLGdlbmVyYWwgPSAwKQp7CiAgI3JlY2liZSB1biBoaWpvIGRlIHVuIGRhdGFmcmFtZSwgcGFyYSBwb2xpbW9yZmlzbW8KICAjIGdlbmVyYWwgPSAweSByZWdyZXNhIHVuIGRhdGEgZnJhbWUgY29uIGxvcyBkYXRvcwogICMgb3JkZW5hZG9zIGRlbCBoaWpvCiAgaWYoZGZfMVsicHAiXT09MSkKICB7CiAgICBkZm4gPC0gZGZfMSU+JQogICAgICAgICAgZmlsdGVyKHBwPT0xKSU+JQogICAgICAgICAgc2VsZWN0KHN0YXJ0c193aXRoKGMoInBwIiwicF8iKSksCiAgICAgICAgICAgICAgICAgbGluZ19oLGVkdV9oLG9jdV9oLGVkYWRfaCxwX2VkYWRfMjAxNixyZWdpb24pJT4lCiAgICAgICAgICBtdXRhdGUocHBfZWRhZDIwMTYgPSBwX2VkYWRfMjAxNiklPiUKICAgICAgICAgIHJlbmFtZSgKICAgICAgICAgICAgaWRfaGlqbyA9IHBwX2lkX2hpam8sCiAgICAgICAgICAgIHBwX3NleG8gPSBwcCwKICAgICAgICAgICAgcHBfZWRhZCA9IHBfZWRhZF8yMDE2LAogICAgICAgICAgICBwcF9lZHVjID0gcF9lZHUsCiAgICAgICAgICAgIHBwX2VkdWNnID0gcF9lZHVnLAogICAgICAgICAgICBwcF9vY3VwID0gcF9vY3UKICAgICAgICAgICklPiUKICAgICAgICBtdXRhdGUocHBfZWRhZCA9IHBwX2VkYWQgKyAoMTQtZWRhZF9oKSkKICB9CiAgaWYoZGZfMVsicHAiXT09MikKICAgIHsKICAgIGRmbjwtZGZfMSU+JQogICAgICAgIGZpbHRlcihwcD09MiklPiUKICAgICAgICBzZWxlY3Qoc3RhcnRzX3dpdGgoYygicHAiLCJtXyIpKSwKICAgICAgICAgICAgICAgbGluZ19oLCBlZHVfaCxvY3VfaCxlZGFkX2gsbV9lZGFkXzIwMTYscmVnaW9uKSU+JQogICAgICAgbXV0YXRlKHBwX2VkYWQyMDE2ID0gbV9lZGFkXzIwMTYpJT4lCiAgICAgICAgcmVuYW1lKAogICAgICAgICAgaWRfaGlqbyA9IHBwX2lkX2hpam8sCiAgICAgICAgICBwcF9zZXhvID0gcHAsCiAgICAgICAgICBwcF9lZGFkID0gbV9lZGFkXzIwMTYsCiAgICAgICAgICBwcF9lZHVjID0gbV9lZHUsCiAgICAgICAgICBwcF9lZHVjZyA9IG1fZWR1ZywKICAgICAgICAgIHBwX29jdXAgPSBtX29jdQogICAgICAgICklPiUKICAgICAgICBtdXRhdGUocHBfZWRhZCA9IHBwX2VkYWQgKyAoMTQtZWRhZF9oKSkKICB9CiAgaWYoaXMubmEoZGZuJHBwX2VkYWQpICYgZ2VuZXJhbCl7CiAgICByZXR1cm4oIk5EIikKICB9CiAgcmV0dXJuKGRmbikKfQoKI2NvbXBvcmJhbW9zIHFldSBmdW5jaW9uZSBiaWVuCmZpbHRyb19wcF9jKHBhZHJlc19oWzEsXSkKCgphY29tb2RhX2RmX2M8LWZ1bmN0aW9uKGRmKXsKICAjZGFtb3MgdW4gZGYgZGUgdW5hIGVkYWQsICB5CiAgIyBub3MgcmVncmVzYSB1biBkYXRhIGZyYW1lIGFjb21vZGFkbwogIGF1eDwtZnVuY3Rpb24oaSl7CiAgICByZXR1cm4oZGZbaSxdKQogIH0KICBhPC1sYXBwbHkoMTpucm93KGRmKSxhdXgpCiAgTDwtbGFwcGx5KGEsZmlsdHJvX3BwX2MpCiAgZGZuIDwtYmluZF9yb3dzKExbMTpsZW5ndGgoTCldKQogIHJldHVybihkZm4pCn0KCmRmaDwtYWNvbW9kYV9kZl9jKHBhZHJlc19oKQoKCgpwcm9fZWRhZF9jIDwtIGZ1bmN0aW9uKGRmKXsKICAjbGUgZGFtb3MgZWwgZGYgeSBub3MgcmVncmVzYSBlbCBwcm9tZWRpbyBkZSBsYSBlZGFkZSAgbG9zIHBhZHJlcwogIGRmJT4lc3VtbWFyaXNlKAogICAgcHJvbWVkaV9lZGFkX3BhZHJlcyA9IG1lYW4ocHBfZWRhZDIwMTYsbmEucm09VFJVRSkpCiAgfQoKZWRhZGVzX3BybzwtIHByb19lZGFkX2MoZGZoKQoKZWRhZGVzX3BybwojZWRhZGVzIGRlIHBhZHJlcyBmYWx0YW50ZXMKc3VtKGlzLm5hKGRmaCRwcF9lZGFkMjAxNikpCiMgMTMgZGUgMzM3CmBgYAojIyBzZWwgcGFkcmVzIHBvYmxhY2lvbgoKU2VsZWNjaW9uYW1vcyBkZSBsYSBFTklHSCAxOTk3LCBubyBoYXkgZW50b25jZXMgMTk5OAoKYGBge3J9CnBvYmxhY2lvbjwtcmVhZC5kYmYoCiAgICAgICAgICAgICAgZmlsZT0iRGF0b3MvRU5JR0gtSGlzdG9yaWNhLzE5OTgvUE9CTEE5OC5kYmYiCiAgICAgICAgICAgICAgKQoKCgpwb2JsYV9lbmlnaDE5OTg8LXBvYmxhY2lvbiU+JQogIGZpbHRlcigKICAgIHBhcmVudGVzY28gPT0gIjAxIiwKICAgIGJldHdlZW4oZWRhZCwzMCw1MCksCiAgICAhaXMubmEoZWRfZm9ybWFsKSwKICAgICFpcy5uYShlZF90ZWNuaWNhKSwKICAgICFpcy5uYShvY3VwYWNpb24pLAogICAgbl9lbXBsZW9zPT0xLCAjIGVsIGVudHJldmlzdGFkbyBzb2xvIHByb3BvcmNpb25hIHVuYSBvY3VwYWNpw7NuCiAgKSU+JQogIHNlbGVjdCgKICAgIGZvbGlvLAogICAgbnVtX3JlbiwKICAgIGVkYWQsCiAgICBlZF9mb3JtYWwsCiAgICBlZF90ZWNuaWNhLAogICAgb2N1cGFjaW9uCiAgKSU+JQogbXV0YXRlKAogIGVkX2Zvcm1hbCA9IGFzLmludGVnZXIoYXMuY2hhcmFjdGVyKGVkX2Zvcm1hbCkpLAogICBlZF90ZWNuaWNhPSBhcy5pbnRlZ2VyKGFzLmNoYXJhY3RlcihlZF90ZWNuaWNhKSksCiAgZXN0YWRvID0gc3Vic3RyKGZvbGlvLDUsNikKICkKCiN1bmlxdWUocG9ibGFfZW5pZ2gxOTk4JGVkX2Zvcm1hbCkKI3BvYmxhX2VuaWdoMTk5OCRlZF9mb3JtYWwKbnJvdyhwb2JsYV9lbmlnaDE5OTgpCmhlYWQocG9ibGFfZW5pZ2gxOTk4JGVkX2Zvcm1hbCkKc3RyKHBvYmxhX2VuaWdoMTk5OCRlZF9mb3JtYWwpI2NhcmFjdGVyIDIgZXNwYWNpb3MKdW5pcXVlKHBvYmxhX2VuaWdoMTk5OCRlZF9mb3JtYWwpCiNwb2JsYV9lbmlnaDE5OTgkZWRfZm9ybWFsPT0iMDMiCmhlYWQocG9ibGFfZW5pZ2gxOTk4JGVkX3RlY25pY2EpCnN0cihwb2JsYV9lbmlnaDE5OTgkZWRfdGVjbmljYSkjY2FyYWN0ZXIgMSBlc3BhY2lvCnVuaXF1ZShwb2JsYV9lbmlnaDE5OTgkZWRfdGVjbmljYSkKI3BvYmxhX2VuaWdoMTk5OCU+JWNvdW50KG5fZW1wbGVvcyksIHNlIGV4cGxvcm8gcGFyYSBxdWl0YXIgdW5hIG9jdXBhY2lvbgpuYW1lcyhwb2JsYWNpb24pCnN0cihwb2JsYWNpb24kcGVyX2luZykKYGBgCiMjIGNvZCBlbmlnaCAxOTk4CgpgYGB7cn0KIyBoYWNlbW9zIGxhIGNvZGlmaWNhY2nDs24gZGUgRU5JR0gyMDE4IGEgRVNSVQojMQlQcmVlc2NvbGFyIG8ga8OtbmRlcgojIDIJUHJpbWFyaWEKIyAzCVNlY3VuZGFyaWEgdMOpY25pY2EKIyA0CVNlY3VuZGFyaWEgZ2VuZXJhbAojIDUJUHJlcGFyYXRvcmlhIHTDqWNuaWNhCiMgNglQcmVwYXJhdG9yaWEgZ2VuZXJhbAojIDcJVMOpY25pY2EgbyBjb21lcmNpYWwgY29uIHNlY3VuZGFyaWEKIyA4CVTDqWNuaWNhIG8gY29tZXJjaWFsIGNvbiBwcmVwYXJhdG9yaWEKIyA5CU5vcm1hbCBiw6FzaWNhIChjb24gcHJpbWFyaWEgbyBzZWN1bmRhcmkKIyAxMCBOb3JtYWwgZGUgbGljZW5jaWF0dXJhCiMgMTEgUHJvZmVzaW9uYWwgKGxpY2VuY2lhdHVyYSBvIGluZ2VuaWVyw61hKQojIDEyIFBvc3RncmFkbyAobWFlc3Ryw61hIG8gZG9jdG9yYWRvKQojX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KIyA5OCBOUywgbm8gYXBsaWNhIHBvcnF1ZSBwZWRpbW9zIGxhIGVkdWNpw7NuIGRlbCBwcCBjb21vIGluc3RydW1lbnRvCgoKIyB2ZW1zbyBsYXMgY29tYmluYWNpb25lcyBkZSBlZHVjYWNpw7NuIHBhcmEgY29kaWZpY2FyCgpjb21iPC1wb2JsYV9lbmlnaDE5OTglPiUKICAgbXV0YXRlKCBjb21iaSA9IHBhc3RlKGFzLmNoYXJhY3RlcihlZF9mb3JtYWwpLGFzLmNoYXJhY3RlcihlZF90ZWNuaWNhKSkpJT4lCiAgc2VsZWN0KGVkX2Zvcm1hbCxlZF90ZWNuaWNhLGNvbWJpKQoKICAKc29ydCh1bmlxdWUoY29tYiRjb21iaSkpCiMgWzFdICIwMSAxIiAiMDIgMSIgIjAzIDEiICIwMyAyIiAiMDQgMSIgIjA1IDEiICIwNiAxIiAiMDcgMSIgIjA3IDIiICIwOCAxIgojIFsxMV0gIjA4IDIiICIwOCAzIiAiMDggNCIgIjA4IDUiICIwOSAxIiAiMDkgNCIgIjA5IDUiICIxMCAxIiAiMTAgMiIgIjEwIDQiCiMgWzIxXSAiMTAgNSIgIjExIDEiICIxMSAzIiAiMTEgNCIgIjExIDUiICIxMSA2IiAiMTEgNyIgIjEyIDEiICIxMiAzIiAiMTIgNSIKIyBbMzFdICIxMiA2IiAiMTIgNyIgIjEzIDEiICIxMyA1IiAiMTMgNiIgIjEzIDciICIxMyA4IiAiMTMgOSIgIjE0IDEiICIxNCAzIgojIFs0MV0gIjE0IDUiICIxNCA2IiAiMTQgNyIgIjE0IDkiICIxNSAxIiAiMTUgMyIgIjE1IDQiICIxNSA1IiAiMTUgNiIgIjE1IDciCiMgWzUxXSAiMTUgOSIgIjE2IDEiICIxNiA1IiAiMTYgNyIgIjE2IDkiCgoKCgojICIxNiAxIiAiMTYgNSIgIjE2IDciICIxNiA5IgoKI2NvZGlmaWNhbW9zIGEgYSBhw7FvcyBkZSBlZHVjYWNpw7NuCnBvYmxhX2VuaWdoYzE5OTg8LXBvYmxhX2VuaWdoMTk5OCU+JQogICBtdXRhdGUoCiAgIGVkdV9hID0gaWZlbHNlKGVkX2Zvcm1hbD09MSAmIGVkX3RlY25pY2E9PTEsMCwgICAgI3NpbiBpbnN0cnVjY2lvbigxKQogICAgICAgICAgaWZlbHNlKChlZF9mb3JtYWwgJWluJSBjKDIsMyw0LDUsNiw3LDgsOSwxMCwxMSwxMiwxMykpCiAgICAgICAgICAgICAgICAgJiAoZWRfdGVjbmljYSAlaW4lIGMoMSwyKSksZWRfZm9ybWFsLTEsCiAgICAgICAgICBpZmVsc2UoZWRfZm9ybWFsPT04ICYgKGVkX3RlY25pY2EgJWluJSBjKDMsNCw1KSksOSwKICAgICAgICAgIGlmZWxzZShlZF9mb3JtYWw9PTkgJiAoZWRfdGVjbmljYSAlaW4lIGMoNCw1KSksMTAsCiAgICAgICAgICBpZmVsc2UoZWRfZm9ybWFsPT0xMCAmIChlZF90ZWNuaWNhICVpbiUgYygyLDQsNSkpLDExLAogICAgICAgICAgaWZlbHNlKGVkX2Zvcm1hbD09MTEgJiAoZWRfdGVjbmljYSAlaW4lIGMoMyw0LDUsNSw3KSksMTIsCiAgICAgICAgICBpZmVsc2UoKGVkX2Zvcm1hbCAlaW4lYygxMikpICYgKGVkX3RlY25pY2EgJWluJSBjKDMsNSw2LDcpKSwxMiwKICAgICAgICAgIGlmZWxzZShlZF9mb3JtYWw9PTEzICYgKGVkX3RlY25pY2EgJWluJSBjKDUsNiw3LDgsOSkpLDEzLAogICAgICAgICAgaWZlbHNlKGVkX2Zvcm1hbD09MTQgJiAoZWRfdGVjbmljYSAlaW4lIGMoMSwzLDUsNiw3LDkpKSwxNCwKICAgICAgICAgIGlmZWxzZShlZF9mb3JtYWw9PTE1ICYgKGVkX3RlY25pY2EgJWluJSBjKDEsMyw0LDUsNiw3LDkpKSwxNywxOSkpKSkpKSkpKSkKICApCgp1bmlxdWUocG9ibGFfZW5pZ2hjMTk5OCRlZHVfYSApCgojY29kaWZpY2Ftb3MgYSBjb2dob3J0IGRlIGVkdWNhY2nDs24KCnBvYmxhX2VuaWdoYzE5OTg8LXBvYmxhX2VuaWdoYzE5OTglPiUKICAgbXV0YXRlKAogICBlZHVfYWMgPSBpZmVsc2UoZWR1X2EgJWluJSAwOjUsIkMxIiwgICAgCiAgICAgICAgICBpZmVsc2UoZWR1X2EgJWluJSA2OjEwICwiQzIiLAogICAgICAgICAgaWZlbHNlKGVkdV9hICVpbiUgMTE6MTIsIkMzIiwKICAgICAgICAgIGlmZWxzZShlZHVfYSAlaW4lIDEzOjE0LCJDNCIsIkM1IikpKSkKICApCgp1bmlxdWUocG9ibGFfZW5pZ2hjMTk5OCRlZHVfYWMgKQoKCmBgYAoKIyMgZXRpcXVldGFtb3MgcmVnaW9uCmBgYHtyfQoKcG9ibGFfZW5pZ2hjMTk5ODwtcG9ibGFfZW5pZ2hjMTk5OCU+JQogICAgICAgICAgbXV0YXRlKAogICAgICAgICAgICByZWdpb24gPSBpZmVsc2UoZXN0YWRvICVpbiUgYygiMDIiLCIyNiIsIjA4IiwiMDUiLCIxOSIsIjI4IiksMSwKICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGVzdGFkbyAlaW4lIGMoIjEyIiwiMjAiLCIwNyIsIjMwIiwiMjciLCIwNCIsIjMxIiwiMjMiKSw1LDApKQogICAgICAgICAgKQpgYGAKCgoKIyMgY29kIEVTUlUKCmBgYHtyfQoKZGZoX2M8LSBkZmglPiUKICAgbXV0YXRlKAogICBwcF9lZHVjX2EgPSBpZmVsc2UocHBfZWR1Yz09MSwxLCAgICAjc2luIGluc3RydWNjaW9uKDEpCiAgICAgICAgICBpZmVsc2UocHBfZWR1Yz09MiwxK3BwX2VkdWNnLAogICAgICAgICAgaWZlbHNlKHBwX2VkdWMgJWluJSBjKDMsNCksNytwcF9lZHVjZywKICAgICAgICAgIGlmZWxzZShwcF9lZHVjICVpbiUgYyg1LDYsNyw4LDkpLDEwK3BwX2VkdWNnLAogICAgICAgICAgaWZlbHNlKHBwX2VkdWMgJWluJSBjKDEwLDExKSwxMytwcF9lZHVjZywxNytwcF9lZHVjZykpKSkpCiAgKQoKICAKCnVuaXF1ZShkZmhfYyRwcF9lZHVjX2EpCgpkZmhfYzwtZGZoX2MlPiUKICBtdXRhdGUoCiAgIHBwX2VkdWNfYWMgPSBpZmVsc2UocHBfZWR1Y19hICVpbiUgMDo1LCJDMSIsICAgIAogICAgICAgICAgaWZlbHNlKHBwX2VkdWNfYSAlaW4lIDY6MTAgLCJDMiIsCiAgICAgICAgICBpZmVsc2UocHBfZWR1Y19hICVpbiUgMTE6MTIsIkMzIiwKICAgICAgICAgIGlmZWxzZShwcF9lZHVjX2EgJWluJSAxMzoxNCwiQzQiLCJDNSIpKSkpCiAgKQoKYGBgCgoKIyNzZWwgaW5ncmVzb3MgcGFkcmVzCgpgYGB7cn0KaW5ncmVzb3M8LXJlYWQuZGJmKAogICAgICAgICAgICAgIGZpbGU9IkRhdG9zL0VOSUdILUhpc3RvcmljYS8xOTk4L2luZ3Jlc29zLmRiZiIKICAgICAgICAgICAgICApCmBgYAoKCmBgYHtyfQpmYW1pbGlhc19pbnRlZ3JhbnRlcyA8LSBmdW5jdGlvbihkZixucil7CiAgZGZuIDwtIGRmICU+JQogICAgZmlsdGVyKE5VTV9SRU4gJWluJSBucikKICByZXR1cm4oZGZuKQp9IAoKCgppbmdyZXNvc19hY3UgPC0gZnVuY3Rpb24oZGYsY2xhdnMpewogZGZuIDwtIGRmICU+JQogICBncm91cF9ieShGT0xJTywgTlVNX1JFTikgJT4lCiAgIGZpbHRlcihDTEFWRSAlaW4lIGNsYXZzKSU+JQogICBzdW1tYXJpc2UoCiAgIGNsYXZlc19hID0gcGFzdGUoQ0xBVkUsY29sbGFwc2UgPSAiLCIpLAogIGluZ190cmlfdCA9IHN1bShJTkdfVFJJKSwKICBpbmdfbWVuX3AgPSBpbmdfdHJpX3QvMywKICBsaW5nX21lbl9wID0gbG9nKGluZ19tZW5fcCkKICApICU+JSB1bmdyb3VwKCkKIAogCiByZXR1cm4oZGZuKQp9CgojaG9nYXJlcyA8LSBjKCIxIiwiMiIsIjMiLCI0IiwiNSIpCnBlcnNvbmFzX2ggPC0gYygnMDEnKQoKYTwtZmFtaWxpYXNfaW50ZWdyYW50ZXMoaW5ncmVzb3MscGVyc29uYXNfaCkKYQpjbGF2ZXM8LWMoIlAwMDEiLCJQMDAyIiwiUDAwMyIsIlAwMTAiLCJQMDExIiwiUDAxMiIsIlAwMTMiLCJQMDE0IiwiUDAxNSIsICJQMDE2IiwiUDAxNyIsIlAwMTgiLCJQMDIwIiwiUDAyMSIsIlAwMjYiLCJQMDI3IiwiUDAzNSIsIlAwNDAiLCJQMDQxIiwiUDA0MiIsIlAwNDQiLCJQMDQ1IikKaW5ncmVfZW5pZ2gxOTk4PC1pbmdyZXNvc19hY3UoYSxjbGF2ZXMpIAppbmdyZV9lbmlnaDE5OTg8LWluZ3JlX2VuaWdoMTk5OCU+JQogIHNlbGVjdChGT0xJTyxOVU1fUkVOLGxpbmdfbWVuX3ApJT4lCiAgcmVuYW1lKAogICAgZm9saW8gPSBGT0xJTywKICAgIG51bV9yZW4gPSBOVU1fUkVOCiAgKQppbmdyZV9lbmlnaDE5OTgKCmBgYAoKIyMgUmVncmVzaW9uIHBhZHJlcwoKYGBge3J9CgpkYXRhX3BhZHJlczE5OTg8LWZ1bGxfam9pbihwb2JsYV9lbmlnaGMxOTk4LGluZ3JlX2VuaWdoMTk5OCklPiUKICBkcm9wX25hKCklPiUKICAgbXV0YXRlKAogICAgIG9jdXBhY2lvbiA9IHN1YnN0cihvY3VwYWNpb24sMSwyKQogICApIyU+JQogICMgcmVuYW1lKAogICMgICBFRFU9Tl9JTlNUUjE2MSwKICAjICAgT0NVID0gQ01PMTIxCiAgIyApJT4lCiAgIyBtdXRhdGUoCiAgIyAgIEVEVSA9IGFzLmNoYXJhY3RlcihFRFUpCiAgIyApCmRhdGFfcGFkcmVzMTk5OAoKdW5pcXVlKGRhdGFfcGFkcmVzMTk5OCRlZGFkKQoKIyBhanVzdGUgcGFyYSBuaXZlbCBkZSBlY3VjYWNpw7NuIEVTUlUKCiNkYXRhX3BhZHJlczIwMDUkRURVIDwtIGZhY3RvcihkYXRhX3BhZHJlczIwMDUkRURVKQojZGF0YV9wYWRyZXMyMDA1JE9DVSA8LSBmYWN0b3IoZGF0YV9wYWRyZXMyMDA1JE9DVSkKCiN1bmlxdWUoZGF0YV9wYWRyZXMyMDA1JE9DVSkKCmBgYAoKYGBge3J9CnJlZ19wYWRyZXM8LWxtKAogIGZvcm11bGEgPSBsaW5nX21lbl9wIH4gZWR1X2FjICsgb2N1cGFjaW9uICsgZWRhZCArSShlZGFkKmVkYWQpLAogIGRhdGEgPSBkYXRhX3BhZHJlczE5OTgKKQpzdW1tYXJ5KHJlZ19wYWRyZXMpCmBgYAoKIyMgSW5zZXIgcGFkcmUgZW4gaGlqbwoKc2FjYW1zbyBjb2VmaWNlaWNuZWl0ZSBkZSBlZHVjYWNpw7NuIHkgb2N1cGFjacOzbgpgYGB7cn0KCgoKIyBkYXRhPC0gZGF0YS5mcmFtZSgKIyAgICBlZHVfYWM9ICJDMSIsCiMgICBvY3VwYWNpb249ICIxMSIsCiMgICBlZGFkID0gMAojICApCiMgCiMgcHJlZGljdChvYmplY3QgPSByZWdfcGFkcmVzLCAgIAojICAgICAgICAgbmV3ZGF0YSA9IGRhdGEpCiAKI3VuaXF1ZShkZmhfYyRwcF9vY3VwKQojc3VtKGlzLm5hKGRmaF9jJHBwX29jdXApKSBwb2RlbW9zIHV0aWl6YXIgbGEgb2N1cGFjacOzbiBjb21vIGluc3RydW1lbnRvIHRhbWJpZW4sIHNvbG8gc2UgcGllcmRlbiAxMiBtdWVzdHJhcwoKZGZoX2NuYTwtZGZoX2MlPiVkcm9wX25hKHBwX29jdXAscHBfZWRhZCkKCmRhdGE8LSBkYXRhLmZyYW1lKAogICAgZWR1X2FjPSBkZmhfY25hJHBwX2VkdWNfYWMsCiAgIG9jdXBhY2lvbj0gZGZoX2NuYSRwcF9vY3VwLAogICBlZGFkID0gMAogICkKCmRmaHBmPC0gZGZoX2NuYSU+JQogIG11dGF0ZShsaW5nX3AgPSBwcmVkaWN0KG9iamVjdCA9IHJlZ19wYWRyZXMsICAgCiAgICAgICAgbmV3ZGF0YSA9IGRhdGEpKSAKZGZocGYKCgojIFNJIHNvbG8gaW5zdHJ1bWVudGFtb3MgcG9yIGVkdWFjaW9uCgoKCgpoY2hhcnQoZGZocGYsInNjYXR0ZXIiLGhjYWVzKCB4ID0gbGluZ19wLCB5ID0gbGluZ19oKSApCmBgYAoKCiMjIEVJSSBUb2RvcwoKYGBge3J9CnJlZ19ocDwtbG0oCiAgZm9ybXVsYSA9IGxpbmdfaCB+IGxpbmdfcCArIGVkYWRfaCsgSShlZGFkX2gqZWRhZF9oKSsgc3Vic3RyKG9jdV9oLDEsMiksCiAgZGF0YSA9IGRmaHBmCikKc3VtbWFyeShyZWdfaHApCmBgYAoKCmBgYHtyfQpwYWRyZXNfaCAlPiUKICBjb3VudChtb3YpJT4lIAogIG11dGF0ZShmcmVxID0gcm91bmQoMTAwICogbi9zdW0obiksIDApKSU+JQogIGhjaGFydCgnY29sdW1uJywKICAgICAgICAgaGNhZXMoIHkgPSAnZnJlcScpKSU+JQogIGhjX2FkZF90aGVtZShoY190aGVtZV9mZngoKSklPiUKICBoY190aXRsZSgKICAgIHRleHQgPSAiUGVyY2VwY2nDs24gZGUgbW92aWxpZGFkIgogICkgJT4lCiAgaGNfc3VidGl0bGUodGV4dCA9ICIiKSAlPiUKICAjIGhjX2NyZWRpdHMoCiAgIyAgZW5hYmxlZCA9IFRSVUUsIHRleHQgPSAiU291cmNlOiBTU1MiLAogICMgIHN0eWxlID0gbGlzdChmb250U2l6ZSA9ICIxMnB4IikpJT4lCiAgaGNfeUF4aXModGl0bGUgPSBsaXN0KHRleHQgPSAiUG9yY2VudGFqZSIpKSU+JQogIGhjX3hBeGlzKHRpdGxlPWxpc3QodGV4dD0iVGlwbyBkZSBwZXJjZXBjacOzbiIpLAogICAgICAgICAgIGNhdGVnb3JpZXMgPSBnZXRfbGFiZWxzKHBhZHJlc19oJG1vdikpICU+JQogICAgaGNfZXhwb3J0aW5nKGVuYWJsZWQgPSBUUlVFLAogICAgICAgICAgICAgICBmaWxlbmFtZSA9ICJkYXRvcyIsCiAgICAgICAgICAgICAgIGJ1dHRvbnMgPSBsaXN0KGNvbnRleHRCdXR0b24gPSBsaXN0KG1lbnVJdGVtcyA9IG15TWVudUl0ZW1zKSkpCmBgYAoKCiMgRXN0aW1hY2nDs24gcmVnaW9uYWwKCmBgYHtyfQpyZWdfcGFkcmVzPC1sbSgKICBmb3JtdWxhID0gbGluZ19tZW5fcCB+IGVkdV9hYyArIG9jdXBhY2lvbiArIGVkYWQgK0koZWRhZCplZGFkKSwKICBkYXRhID0gZGF0YV9wYWRyZXMxOTk4LCBzdWJzZXQ9KHJlZ2lvbj09MSkpCnN1bW1hcnkocmVnX3BhZHJlcykKYGBgCgoKCiMjIEluc2VyIHBhZHJlIGVuIGhpam8KCnNhY2Ftc28gY29lZmljZWljbmVpdGUgZGUgZWR1Y2FjacOzbiB5IG9jdXBhY2nDs24KYGBge3J9CgoKCiMgZGF0YTwtIGRhdGEuZnJhbWUoCiMgICAgZWR1X2FjPSAiQzEiLAojICAgb2N1cGFjaW9uPSAiMTEiLAojICAgZWRhZCA9IDAKIyAgKQojIAojIHByZWRpY3Qob2JqZWN0ID0gcmVnX3BhZHJlcywgICAKIyAgICAgICAgIG5ld2RhdGEgPSBkYXRhKQogCiN1bmlxdWUoZGZoX2MkcHBfb2N1cCkKI3N1bShpcy5uYShkZmhfYyRwcF9vY3VwKSkgcG9kZW1vcyB1dGlpemFyIGxhIG9jdXBhY2nDs24gY29tbyBpbnN0cnVtZW50byB0YW1iaWVuLCBzb2xvIHNlIHBpZXJkZW4gMTIgbXVlc3RyYXMKCmRmaF9jbmE8LWRmaF9jJT4lCiAgZmlsdGVyKHJlZ2lvbj09IjEiKSU+JQogIGRyb3BfbmEocHBfb2N1cCkKCmRhdGE8LSBkYXRhLmZyYW1lKAogICAgZWR1X2FjPSBkZmhfY25hJHBwX2VkdWNfYWMsCiAgIG9jdXBhY2lvbj0gZGZoX2NuYSRwcF9vY3VwLAogICBlZGFkID0gMAogICkKCmRmaHBmPC0gZGZoX2NuYSU+JQogIG11dGF0ZShsaW5nX3AgPSBwcmVkaWN0KG9iamVjdCA9IHJlZ19wYWRyZXMsICAgCiAgICAgICAgbmV3ZGF0YSA9IGRhdGEpKSAKZGZocGYKCgoKCgoKaGNoYXJ0KGRmaHBmLCJzY2F0dGVyIixoY2FlcyggeCA9IGxpbmdfcCwgeSA9IGxpbmdfaCkgKQpgYGAKCiMjIEVJSSByZWdpb25hbCAxCgpgYGB7cn0KcmVnX2hwPC1sbSgKICBmb3JtdWxhID0gbGluZ19oIH4gbGluZ19wICsgZWRhZF9oKyBJKGVkYWRfaCplZGFkX2gpKyBzdWJzdHIob2N1X2gsMSwyKSwKICBkYXRhID0gZGZocGYKKQpzdW1tYXJ5KHJlZ19ocCkKYGBgCgoKIyMgQ29tcHJvYmFjacOzbiBkZSByZXN1ZWx0YWRvIAoKYGBge3J9CnBhZHJlc19oICU+JQogIGZpbHRlcihyZWdpb249PSIxIiklPiUKICBjb3VudChtb3YpJT4lCiAgbXV0YXRlKGZyZXEgPSByb3VuZCgxMDAgKiBuL3N1bShuKSwgMCkpJT4lCiAgaGNoYXJ0KCdjb2x1bW4nLAogICAgICAgICBoY2FlcyggeSA9ICdmcmVxJykpJT4lCiAgaGNfYWRkX3RoZW1lKGhjX3RoZW1lX2ZmeCgpKSU+JQogIGhjX3RpdGxlKAogICAgdGV4dCA9ICJQZXJjZXBjacOzbiBkZSBtb3ZpbGlkYWQgcmVnaW9uIDEiCiAgKSAlPiUKICBoY19zdWJ0aXRsZSh0ZXh0ID0gIlBhcmEgZWwgY29sb3IgZGUgcGllbCBzZSByZXZpc2EgbGEgZXNjYWxhIikgJT4lCiAgIyBoY19jcmVkaXRzKAogICMgIGVuYWJsZWQgPSBUUlVFLCB0ZXh0ID0gIlNvdXJjZTogU1NTIiwKICAjICBzdHlsZSA9IGxpc3QoZm9udFNpemUgPSAiMTJweCIpKSU+JQogIGhjX3lBeGlzKHRpdGxlID0gbGlzdCh0ZXh0ID0gIlBvcmNlbnRhamUiKSklPiUKICBoY194QXhpcyh0aXRsZT1saXN0KHRleHQ9IkVkYWQiKSwKICAgICAgICAgICBjYXRlZ29yaWVzID0gZ2V0X2xhYmVscyhwYWRyZXNfaCR2bykpICU+JQogICAgaGNfZXhwb3J0aW5nKGVuYWJsZWQgPSBUUlVFLAogICAgICAgICAgICAgICBmaWxlbmFtZSA9ICJkYXRvcyIsCiAgICAgICAgICAgICAgIGJ1dHRvbnMgPSBsaXN0KGNvbnRleHRCdXR0b24gPSBsaXN0KG1lbnVJdGVtcyA9IG15TWVudUl0ZW1zKSkpCmBgYAoKCgojIEVzdGltYWNpw7NuIHJlZ2lvbmFsIDUKCmBgYHtyfQpyZWdfcGFkcmVzPC1sbSgKICBmb3JtdWxhID0gbGluZ19tZW5fcCB+IGVkdV9hYyArIG9jdXBhY2lvbiArIGVkYWQgK0koZWRhZCplZGFkKSwKICBkYXRhID0gZGF0YV9wYWRyZXMxOTk4LCBzdWJzZXQ9KHJlZ2lvbj09NSkpCnN1bW1hcnkocmVnX3BhZHJlcykKYGBgCgoKCiMjIEluc2VyIHBhZHJlIGVuIGhpam8KCnNhY2Ftc28gY29lZmljZWljbmVpdGUgZGUgZWR1Y2FjacOzbiB5IG9jdXBhY2nDs24KYGBge3J9CgoKCiMgZGF0YTwtIGRhdGEuZnJhbWUoCiMgICAgZWR1X2FjPSAiQzEiLAojICAgb2N1cGFjaW9uPSAiMTEiLAojICAgZWRhZCA9IDAKIyAgKQojIAojIHByZWRpY3Qob2JqZWN0ID0gcmVnX3BhZHJlcywgICAKIyAgICAgICAgIG5ld2RhdGEgPSBkYXRhKQogCiN1bmlxdWUoZGZoX2MkcHBfb2N1cCkKI3N1bShpcy5uYShkZmhfYyRwcF9vY3VwKSkgcG9kZW1vcyB1dGlpemFyIGxhIG9jdXBhY2nDs24gY29tbyBpbnN0cnVtZW50byB0YW1iaWVuLCBzb2xvIHNlIHBpZXJkZW4gMTIgbXVlc3RyYXMKCmRmaF9jbmE8LWRmaF9jJT4lCiAgZmlsdGVyKHJlZ2lvbj09IjUiKSU+JQogIGRyb3BfbmEocHBfb2N1cCkKCmRhdGE8LSBkYXRhLmZyYW1lKAogICAgZWR1X2FjPSBkZmhfY25hJHBwX2VkdWNfYWMsCiAgIG9jdXBhY2lvbj0gZGZoX2NuYSRwcF9vY3VwLAogICBlZGFkID0gMAogICkKCmRmaHBmPC0gZGZoX2NuYSU+JQogIG11dGF0ZShsaW5nX3AgPSBwcmVkaWN0KG9iamVjdCA9IHJlZ19wYWRyZXMsICAgCiAgICAgICAgbmV3ZGF0YSA9IGRhdGEpKSAKZGZocGYKCgoKCgoKaGNoYXJ0KGRmaHBmLCJzY2F0dGVyIixoY2FlcyggeCA9IGxpbmdfcCwgeSA9IGxpbmdfaCkgKQpgYGAKCiMjIEVJSSByZWdpb25hbCAxCgpgYGB7cn0KcmVnX2hwPC1sbSgKICBmb3JtdWxhID0gbGluZ19oIH4gbGluZ19wICsgZWRhZF9oKyBJKGVkYWRfaCplZGFkX2gpKyBzdWJzdHIob2N1X2gsMSwyKSwKICBkYXRhID0gZGZocGYKKQpzdW1tYXJ5KHJlZ19ocCkKYGBgCgoKIyMgQ29tcHJvYmFjacOzbiBkZSByZXN1ZWx0YWRvIAoKYGBge3J9CnBhZHJlc19oICU+JQogIGZpbHRlcihyZWdpb249PSI1IiklPiUKICBjb3VudChtb3YpJT4lCiAgbXV0YXRlKGZyZXEgPSByb3VuZCgxMDAgKiBuL3N1bShuKSwgMCkpJT4lCiAgaGNoYXJ0KCdjb2x1bW4nLAogICAgICAgICBoY2FlcyggeSA9ICdmcmVxJykpJT4lCiAgaGNfYWRkX3RoZW1lKGhjX3RoZW1lX2ZmeCgpKSU+JQogIGhjX3RpdGxlKAogICAgdGV4dCA9ICJQZXJjZXBjacOzbiBkZSBtb3ZpbGlkYWQgcmVnaW9uIDEiCiAgKSAlPiUKICBoY19zdWJ0aXRsZSh0ZXh0ID0gIlBhcmEgZWwgY29sb3IgZGUgcGllbCBzZSByZXZpc2EgbGEgZXNjYWxhIikgJT4lCiAgIyBoY19jcmVkaXRzKAogICMgIGVuYWJsZWQgPSBUUlVFLCB0ZXh0ID0gIlNvdXJjZTogU1NTIiwKICAjICBzdHlsZSA9IGxpc3QoZm9udFNpemUgPSAiMTJweCIpKSU+JQogIGhjX3lBeGlzKHRpdGxlID0gbGlzdCh0ZXh0ID0gIlBvcmNlbnRhamUiKSklPiUKICBoY194QXhpcyh0aXRsZT1saXN0KHRleHQ9IlRpcG8gZGUgcGVyY2VwY2nDs24iKSwKICAgICAgICAgICBjYXRlZ29yaWVzID0gZ2V0X2xhYmVscyhwYWRyZXNfaCR2bykpICU+JQogICAgaGNfZXhwb3J0aW5nKGVuYWJsZWQgPSBUUlVFLAogICAgICAgICAgICAgICBmaWxlbmFtZSA9ICJkYXRvcyIsCiAgICAgICAgICAgICAgIGJ1dHRvbnMgPSBsaXN0KGNvbnRleHRCdXR0b24gPSBsaXN0KG1lbnVJdGVtcyA9IG15TWVudUl0ZW1zKSkpCmBgYAoKCgoKIyByZWN1cGVyYWRvYXMKCmBgYHtyfQojIHVuIHNvbG8gaW5ncmVzbywgZWwgamVmZSByZXNwb25kZQoKIyBwcmVndW50YSBwMiwgY29tcGFydGVuIGVsIG1pbXNvIGdhc3RvIHBhcmEgY29tZXI6IDEgKSBTaSAyICkgTm8KIyBwcmVndW50YSBwMDgsIGVzIGVsIGplZmUgZGVsIGhvZ2FyOiAxICkgU2kgCiMgcHJlZ3VudGEgcDEyLiBhY3R1YWxtZW50ZSBlc3R1ZGlhLCAxKVNpIDIpTm8KIyBwNjgsIFBlcnNvbmFzIHF1ZSB0cmFiYWphbiwgMS4gU2ksIDIuIE5vCmNhbWJpYXJfZXRpKCdwMTMzJyxlbmNvID0gIldpbmRvd3MtMTI1MiIpCgpkYXRhMV9lbW92aTIwMTcgPC0gIGRhdGFfZW1vdmkyMDE3ICU+JSAKICBmaWx0ZXIocDAyID09IDEpICAlPiUKICBmaWx0ZXIocDA4ID09IDEpICAlPiUgCiAgZmlsdGVyKHAxMiA9PSAyKSAgJT4lCiAgZmlsdGVyKHA2OCA9PSAxIHwgcDY5ID09IDEpICAlPiUKICBmaWx0ZXIocDEzMiA9PSAxKSAlPiUKICBmaWx0ZXIoIXAxMzMgJWluJSBjKDgsOSxOQSkgKSAlPiUKICBmaWx0ZXIocDEzNGEgIT0gOCkgJT4lCiAgZmlsdGVyKHAxMzRiICE9IDgpICU+JQogIGZpbHRlcihwMTM0YyAhPSA4KSAlPiUKICBmaWx0ZXIocDEzNGQgIT0gOCkgJT4lCiAgZmlsdGVyKHAxMzRlICE9IDgpICU+JQogIGZpbHRlcihwMTM0ZiAhPSA4KSAlPiUKICBmaWx0ZXIocDEzNGcgIT0gOCkgJT4lCiAgZmlsdGVyKHAxMzRoICE9IDgpICU+JQogIGZpbHRlcihwMTM0aSAhPSA4KSAKCgpwbG90YSA8LSBkYXRhMV9lbW92aTIwMTcgJT4lCiAgY291bnQoRXN0YWRvKSAlPiUKICBoY2hhcnQoJ3RyZWVtYXAnLAogICAgICAgICBoY2Flcyh4ID0gcGFzdGUoZ2V0X2xhYmVscyhFc3RhZG8pLCcgJywnKCcsIG4sJyknLCBzZXAgPSAnJyksIHZhbHVlPSduJywgY29sb3IgPSAnbicpKSAlPiUKICBoY19hZGRfdGhlbWUoaGNfdGhlbWVfZmZ4KCkpICU+JQogIGhjX3RpdGxlKAogICAgdGV4dCA9ICJOw7ptZXJvIGRlIGVudHJldmlzdGFkb3MgcG9yIGVzdGFkbyIKICApJT4lIAogIGhjX3N1YnRpdGxlKHRleHQgPSBwYXN0ZSgiVG90YWwgZGUgcGFydGljaXBhdGVzOiAiICwgdG9TdHJpbmcobnJvdyhkYXRhMV9lbW92aTIwMTcpKSkpICU+JQogIGhjX2V4cG9ydGluZyhlbmFibGVkID0gVFJVRSwKICAgICAgICAgICAgICAgZmlsZW5hbWUgPSAiYXJjaGl2byIsCiAgICAgICAgICAgICAgIHNvdXJjZVdpZHRoID0gIDEwMDAsCiAgICAgICAgICAgICAgIHNvdXJjZUhlaWdodCA9IDY0MCwKICAgICAgICAgICAgICAgc2NhbGUgPSAxMCwKICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgYnV0dG9ucyA9IGxpc3QoY29udGV4dEJ1dHRvbiA9IGxpc3QobWVudUl0ZW1zID0gbXlNZW51SXRlbXMpKQogICkKCgpwbG90YQoKZGF0YTFfZW1vdmkyMDE3ICU+JQogIGNvdW50KEVzdGFkbywgcDA2KSU+JSAKICBoY2hhcnQoJ2NvbHVtbicsCiAgICAgICAgIGhjYWVzKCB5ID0gJ24nLCAgZ3JvdXAgPSBhc19sYWJlbChwMDYpKSklPiUKICBoY19hZGRfdGhlbWUoaGNfdGhlbWVfZmZ4KCkpJT4lCiAgaGNfdGl0bGUoCiAgICB0ZXh0ID0gIk7Dum1lcm8gZGUgZW50cmV2aXN0YWRvcyBwb3IgZXN0YWRvIHkgc2V4byIKICApICU+JQogICNoY19zdWJ0aXRsZSh0ZXh0ID0gIkxhcyBlZGFkZXMgZXN0w6FuIGFncnVwYWRhcyBlbiBpbnRlcnZhbG9zIAogICAjICAgICAgICAgICBkZSAxMCBhw7FvcyAoZGEgY2xpYyBzb2JyZSBGIG8gTSkiKSAlPiUKICAjIGhjX2NyZWRpdHMoCiAgIyAgZW5hYmxlZCA9IFRSVUUsIHRleHQgPSAiU291cmNlOiBTU1MiLAogICMgIHN0eWxlID0gbGlzdChmb250U2l6ZSA9ICIxMnB4IikpJT4lCiAgaGNfeUF4aXModGl0bGUgPSBsaXN0KHRleHQgPSAiTsO6bWVybyBkZSBwYXJ0aWNpcGFudGVzIikpJT4lCiAgaGNfeEF4aXModGl0bGU9bGlzdCh0ZXh0PSJFc3RhZG9zIiksCiAgICAgICAgICAgY2F0ZWdvcmllcyA9IGdldF9sYWJlbHMoZGF0YTFfZW1vdmkyMDE3JEVzdGFkbykpICU+JQogICAgaGNfZXhwb3J0aW5nKGVuYWJsZWQgPSBUUlVFLAogICAgICAgICAgICAgICBmaWxlbmFtZSA9ICJkYXRvcyIsCiAgICAgICAgICAgICAgIGJ1dHRvbnMgPSBsaXN0KGNvbnRleHRCdXR0b24gPSBsaXN0KG1lbnVJdGVtcyA9IG15TWVudUl0ZW1zKSkpCgpkYXRhMV9lbW92aTIwMTcgJT4lCiAgY291bnQocDEzLHAwNiklPiUgCiAgaGNoYXJ0KCdjb2x1bW4nLAogICAgICAgICBoY2FlcyggeSA9ICduJywgIGdyb3VwID0gYXNfbGFiZWwocDA2KSkpJT4lCiAgaGNfYWRkX3RoZW1lKGhjX3RoZW1lX2ZmeCgpKSU+JQogIGhjX3RpdGxlKAogICAgdGV4dCA9ICJFc2NvbGFyaWRhZCBwb3IgIHNleG8iCiAgKSAlPiUKICAjaGNfc3VidGl0bGUodGV4dCA9ICJMYXMgZWRhZGVzIGVzdMOhbiBhZ3J1cGFkYXMgZW4gaW50ZXJ2YWxvcyAKICAgIyAgICAgICAgICAgZGUgMTAgYcOxb3MgKGRhIGNsaWMgc29icmUgRiBvIE0pIikgJT4lCiAgIyBoY19jcmVkaXRzKAogICMgIGVuYWJsZWQgPSBUUlVFLCB0ZXh0ID0gIlNvdXJjZTogU1NTIiwKICAjICBzdHlsZSA9IGxpc3QoZm9udFNpemUgPSAiMTJweCIpKSU+JQogIGhjX3lBeGlzKHRpdGxlID0gbGlzdCh0ZXh0ID0gIk7Dum1lcm8gZGUgcGFydGljaXBhbnRlcyIpKSU+JQogIGhjX3hBeGlzKHRpdGxlPWxpc3QodGV4dD0iRXNjb2xhcmlkYWQiKSwKICAgICAgICAgICBjYXRlZ29yaWVzID0gZ2V0X2xhYmVscyhkYXRhMV9lbW92aTIwMTckcDEzKSkgJT4lCiAgICBoY19leHBvcnRpbmcoZW5hYmxlZCA9IFRSVUUsCiAgICAgICAgICAgICAgIGZpbGVuYW1lID0gImRhdG9zIiwKICAgICAgICAgICAgICAgYnV0dG9ucyA9IGxpc3QoY29udGV4dEJ1dHRvbiA9IGxpc3QobWVudUl0ZW1zID0gbXlNZW51SXRlbXMpKSkKCmRhdGExX2Vtb3ZpMjAxNyAlPiUKICBjb3VudChwMTMzLHAwNiklPiUgCiAgaGNoYXJ0KCdjb2x1bW4nLAogICAgICAgICBoY2FlcyggeSA9ICduJywgIGdyb3VwID0gYXNfbGFiZWwocDA2KSkpJT4lCiAgaGNfYWRkX3RoZW1lKGhjX3RoZW1lX2ZmeCgpKSU+JQogIGhjX3RpdGxlKAogICAgdGV4dCA9ICJJbmdyZXNvIHBvciBzZXhvIHBvciAgc2V4byIKICApICU+JQogICNoY19zdWJ0aXRsZSh0ZXh0ID0gIkxhcyBlZGFkZXMgZXN0w6FuIGFncnVwYWRhcyBlbiBpbnRlcnZhbG9zIAogICAjICAgICAgICAgICBkZSAxMCBhw7FvcyAoZGEgY2xpYyBzb2JyZSBGIG8gTSkiKSAlPiUKICAjIGhjX2NyZWRpdHMoCiAgIyAgZW5hYmxlZCA9IFRSVUUsIHRleHQgPSAiU291cmNlOiBTU1MiLAogICMgIHN0eWxlID0gbGlzdChmb250U2l6ZSA9ICIxMnB4IikpJT4lCiAgaGNfeUF4aXModGl0bGUgPSBsaXN0KHRleHQgPSAiTsO6bWVybyBkZSBwYXJ0aWNpcGFudGVzIikpJT4lCiAgaGNfeEF4aXModGl0bGU9bGlzdCh0ZXh0PSJDYXRlaG9yaWEgZGUgaW5ncmVzbyIpLAogICAgICAgICAgIGNhdGVnb3JpZXMgPSBnZXRfbGFiZWxzKGRhdGExX2Vtb3ZpMjAxNyRwMTMzKSkgJT4lCiAgICBoY19leHBvcnRpbmcoZW5hYmxlZCA9IFRSVUUsCiAgICAgICAgICAgICAgIGZpbGVuYW1lID0gImRhdG9zIiwKICAgICAgICAgICAgICAgYnV0dG9ucyA9IGxpc3QoY29udGV4dEJ1dHRvbiA9IGxpc3QobWVudUl0ZW1zID0gbXlNZW51SXRlbXMpKSkKCmRhdGExX2Vtb3ZpMjAxNyAlPiUKICBjb3VudChwMTMzLHAxMyklPiUgCiAgaGNoYXJ0KCdjb2x1bW4nLAogICAgICAgICBoY2FlcyggeSA9ICduJywgIGdyb3VwID0gYXNfbGFiZWwocDEzKSkpJT4lCiAgaGNfYWRkX3RoZW1lKGhjX3RoZW1lX2ZmeCgpKSU+JQogIGhjX3RpdGxlKAogICAgdGV4dCA9ICJFZHVjYWNpw7NuIHBvciBjb2hvcnQgZGUgaW5ncmVzbyAoMSBzb2xvIGluZ3Jlc28pIgogICkgJT4lCiAgI2hjX3N1YnRpdGxlKHRleHQgPSAiTGFzIGVkYWRlcyBlc3TDoW4gYWdydXBhZGFzIGVuIGludGVydmFsb3MgCiAgICMgICAgICAgICAgIGRlIDEwIGHDsW9zIChkYSBjbGljIHNvYnJlIEYgbyBNKSIpICU+JQogICMgaGNfY3JlZGl0cygKICAjICBlbmFibGVkID0gVFJVRSwgdGV4dCA9ICJTb3VyY2U6IFNTUyIsCiAgIyAgc3R5bGUgPSBsaXN0KGZvbnRTaXplID0gIjEycHgiKSklPiUKICBoY195QXhpcyh0aXRsZSA9IGxpc3QodGV4dCA9ICJOw7ptZXJvIGRlIHBhcnRpY2lwYW50ZXMiKSklPiUKICBoY194QXhpcyh0aXRsZT1saXN0KHRleHQ9IkNhdGVnb3JpYSBkZSBpbmdyZXNvIiksCiAgICAgICAgICAgY2F0ZWdvcmllcyA9IGdldF9sYWJlbHMoZGF0YTFfZW1vdmkyMDE3JHAxMzMpKSAlPiUKICAgIGhjX2V4cG9ydGluZyhlbmFibGVkID0gVFJVRSwKICAgICAgICAgICAgICAgZmlsZW5hbWUgPSAiZGF0b3MiLAogICAgICAgICAgICAgICBidXR0b25zID0gbGlzdChjb250ZXh0QnV0dG9uID0gbGlzdChtZW51SXRlbXMgPSBteU1lbnVJdGVtcykpKQoKCgpkYXRhMV9lbW92aTIwMTcgJT4lCiAgY291bnQocDEzMyxwMTMxKSU+JSAKICBoY2hhcnQoJ2NvbHVtbicsCiAgICAgICAgIGhjYWVzKCB5ID0gJ24nLCAgZ3JvdXAgPSBhc19sYWJlbChwMTMxKSkpJT4lCiAgaGNfYWRkX3RoZW1lKGhjX3RoZW1lX2ZmeCgpKSU+JQogIGhjX3RpdGxlKAogICAgdGV4dCA9ICJDYXJyb3MgcG9yIGNvaG9ydCBkZSBpbmdyZXNvICgxIHNvbG8gaW5ncmVzbykiCiAgKSAlPiUKICAjaGNfc3VidGl0bGUodGV4dCA9ICJMYXMgZWRhZGVzIGVzdMOhbiBhZ3J1cGFkYXMgZW4gaW50ZXJ2YWxvcyAKICAgIyAgICAgICAgICAgZGUgMTAgYcOxb3MgKGRhIGNsaWMgc29icmUgRiBvIE0pIikgJT4lCiAgIyBoY19jcmVkaXRzKAogICMgIGVuYWJsZWQgPSBUUlVFLCB0ZXh0ID0gIlNvdXJjZTogU1NTIiwKICAjICBzdHlsZSA9IGxpc3QoZm9udFNpemUgPSAiMTJweCIpKSU+JQogIGhjX3lBeGlzKHRpdGxlID0gbGlzdCh0ZXh0ID0gIk7Dum1lcm8gZGUgcGFydGljaXBhbnRlcyIpKSU+JQogIGhjX3hBeGlzKHRpdGxlPWxpc3QodGV4dD0iQ2F0ZWdvcmlhIGRlIGluZ3Jlc28iKSwKICAgICAgICAgICBjYXRlZ29yaWVzID0gZ2V0X2xhYmVscyhkYXRhMV9lbW92aTIwMTckcDEzMykpICU+JQogICAgaGNfZXhwb3J0aW5nKGVuYWJsZWQgPSBUUlVFLAogICAgICAgICAgICAgICBmaWxlbmFtZSA9ICJkYXRvcyIsCiAgICAgICAgICAgICAgIGJ1dHRvbnMgPSBsaXN0KGNvbnRleHRCdXR0b24gPSBsaXN0KG1lbnVJdGVtcyA9IG15TWVudUl0ZW1zKSkpCgoKZGF0YTFfZW1vdmkyMDE3ICU+JQogIGNvdW50KHAxMzMscDEyMiklPiUgCiAgaGNoYXJ0KCdjb2x1bW4nLAogICAgICAgICBoY2FlcyggeSA9ICduJywgIGdyb3VwID0gYXNfbGFiZWwocDEyMikpKSU+JQogIGhjX2FkZF90aGVtZShoY190aGVtZV9mZngoKSklPiUKICBoY190aXRsZSgKICAgIHRleHQgPSAiQ3VhcnRvcyBwb3IgY29ob3J0IGRlIGluZ3Jlc28gKDEgc29sbyBpbmdyZXNvKSIKICApICU+JQogICNoY19zdWJ0aXRsZSh0ZXh0ID0gIkxhcyBlZGFkZXMgZXN0w6FuIGFncnVwYWRhcyBlbiBpbnRlcnZhbG9zIAogICAjICAgICAgICAgICBkZSAxMCBhw7FvcyAoZGEgY2xpYyBzb2JyZSBGIG8gTSkiKSAlPiUKICAjIGhjX2NyZWRpdHMoCiAgIyAgZW5hYmxlZCA9IFRSVUUsIHRleHQgPSAiU291cmNlOiBTU1MiLAogICMgIHN0eWxlID0gbGlzdChmb250U2l6ZSA9ICIxMnB4IikpJT4lCiAgaGNfeUF4aXModGl0bGUgPSBsaXN0KHRleHQgPSAiTsO6bWVybyBkZSBwYXJ0aWNpcGFudGVzIikpJT4lCiAgaGNfeEF4aXModGl0bGU9bGlzdCh0ZXh0PSJDYXRlZ29yaWEgZGUgaW5ncmVzbyIpLAogICAgICAgICAgIGNhdGVnb3JpZXMgPSBnZXRfbGFiZWxzKGRhdGExX2Vtb3ZpMjAxNyRwMTMzKSkgJT4lCiAgICBoY19leHBvcnRpbmcoZW5hYmxlZCA9IFRSVUUsCiAgICAgICAgICAgICAgIGZpbGVuYW1lID0gImRhdG9zIiwKICAgICAgICAgICAgICAgYnV0dG9ucyA9IGxpc3QoY29udGV4dEJ1dHRvbiA9IGxpc3QobWVudUl0ZW1zID0gbXlNZW51SXRlbXMpKSkKCgoKYGBgCgoKCgoKIyBFU1JVLUVNT1ZJIDIwMTEKCjxkaXYgaWQgPSAianVzdGlmaWNhciI+CkxhIEVTUlUg4oCTIEVNT1ZJIDIwMTEgc2UgZGlzZcOxw7MgcGFyYSBjb250aW51YXIgZWwgZXN0dWRpbyBuYWNpb25hbCBzb2JyZSBsYSBtb3ZpbGlkYWQgc29jaWFsIGluaWNpYWRvIGVuIDIwMDYuIFBhcmEgZXN0YSBvY2FzacOzbiwgc2UgcmVhbGl6YXJvbiAxMSwwMDEgZW50cmV2aXN0YXMgZWZlY3RpdmFzIGNvbiBpbmZvcm1hY2nDs24gcmVwcmVzZW50YXRpdmEgYSBuaXZlbCBuYWNpb25hbCBkZSBob21icmVzIHkgbXVqZXJlcyBlbnRyZSAyNSB5IDY0IGHDsW9zIGRlIGVkYWQsIHBvciB0aXBvIGRlIGplZmF0dXJhIGRlbCBob2dhciB5IGRlIMOhbWJpdG9zIHVyYmFubyB5IG5vIHVyYmFuby4gTG9zIHByaW5jaXBhbGVzIG9iamV0aXZvcyBkZSBsYSBFU1JVIOKAkyBFTU9WSSAyMDExIHNvbjoKCmEpIENvbm9jZXIgZWwgZ3JhZG8gZGUgYXNvY2lhY2nDs24gZW50cmUgbG9zIHJlY3Vyc29zIGRlIGxvcyBwYWRyZXMgeSBlbCBsb2dybyBzb2Npb2Vjb27Ds21pY28gZGUgbG9zIGhpam9zLgphKSBJZGVudGlmaWNhciBsYXMgYmFycmVyYXMgcXVlIGxpbWl0YW4gbGEgcG9zaWJpbGlkYWQgZGUgcXVlIGxhcyBwZXJzb25hcyBleHBlcmltZW50ZW4gbW92aWxpZGFkIHNvY2lhbC4KCkVuY3Vlc3RhIGRpcmlnaWRhIHBvciBlbCBQcm9ncmFtYSBkZSBNb3ZpbGlkYWQgU29jaWFsIGRlbCBDRUVZIHkgZmluYW5jaWFkYSBwb3IgbGEgRnVuZGFjacOzbiBFU1JVLgoKCjwvZGl2PgoKCiMgRVNSVS1FTU9WSSAyMDA2Cgo8ZGl2IGlkID0gImp1c3RpZmljYXIiPgpMYSBFU1JVIOKAkyBFTU9WSSAyMDA2IGVzIHVuYSBkZSBsYXMgcHJpbWVyYXMgZW5jdWVzdGFzIGRlIGNvYmVydHVyYSBuYWNpb25hbCBkaXNlw7FhZGEgY29uIGVsIG9iamV0aXZvIGRlIG1lZGlyIGxhIG1vdmlsaWRhZCBzb2NpYWwgZW4gTcOpeGljby4gTGEgZW5jdWVzdGEgZXMgdW4gY29ydGUgdHJhbnN2ZXJzYWwgcXVlIGluY2x1eWUgcHJlZ3VudGFzIHJldHJvc3BlY3RpdmFzIHNvYnJlIGxhIHNpdHVhY2nDs24gc29jaW9lY29uw7NtaWNhIGRlIGxvcyBwYWRyZXMgZGVsIGVudHJldmlzdGFkbyBjb24gZWwgb2JqZXRpdm8gZGUgb2JzZXJ2YXIgbGEgaW5mbHVlbmNpYSBxdWUgdGllbmVuIGxvcyByZWN1cnNvcyBkZSBsb3MgcGFkcmVzIGVuIGxhIHBvc2ljacOzbiBzb2Npb2Vjb27Ds21pY2EgZGUgc3VzIGhpam9zLgoKUGFyYSBlc3RlIGxldmFudGFtaWVudG8gc2UgcmVhbGl6YXJvbiA3LDI4OCBlbnRyZXZpc3RhcyBlZmVjdGl2YXMgY29uIGluZm9ybWFjacOzbiByZXByZXNlbnRhdGl2YSBhIG5pdmVsIG5hY2lvbmFsIGRlIGhvbWJyZXMsIGplZmVzIGRlIGhvZ2FyLCBlbnRyZSAyNSB5IDY0IGHDsW9zIGRlIGVkYWQuCgpFbmN1ZXN0YSBkaXJpZ2lkYSBwb3IgRmxvcmVuY2lhIFRvcmNoZSB5IGZpbmFuY2lhZGEgcG9yIGxhIEZ1bmRhY2nDs24gRVNSVS4KCjwvZGl2PgoKCgo=</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("ESRU2017.Rmd");
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
