<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Rafael Martínez Martínez" />


<title>Estiamcion</title>

<script src="site_libs/header-attrs-2.5/header-attrs.js"></script>
<script src="site_libs/jquery-3.5.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="site_libs/htmlwidgets-1.5.3.9000/htmlwidgets.js"></script>
<script src="site_libs/proj4js-2.3.15/proj4.js"></script>
<link href="site_libs/highcharts-8.1.2/css/motion.css" rel="stylesheet" />
<script src="site_libs/highcharts-8.1.2/highcharts.js"></script>
<script src="site_libs/highcharts-8.1.2/highcharts-3d.js"></script>
<script src="site_libs/highcharts-8.1.2/highcharts-more.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/stock.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/map.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/annotations.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/data.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/drilldown.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/item-series.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/offline-exporting.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/overlapping-datalabels.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/exporting.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/export-data.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/funnel.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/heatmap.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/treemap.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/sankey.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/dependency-wheel.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/organization.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/solid-gauge.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/streamgraph.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/sunburst.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/vector.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/wordcloud.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/xrange.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/tilemap.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/venn.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/gantt.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/timeline.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/parallel-coordinates.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/bullet.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/coloraxis.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/dumbbell.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/lollipop.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/series-label.js"></script>
<script src="site_libs/highcharts-8.1.2/plugins/motion.js"></script>
<script src="site_libs/highcharts-8.1.2/custom/reset.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/boost.js"></script>
<script src="site_libs/highchart-binding-0.8.2/highchart.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<link rel="stylesheet" href="estilo.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Tesina CIDE-ME Rafael Martínez-Martínez</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Estimacion.html">Estimación</a>
</li>
<li>
  <a href="ESRU2017.html">Datos ESRU - EMOVI 2017</a>
</li>
<li>
  <a href="MMSI2016.html">Datos MMSI 2016</a>
</li>
<li>
  <a href="ENIGH2016.html">Datos ENIGH 2016</a>
</li>
<li>
  <a href="hijos.html">Ingreso Hijos </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Estiamcion</h1>
<h4 class="author">Rafael Martínez Martínez</h4>

</div>


<pre class="r"><code>library(tidyverse)
library(haven) # importa, entre otros software, de Stata
library(sjlabelled) # manejar labels de las variables 
library(openxlsx) # leer archivos de excel
library(DT) # visualizar a tablas
library(data.table) # convertir a tablas
library(highcharter) # gráficas interactivas
library(foreign)</code></pre>
<div id="funciones-de-carga" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Funciones de carga</h1>
<pre class="r"><code>cargar_esru&lt;- function(){

return(read_stata(
                     path = &quot;Datos/ESRU-EMOVI-2017/ESRU-EMOVI-2017-Entrevistado.dta&quot;,
                     atomic.to.fac = TRUE,
                     enc = NULL,
                     ))
}</code></pre>
<pre class="r"><code>cargar_enigh&lt;- function(docu){

return(read_stata(
                     path = paste(&quot;Datos/ENIGH-2016/&quot;,docu,&quot;.dta&quot;,sep=&quot;&quot;),
                     atomic.to.fac = TRUE,
                     enc = NULL,
                     ))
}

cargar_enigh_sav&lt;- function(docu){

return(read_spss(
                     path = paste(&quot;Datos/ENIGH-2016/&quot;,docu,&quot;.sav&quot;,sep=&quot;&quot;),
                     atomic.to.fac = TRUE,
                     enc = NULL,
                     ))
}</code></pre>
</div>
<div id="filtrar-hijos-esru" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Filtrar hijos ESRU</h1>
<div id="creamos-per-movilidad" class="section level2" number="2.1">
<h2 number="2.1"><span class="header-section-number">2.1</span> Creamos per movilidad</h2>
<pre class="r"><code>data_emovi2017&lt;-cargar_esru()

data_emovi2017&lt;-data_emovi2017%&gt;%
  mutate(mov = ifelse(p147&gt;p148,&quot;mejor&quot;,
                      ifelse(p147&lt;p148,&quot;peor&quot;,&quot;igual&quot;)),
         id_ho = as.integer(row.names(data_emovi2017)))
data_emovi2017$mov&lt;-set_labels(
                          data_emovi2017$mov,
                          labels = c(&quot;mejor&quot; = &quot;mejor&quot;,
                                     &quot;peor&quot; = &quot;peor&quot;,
                                     &quot;igual&quot; = &quot;igual&quot;))</code></pre>
</div>
<div id="cramos-cohort" class="section level2" number="2.2">
<h2 number="2.2"><span class="header-section-number">2.2</span> Cramos cohort</h2>
</div>
<div id="seleccion-de-hijos" class="section level2" number="2.3">
<h2 number="2.3"><span class="header-section-number">2.3</span> seleccion de hijos</h2>
<p>Criterios de filtrado - pregunta p2, comparten el mimso gasto para comer: 1 ) Si 2 ) No - pregunta 5 Edades entre 25 y 45 años - pregunta p08, es el jefe del hogar: 1 ) jefe 2) cónyuge NO IMPLEMENTADO - pregunta p12, actualmente estudia, 1)Si 2)No - p26 Había un jefe de hogar en la infancia (1 padre 2 madre) - p43 y p43m Reporta educación del padre o madre priciapl - p68, Personas que trabajan, 1. Si, 2. No - p69 si trabaja pero la semana pasada no - p132 numero de personas que aportan ingreso - p133 cohort de todas las personas y todos los ingresos (1 ingreso)</p>
<p>Variables de selección para estimar ingreso</p>
<ul>
<li><p>Estado</p></li>
<li><p>pregunta 5, edad</p></li>
<li><p>pregunta 6, sexo</p></li>
<li><p>Pregunta 13, nivel de escuela</p></li>
<li><p>p76 ocupación –SINCO3 codificación ocupación entrevistado</p></li>
<li><p>p133 cohort de todas las personas y todos los ingresos</p></li>
</ul>
<pre class="r"><code># pensamos que los datos se leeen como factores cando corresponda, si se leen como enteros no debe hacerse el casting
#data_emovi2017&lt;-datos_e
hijos &lt;- data_emovi2017 %&gt;%
  filter(p02 == 1)  %&gt;% #compartir gasot para comer
  filter(between(p05,25,40)) %&gt;% # edad
  #filter(p08 == 1)  %&gt;% 
  filter(p12 == 2)  %&gt;% # ya no estudia
  filter(p26 == 1 | p26==2 ) %&gt;% # sosten principal papa, mama, 
   filter((!is.na(p43) &amp; p43!=98 &amp; p26 == 1 ) |
            (!is.na(p43m) &amp; p43m!=98  &amp; p26 == 2 )) %&gt;% # reporta educación de pp
   filter(!is.na(p13))%&gt;% #  reporta educación
  filter(SINCO3 !=&quot;&quot;) %&gt;%# reporta oficio actual
   filter(p68 == 1 | p69 == 1)  %&gt;% # si trabaja
   filter(p132 %in% c(1)) %&gt;%# persona que aportan ingreso
  filter(!p133 %in% c(8,9,NA) ) # reporta ingresos
                                # no estan los ingresos  hogar aislados. 

#edad_promedio_padres &lt;- mean(hijos$p38_11, na.rm = TRUE)
#edad_promedio_padres-21

str(hijos$p02)</code></pre>
<pre><code>##  Factor w/ 2 levels &quot;1&quot;,&quot;2&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  - attr(*, &quot;labels&quot;)= Named num [1:2] 1 2
##   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;SÃ­&quot; &quot;No&quot;
##  - attr(*, &quot;label&quot;)= chr &quot;p02 Personas en vivienda comparten un mismo gasto para comer&quot;</code></pre>
<pre class="r"><code>unique(hijos$p43)</code></pre>
<pre><code>##  [1] 11   2    6    &lt;NA&gt; 98   4    3    8    5    7    10   12   9    1   
## Levels: 1 2 3 4 5 6 7 8 9 10 11 12 98</code></pre>
</div>
<div id="hijos-seleccionados" class="section level2" number="2.4">
<h2 number="2.4"><span class="header-section-number">2.4</span> hijos seleccionados</h2>
<p>Hacemos un cohort del 1 y el 2</p>
<pre class="r"><code>var&lt;-c(&quot;Estado&quot;,&quot;p05&quot;,&quot;p06&quot;,&quot;p13&quot;,&quot;SINCO3&quot;,&quot;p133&quot;,&quot;mov&quot;,&quot;id_ho&quot;,&quot;region&quot;)
hijos_para_sal&lt;-hijos%&gt;%
  select(var)%&gt;%
  mutate(p133 = ifelse(p133==1,2,p133)-1)# juntamos el cohort 1 y 2 

hijos_para_sal &lt;- hijos_para_sal%&gt;%
            mutate(estrato = ifelse(p133 %in% c(1,2),1,
                                    ifelse(p133 %in% c(3),2,
                                           ifelse(p133 %in% c(4,5),3,4))))


#sum(hijos_para_sal$p133==1)

nrow(hijos_para_sal)</code></pre>
<pre><code>## [1] 1131</code></pre>
<pre class="r"><code>saveRDS(hijos_para_sal, file=&quot;Datos/hijos_emovi2017.Rda&quot;)</code></pre>
</div>
</div>
<div id="hijos-construcción-ingresos" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Hijos construcción ingresos</h1>
<pre class="r"><code>poblacion_e16&lt;-cargar_enigh_sav(&quot;poblacion&quot;) 
trabajos_e16&lt;-cargar_enigh_sav(&quot;trabajos&quot;)
ingresos_e16&lt;-cargar_enigh_sav(&quot;ingresos&quot;)</code></pre>
<div id="poblacion-enigh-16" class="section level2" number="3.1">
<h2 number="3.1"><span class="header-section-number">3.1</span> poblacion enigh 16</h2>
<pre class="r"><code>poblacion_e16f&lt;- poblacion_e16%&gt;%
  #filter(asis_esc == &quot;2&quot;)%&gt;% # ya no asiste a la escuela
  select(folioviv,foliohog,numren,sexo,edad,nivelaprob)%&gt;%
  filter(between(as.integer(edad),25,40))
# no filtramos por jefe de hogar

nrow(poblacion_e16f)</code></pre>
<pre><code>## [1] 58884</code></pre>
<pre class="r"><code>sum(is.na(poblacion_e16f))</code></pre>
<pre><code>## [1] 0</code></pre>
</div>
<div id="trabajos-enigh-16" class="section level2" number="3.2">
<h2 number="3.2"><span class="header-section-number">3.2</span> trabajos enigh 16</h2>
<p>Filtrams los trabajos</p>
<pre class="r"><code>trabajos_e16f&lt;-trabajos_e16%&gt;%
select(folioviv,foliohog,numren)#%&gt;%
 # filter(!is.na(sinco))
NROW(trabajos_e16f)</code></pre>
<pre><code>## [1] 132095</code></pre>
<pre class="r"><code>#NROW(trabajos)
sum(is.na(trabajos_e16f))</code></pre>
<pre><code>## [1] 0</code></pre>
</div>
<div id="ingresos-enigh-2016" class="section level2" number="3.3">
<h2 number="3.3"><span class="header-section-number">3.3</span> Ingresos enigh 2016</h2>
<pre class="r"><code>familias_integrantes_e16 &lt;- function(df,folhog,nr){
  dfn &lt;- df %&gt;%
    filter(foliohog %in% folhog)%&gt;%
    filter(numren %in% nr)
  return(dfn)
} 



ingresos_acu_e16 &lt;- function(df,clavs=get_labels(ingresos_e16$clave)){
 dfn &lt;- df %&gt;%
   group_by(folioviv, foliohog, numren) %&gt;%
   filter(clave %in% clavs)%&gt;%
   summarise(
   claves_a = paste(clave,collapse = &quot;,&quot;),
  ing_tri_t = sum(ing_tri),
  ing_men_p = ing_tri_t/3
  ) %&gt;% ungroup()
 
 
 return(dfn)
}

hogares &lt;- c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;)
personas_h &lt;- c(&#39;01&#39;,&#39;02&#39;,&#39;03&#39;,&#39;04&#39;,&#39;05&#39;)

a&lt;-familias_integrantes_e16(ingresos_e16,hogares,personas_h)
head(a)</code></pre>
<pre><code>##     folioviv foliohog numren clave mes_1 mes_2 mes_3 mes_4 mes_5 mes_6 ing_1
## 1 0100003801        1     02  P009                                      7500
## 2 0100003801        1     01  P001    09    08    07    06    05    04 18000
## 3 0100003801        1     02  P001    09    08    07    06    05    04 15000
## 4 0100003801        1     01  P009                                      6000
## 5 0100003802        1     02  P040    10    09    08    07    06    05     0
## 6 0100003802        1     02  P009                                     19000
##   ing_2 ing_3 ing_4 ing_5 ing_6  ing_tri
## 1    NA    NA    NA    NA    NA  1844.26
## 2 18000 18000 18000 18000 18000 53114.75
## 3 15000 15000 15000 15000 15000 44262.29
## 4    NA    NA    NA    NA    NA  1475.40
## 5     0     0     0  5000     0  2459.01
## 6    NA    NA    NA    NA    NA  4672.13</code></pre>
<pre class="r"><code>claves&lt;-c(&quot;P001&quot;,&quot;P002&quot;,&quot;P003&quot;,&quot;P011&quot;,&quot;P023&quot;,&quot;P024&quot;,&quot;P054&quot;,&quot;P055&quot;,&quot;P056&quot;, &quot;P059&quot;,&quot;P060&quot;,&quot;P061&quot;,&quot;P063&quot;,&quot;P068&quot;,&quot;P060&quot;,&quot;P070&quot;,&quot;P071&quot;,&quot;P072&quot;,&quot;P073&quot;,&quot;P074&quot;,&quot;P075&quot;,&quot;P076&quot;,&quot;P077&quot;,&quot;P078&quot;,&quot;P079&quot;,&quot;P080&quot;)
ingresos_e16a&lt;-ingresos_acu_e16(a,claves) 
ingresos_e16a</code></pre>
<pre><code>## # A tibble: 104,236 x 6
##    folioviv   foliohog numren claves_a  ing_tri_t ing_men_p
##    &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;         &lt;dbl&gt;     &lt;dbl&gt;
##  1 0100003801 1        01     P001         53115.    17705.
##  2 0100003801 1        02     P001         44262.    14754.
##  3 0100003802 1        01     P001         47213.    15738.
##  4 0100003802 1        02     P001         44262.    14754.
##  5 0100003803 1        01     P001         82623.    27541.
##  6 0100003804 1        01     P001         29508.     9836.
##  7 0100003804 1        02     P001          3934.     1311.
##  8 0100003805 1        01     P001         35410.    11803.
##  9 0100010401 1        03     P063,P001     8560.     2853.
## 10 0100010401 1        04     P001         20837.     6946.
## # … with 104,226 more rows</code></pre>
</div>
<div id="base-cruzada-pob-tra" class="section level2" number="3.4">
<h2 number="3.4"><span class="header-section-number">3.4</span> Base cruzada pob-tra</h2>
<pre class="r"><code>enigh_16&lt;- full_join(poblacion_e16f,trabajos_e16f)%&gt;%
   drop_na()
#enigh&lt;-full_join(enigh,concentrado)%&gt;%
 # drop_na()
nrow(enigh_16)</code></pre>
<pre><code>## [1] 63108</code></pre>
<pre class="r"><code>sum(is.na(enigh_16))</code></pre>
<pre><code>## [1] 0</code></pre>
</div>
<div id="cambio-etiquetado" class="section level2" number="3.5">
<h2 number="3.5"><span class="header-section-number">3.5</span> Cambio etiquetado</h2>
<p>Pasamos las etiqeuteas de educación de emovi a</p>
<pre class="r"><code>hijos_emovi &lt;- readRDS(file=&quot;Datos/hijos_emovi2017.Rda&quot;)
hijos_emovi&lt;- hijos_emovi %&gt;%
  mutate(p13_m = ifelse(p13 %in% c(1),&quot;1&quot;,
                      ifelse( p13 == 2,&quot;2&quot;,
                      ifelse(p13 %in% c(3,4),&quot;3&quot;,
                      ifelse( p13 %in% c(5,6),&quot;4&quot;,
                      ifelse(p13 %in% c(7,8),&quot;6&quot;,
                      ifelse(p13 %in% c(9,10),&quot;5&quot;,
                      ifelse(p13==11,&quot;7&quot;,
                      ifelse(p13==12,&quot;8&quot;,&quot;0&quot;)))))))))
unique(hijos_emovi$p13_m)</code></pre>
<pre><code>## [1] &quot;4&quot; &quot;3&quot; &quot;7&quot; &quot;2&quot; &quot;5&quot; &quot;6&quot; &quot;8&quot; &quot;0&quot;</code></pre>
<pre class="r"><code>enigh_16&lt;-enigh_16%&gt;%
  mutate(nivelaprob=ifelse(nivelaprob==&quot;9&quot;,&quot;8&quot;,nivelaprob))

enigh_16f&lt;-enigh_16%&gt;%
  filter(nivelaprob %in% unique(hijos_emovi$p13_m))

nrow(enigh_16f)</code></pre>
<pre><code>## [1] 63057</code></pre>
</div>
<div id="buscar-folios-con-caracteristicas" class="section level2" number="3.6">
<h2 number="3.6"><span class="header-section-number">3.6</span> Buscar folios con caracteristicas</h2>
<pre class="r"><code>busca&lt;-function(i){
return(enigh_16f%&gt;%
  filter(
    as.integer(substr(folioviv,1,2))==hijos_emovi[i,]$Estado &amp;
    sexo == hijos_emovi[i,]$p06 &amp;
    edad == hijos_emovi[i,]$p05 &amp;
    #sinco == hijos_emovi[i,]$SINCO3 &amp;
    nivelaprob == hijos_emovi[i,]$p13_m)%&gt;%
  select(folioviv,foliohog))
}

  
a&lt;-lapply(1:nrow(hijos_emovi), busca)

contador&lt;-0
for(i in 1:nrow(hijos_emovi))
{if(nrow(a[[i]])&gt;0)
  contador&lt;-contador +1
}
contador</code></pre>
<pre><code>## [1] 1077</code></pre>
<pre class="r"><code>saveRDS(a, file=&quot;Datos/folhijos_enigh16_emovi.Rda&quot;)</code></pre>
<p>Del total, 1077 personas tienen gemelos</p>
<div id="filtamos-solo-los-hijos-encontrados" class="section level3" number="3.6.1">
<h3 number="3.6.1"><span class="header-section-number">3.6.1</span> filtamos solo los hijos encontrados</h3>
<pre class="r"><code># etiquetamos para no perder la numeracion respecto a los hijos originales
folhijos_e16_emovi &lt;- readRDS(file=&quot;Datos/folhijos_enigh16_emovi.Rda&quot;)
names(folhijos_e16_emovi) &lt;- as.character(1:nrow(hijos_emovi))
length(folhijos_e16_emovi)</code></pre>
<pre><code>## [1] 1131</code></pre>
<pre class="r"><code>L &lt;- c()
for(i in 1:length(folhijos_e16_emovi)){
  if(!(nrow(folhijos_e16_emovi[[i]])&gt;0)){
    L&lt;-c(L,i)}
}
# Solo hijos que se les pudo encontrar en enigh-2016 1077/1131
folhijos_e16_emovif&lt;-folhijos_e16_emovi[-L]
    

length(folhijos_e16_emovif)</code></pre>
<pre><code>## [1] 1077</code></pre>
<pre class="r"><code>#names(folhijos_emovif)
#names(folhijos_emovi)</code></pre>
</div>
<div id="unicos-folios-diferentes-trabajos" class="section level3" number="3.6.2">
<h3 number="3.6.2"><span class="header-section-number">3.6.2</span> Unicos folios, diferentes trabajos</h3>
<pre class="r"><code>unicos_folios&lt;-function(i){
folhijos_e16_emovif[[i]]%&gt;%
  distinct()
}

# filtramos unicos folios por diferentes trabajos de la misma persona
a&lt;-lapply(1:length(folhijos_e16_emovif), unicos_folios)
names(a)&lt;-names(folhijos_e16_emovif)
length(a)</code></pre>
<pre><code>## [1] 1077</code></pre>
<pre class="r"><code>folhijos_e16_emovif&lt;-a</code></pre>
</div>
<div id="observamos-las-edades-de-los-encontrados" class="section level3" number="3.6.3">
<h3 number="3.6.3"><span class="header-section-number">3.6.3</span> Observamos las edades de los encontrados</h3>
<pre class="r"><code>myMenuItems &lt;- c(&quot;downloadPNG&quot;, &quot;downloadJPEG&quot;, &quot;downloadPDF&quot;, &#39;downloadSVG&#39;, &#39;printChart&#39;)

hijos_emovi%&gt;%
  slice(as.integer(names(folhijos_e16_emovif)))%&gt;%
  select(p05)%&gt;%
  count(p05)%&gt;%
    hchart(&#39;column&#39;,
         hcaes( y = &#39;n&#39;))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;&quot;
  ) %&gt;%
  #hc_subtitle(text = &quot;Las edades están agrupadas en intervalos 
   #           de 10 años (da clic sobre F o M)&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Número de participantes&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Número de personas&quot;),
           categories = as.character(25:40)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))</code></pre>
<div id="htmlwidget-506cd6b892eb3f60273b" style="width:100%;height:500px;" class="highchart html-widget"></div>
<script type="application/json" data-for="htmlwidget-506cd6b892eb3f60273b">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":""},"yAxis":{"title":{"text":"Número de participantes"}},"credits":{"enabled":false},"exporting":{"enabled":true,"filename":"datos","buttons":{"contextButton":{"menuItems":["downloadPNG","downloadJPEG","downloadPDF","downloadSVG","printChart"]}}},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"showInLegend":false},"treemap":{"layoutAlgorithm":"squarified"},"scatter":{"marker":{"symbol":"circle"}}},"series":[{"group":"group","data":[{"p05":25,"n":94,"y":94},{"p05":26,"n":53,"y":53},{"p05":27,"n":69,"y":69},{"p05":28,"n":81,"y":81},{"p05":29,"n":56,"y":56},{"p05":30,"n":84,"y":84},{"p05":31,"n":57,"y":57},{"p05":32,"n":66,"y":66},{"p05":33,"n":47,"y":47},{"p05":34,"n":58,"y":58},{"p05":35,"n":94,"y":94},{"p05":36,"n":54,"y":54},{"p05":37,"n":62,"y":62},{"p05":38,"n":65,"y":65},{"p05":39,"n":58,"y":58},{"p05":40,"n":79,"y":79}],"type":"column"}],"xAxis":{"title":{"text":"Número de personas"},"categories":["25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40"]}},"theme":{"colors":["#00AACC","#FF4E00","#B90000","#5F9B0A","#CD6723"],"chart":{"backgroundColor":{"linearGradient":[0,0,0,150],"stops":[[0,"#CAE1F4"],[1,"#EEEEEE"]]},"style":{"fontFamily":"Open Sans"}},"title":{"align":"left"},"subtitle":{"align":"left"},"legend":{"align":"right","verticalAlign":"bottom"},"xAxis":{"gridLineWidth":1,"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"yAxis":{"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1}},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","drillUpText":"Back to {series.name}","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"thousandsSep":" ","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":"Open+Sans","debug":false},"evals":[],"jsHooks":[]}</script>
</div>
<div id="observamos-las-estados-de-los-encontrados" class="section level3" number="3.6.4">
<h3 number="3.6.4"><span class="header-section-number">3.6.4</span> Observamos las estados de los encontrados</h3>
<pre class="r"><code>hijos_emovi%&gt;%
  slice(as.integer(names(folhijos_e16_emovif)))%&gt;%
  count(Estado)%&gt;%
    hchart(&#39;column&#39;,
         hcaes( y = &#39;n&#39;))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;&quot;
  ) %&gt;%
  #hc_subtitle(text = &quot;Las edades están agrupadas en intervalos 
   #           de 10 años (da clic sobre F o M)&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Número de participantes&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Número de personas&quot;),
           categories = get_labels(hijos_emovi$Estado)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))</code></pre>
<div id="htmlwidget-8f08827a58847a9b4a4d" style="width:100%;height:500px;" class="highchart html-widget"></div>
<script type="application/json" data-for="htmlwidget-8f08827a58847a9b4a4d">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":""},"yAxis":{"title":{"text":"Número de participantes"}},"credits":{"enabled":false},"exporting":{"enabled":true,"filename":"datos","buttons":{"contextButton":{"menuItems":["downloadPNG","downloadJPEG","downloadPDF","downloadSVG","printChart"]}}},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"showInLegend":false},"treemap":{"layoutAlgorithm":"squarified"},"scatter":{"marker":{"symbol":"circle"}}},"series":[{"group":"group","data":[{"Estado":"1","n":30,"y":30},{"Estado":"2","n":12,"y":12},{"Estado":"3","n":50,"y":50},{"Estado":"4","n":30,"y":30},{"Estado":"5","n":30,"y":30},{"Estado":"6","n":26,"y":26},{"Estado":"7","n":39,"y":39},{"Estado":"8","n":38,"y":38},{"Estado":"9","n":253,"y":253},{"Estado":"10","n":27,"y":27},{"Estado":"11","n":31,"y":31},{"Estado":"12","n":15,"y":15},{"Estado":"13","n":27,"y":27},{"Estado":"14","n":34,"y":34},{"Estado":"15","n":24,"y":24},{"Estado":"16","n":26,"y":26},{"Estado":"17","n":20,"y":20},{"Estado":"18","n":20,"y":20},{"Estado":"19","n":47,"y":47},{"Estado":"20","n":20,"y":20},{"Estado":"21","n":12,"y":12},{"Estado":"22","n":13,"y":13},{"Estado":"23","n":23,"y":23},{"Estado":"24","n":33,"y":33},{"Estado":"25","n":22,"y":22},{"Estado":"26","n":31,"y":31},{"Estado":"27","n":21,"y":21},{"Estado":"28","n":40,"y":40},{"Estado":"29","n":10,"y":10},{"Estado":"30","n":18,"y":18},{"Estado":"31","n":23,"y":23},{"Estado":"32","n":32,"y":32}],"type":"column"}],"xAxis":{"title":{"text":"Número de personas"},"categories":["Aguascalientes","Baja California","Baja California Sur","Campeche","Coahuila de Zaragoza","Colima","Chiapas","Chihuahua","Distrito Federal","Durango","Guanajuato","Guerrero","Hidalgo","Jalisco","México","Michoacán de Ocampo","Morelos","Nayarit","Nuevo León","Oaxaca","Puebla","Querétaro","Quintana Roo","San Luis Potosí","Sinaloa","Sonora","Tabasco","Tamaulipas","Tlaxcala","Veracruz de Ignacio de la Llave","Yucatán","Zacatecas"]}},"theme":{"colors":["#00AACC","#FF4E00","#B90000","#5F9B0A","#CD6723"],"chart":{"backgroundColor":{"linearGradient":[0,0,0,150],"stops":[[0,"#CAE1F4"],[1,"#EEEEEE"]]},"style":{"fontFamily":"Open Sans"}},"title":{"align":"left"},"subtitle":{"align":"left"},"legend":{"align":"right","verticalAlign":"bottom"},"xAxis":{"gridLineWidth":1,"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"yAxis":{"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1}},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","drillUpText":"Back to {series.name}","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"thousandsSep":" ","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":"Open+Sans","debug":false},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="ingreso-hijo-enigh16-emovi" class="section level2" number="3.7">
<h2 number="3.7"><span class="header-section-number">3.7</span> Ingreso hijo enigh16-emovi</h2>
<pre class="r"><code>ingreso_hijo_e16_emovi&lt;-function(i){
  ingresos_e16a%&gt;%
  filter(folioviv %in% folhijos_e16_emovif[[i]]$folioviv &amp;
    foliohog %in% folhijos_e16_emovif[[i]]$foliohog)%&gt;%summarise(
     id_hijo = names(folhijos_e16_emovif[i]),
     id_ho = hijos_emovi[as.integer(names(folhijos_e16_emovif[i])),&quot;id_ho&quot;],
     mov= hijos_emovi[as.integer(names(folhijos_e16_emovif[i])),&quot;mov&quot;],
     regionh = hijos_emovi[as.integer(names(folhijos_e16_emovif[i])),&quot;region&quot;],
     edad = hijos_emovi[as.integer(names(folhijos_e16_emovif[i])),&quot;p05&quot;],
      ing_men_p_h =list(ing_men_p),
     cohort = hijos_emovi[as.integer(names(folhijos_e16_emovif[i])),&quot;p133&quot;],
    estrato = hijos_emovi[as.integer(names(folhijos_e16_emovif[i])),&quot;estrato&quot;],
    estado = hijos_emovi[as.integer(names(folhijos_e16_emovif[i])),&quot;Estado&quot;],
    sexo = hijos_emovi[as.integer(names(folhijos_e16_emovif[i])),&quot;p06&quot;]
     )
}
#273,332 son vacios
# ingreso hijo pero ualgunos no podrian estar por no tener registro de salario

a&lt;-lapply(1:length(folhijos_e16_emovif), ingreso_hijo_e16_emovi)
ingreso_hijog_e16_emovi&lt;-a
length(ingreso_hijog_e16_emovi)</code></pre>
<pre><code>## [1] 1077</code></pre>
<pre class="r"><code>ingreso_hijog_e16_emovi[[332]]</code></pre>
<pre><code>## # A tibble: 1 x 10
##   id_hijo id_ho mov   regionh  edad ing_men_p_h cohort estrato estado sexo 
##   &lt;chr&gt;   &lt;int&gt; &lt;chr&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;list&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;
## 1 355      5759 mejor 4          27 &lt;dbl [0]&gt;        1       1 9      2</code></pre>
<pre class="r"><code>x&lt;-ingreso_hijog_e16_emovi[[332]]$ing_men_p_h[1]
sum(ingreso_hijog_e16_emovi[[332]]$ing_men_p_h[[1]],na.rm = TRUE)</code></pre>
<pre><code>## [1] 0</code></pre>
</div>
<div id="filtramos-sobre-ingresos-encontrados" class="section level2" number="3.8">
<h2 number="3.8"><span class="header-section-number">3.8</span> Filtramos sobre ingresos encontrados</h2>
<pre class="r"><code>L &lt;- c()
for(i in 1:length(ingreso_hijog_e16_emovi)){
  if(sum(ingreso_hijog_e16_emovi[[i]]$ing_men_p_h[[1]],na.rm = TRUE)==0){
    L&lt;-c(L,i)}
}
length(L)</code></pre>
<pre><code>## [1] 2</code></pre>
<pre class="r"><code>ingreso_hijog_e16_emovi&lt;-ingreso_hijog_e16_emovi[-L]

length(ingreso_hijog_e16_emovi)</code></pre>
<pre><code>## [1] 1075</code></pre>
<pre class="r"><code>ingreso_hijog_e16_emovi[1]</code></pre>
<pre><code>## [[1]]
## # A tibble: 1 x 10
##   id_hijo id_ho mov   regionh  edad ing_men_p_h cohort estrato estado sexo 
##   &lt;chr&gt;   &lt;int&gt; &lt;chr&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;list&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;
## 1 1           7 peor  3          25 &lt;dbl [24]&gt;       3       2 1      1</code></pre>
<pre class="r"><code>ingreso_hijog_e16_emovi[2]</code></pre>
<pre><code>## [[1]]
## # A tibble: 1 x 10
##   id_hijo id_ho mov   regionh  edad ing_men_p_h cohort estrato estado sexo 
##   &lt;chr&gt;   &lt;int&gt; &lt;chr&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;list&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;
## 1 2          34 mejor 3          35 &lt;dbl [43]&gt;       1       1 1      1</code></pre>
<pre class="r"><code>ingreso_hijog_e16_emovif&lt;-bind_rows(ingreso_hijog_e16_emovi[1:length(ingreso_hijog_e16_emovi)])


nrow(ingreso_hijog_e16_emovif)</code></pre>
<pre><code>## [1] 1075</code></pre>
<pre class="r"><code>saveRDS(ingreso_hijog_e16_emovif, file=&quot;Datos/ingreso_hij_f_emovi.Rda&quot;)</code></pre>
</div>
</div>
<div id="hijos-con-ingreso" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Hijos con ingreso</h1>
<pre class="r"><code>hijos_emovi_hp &lt;- readRDS(file=&quot;Datos/ingreso_hij_f_emovi.Rda&quot;)

nrow(hijos_emovi_hp)</code></pre>
<pre><code>## [1] 1075</code></pre>
<pre class="r"><code>hijos_emovi_hp </code></pre>
<pre><code>## # A tibble: 1,075 x 10
##    id_hijo id_ho mov   regionh  edad ing_men_p_h cohort estrato estado sexo 
##    &lt;chr&gt;   &lt;int&gt; &lt;chr&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;list&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;
##  1 1           7 peor  3          25 &lt;dbl [24]&gt;       3       2 1      1    
##  2 2          34 mejor 3          35 &lt;dbl [43]&gt;       1       1 1      1    
##  3 3          66 peor  3          40 &lt;dbl [9]&gt;        2       1 1      2    
##  4 4          81 peor  3          28 &lt;dbl [18]&gt;       3       2 1      2    
##  5 5          97 mejor 3          37 &lt;dbl [24]&gt;       1       1 1      2    
##  6 6         104 mejor 3          29 &lt;dbl [30]&gt;       2       1 1      2    
##  7 7         115 mejor 3          35 &lt;dbl [14]&gt;       2       1 1      2    
##  8 8         122 igual 3          30 &lt;dbl [74]&gt;       1       1 1      1    
##  9 9         152 igual 3          40 &lt;dbl [9]&gt;        3       2 1      1    
## 10 10        160 mejor 3          36 &lt;dbl [16]&gt;       3       2 1      1    
## # … with 1,065 more rows</code></pre>
<pre class="r"><code># p05 edad act
# p06 sexo act
# p13 educ hijo
# SINCO3, ocupación hijo
# p23 en qeu estado vivia a los 14
# p26 principal sosten ecómico
# p38_11 edad padre 2016
# p38m_11 edad madre 2016
# p43 nivel educativo padre
#p43m nivel educativo madre
# cmo1_2 ocupacion del padre
# cmo2_2 ocupacion de la madre 


varp&lt;-c(&quot;Estado&quot;,&quot;p05&quot;,&quot;p06&quot;,&quot;p13&quot;,&quot;SINCO3&quot;,&quot;p23&quot;,&quot;p26&quot;,&quot;p38_11&quot;,&quot;p38m_11&quot;,&quot;p43&quot;,&quot;p44&quot;,
        &quot;p43m&quot;,&quot;p44m&quot;,&quot;cmo1_2&quot;,&quot;cmo2_2&quot;,&quot;mov&quot;,
        &quot;region&quot;,&quot;p133&quot;)
padres_h&lt;-data_emovi2017%&gt;%
    filter(p02 == 1)  %&gt;% #compartir gasot para comer
  filter(between(p05,25,40)) %&gt;% # edad
  #filter(p08 == 1)  %&gt;% 
  filter(p12 == 2)  %&gt;%# ya no estudia
  filter(p26 == 1 | p26==2 ) %&gt;% # sosten principal papa, mama, 
   filter((!is.na(p43) &amp; p43!=98 &amp; p26 == 1 )|
            (!is.na(p43m) &amp; p43m!=98  &amp; p26 == 2 )) %&gt;% # reporta educación de pp
   filter(!is.na(p13))%&gt;% #  reporta educación
  filter(SINCO3 !=&quot;&quot;) %&gt;%# reporta oficio actual
   filter(p68 == 1 | p69 == 1)  %&gt;% # si trabaja
   filter(p132 %in% c(1)) %&gt;%# persona que aportan ingreso
  filter(!p133 %in% c(8,9,NA) )%&gt;%
  select(varp)%&gt;%
  slice(as.integer(unlist(hijos_emovi_hp%&gt;%select(id_hijo))))%&gt;%
  mutate(
         pp_id_hijo = hijos_emovi_hp%&gt;%pull(id_hijo),
         ing_h = hijos_emovi_hp%&gt;%pull(ing_men_p_h),
         cohort = ifelse(p133==1,2,p133)-1
         )%&gt;%
  rename(
          edad_h = p05,
          sexo_h = p06,
          edu_h = p13,
          ocu_h = SINCO3,
          pp_estado = p23,
          pp = p26,
          p_edad_2016= p38_11,
          m_edad_2016 = p38m_11,
          p_edu = p43,
          p_edug = p44,
          m_edu = p43m,
          m_edug = p44m,
          p_ocu = cmo1_2,
          m_ocu = cmo2_2
         )%&gt;%
  mutate(
        p_edu = as.integer(p_edu),
        m_edu = as.integer(m_edu)
  )
  
 
# las ocupaciones no encontradas las sustituimos por un NA
padres_h&lt;-padres_h%&gt;%
  mutate(p_ocu = ifelse(p_ocu==&quot;.&quot;,NA,p_ocu),
         m_ocu = ifelse(m_ocu==&quot;.&quot;,NA,m_ocu))

unique(padres_h$p_ocu)</code></pre>
<pre><code>##  [1] &quot;21&quot; &quot;52&quot; &quot;61&quot; NA   &quot;71&quot; &quot;55&quot; &quot;12&quot; &quot;41&quot; &quot;53&quot; &quot;81&quot; &quot;11&quot; &quot;51&quot; &quot;62&quot; &quot;14&quot; &quot;82&quot;
## [16] &quot;83&quot; &quot;54&quot; &quot;99&quot; &quot;13&quot; &quot;72&quot;</code></pre>
<pre class="r"><code>unique(padres_h$m_ocu)</code></pre>
<pre><code>##  [1] &quot;71&quot; NA   &quot;82&quot; &quot;13&quot; &quot;55&quot; &quot;41&quot; &quot;62&quot; &quot;72&quot; &quot;52&quot; &quot;81&quot; &quot;51&quot; &quot;11&quot; &quot;54&quot; &quot;12&quot; &quot;83&quot;
## [16] &quot;61&quot; &quot;14&quot; &quot;53&quot;</code></pre>
<pre class="r"><code>head(padres_h)</code></pre>
<pre><code>##   Estado edad_h sexo_h edu_h ocu_h pp_estado pp p_edad_2016 m_edad_2016 p_edu
## 1      1     25      1     6  2815         1  1          51          53    11
## 2      1     35      1     4  7121         1  1          72          73     2
## 3      1     40      2     6  3211         1  1          71          68     6
## 4      1     28      2    11  4111         1  2          NA          65    NA
## 5      1     37      2     2  5111         1  1          82          72     2
## 6      1     29      2     5  4111         1  2          53          48    13
##   p_edug m_edu m_edug p_ocu m_ocu   mov region p133 pp_id_hijo
## 1      5    11      5    21    71  peor      3    4          1
## 2      3    NA     NA    52  &lt;NA&gt; mejor      3    1          2
## 3      3     6      3    61  &lt;NA&gt;  peor      3    3          3
## 4     NA     2      6  &lt;NA&gt;    82  peor      3    4          4
## 5      4     2      2    71  &lt;NA&gt; mejor      3    2          5
## 6     NA    11      4    55    13 mejor      3    3          6
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ing_h
## 1                                                                                                                                                                                                                                                                                               14673.9100, 4891.3033, 113.3133, 978.2600, 1856.3533, 196.7200, 2360.6533, 12652.1700, 1858.6933, 3391.3033, 7630.4333, 2119.5633, 983.6033, 1967.2100, 2754.0967, 3878.4500, 12082.8700, 6725.9633, 1723.7567, 3815.2167, 847.8233, 5086.9533, 1834.2367, 1695.6500
## 2 4309.390000, 3662.983333, 521.736667, 6281.963333, 9606.553333, 3.276667, 8217.390000, 4695.650000, 3913.043333, 7081.966667, 1515.080000, 5901.636667, 983.603333, 590.163333, 7499.996667, 5409.833333, 3278.686667, 3319.670000, 8902.173333, 7394.016667, 7826.086667, 5478.260000, 5673.910000, 1100.543333, 10628.800000, 2331.520000, 3977.900000, 655.736667, 1573.770000, 311.473333, 6782.606667, 6913.043333, 5673.910000, 3505.433333, 2840.216667, 423.910000, 5901.636667, 5478.260000, 78.260000, 3281.086667, 2724.453333, 782.606667, 2282.606667
## 3                                                                                                                                                                                                                                                                                                                                                                                                                                                                          27540.983, 1544.260, 2360.653, 4327.863, 4309.390, 7624.307, 2469.610, 6464.087, 5171.270
## 4                                                                                                                                                                                                                                                                                                                                                           6065.2167, 7826.0867, 5869.5633, 11739.1300, 10434.7800, 19889.5000, 8552.4833, 2386.7400, 326.0867, 9836.0633, 8852.4567, 7868.8500, 14754.0967, 16721.3100, 14754.0967, 4077.3467, 828.7267, 3934.4233
## 5                                                                                                                                                                                                                                                                            5099.99667, 4820.86333, 3815.21667, 2739.13000, 3717.39000, 11508.19333, 983.60333, 590.16333, 6358.69333, 4695.65000, 269.01667, 4304.34667, 1304.34667, 2543.47667, 717.39000, 4721.31000, 5311.47333, 8524.59000, 3147.54000, 819.67000, 4010.86667, 94.56333, 180.32333, 4721.31000
## 6                                                                                                                                                                                                                             1108.6933, 5086.9533, 4695.6500, 1010.8667, 48.9100, 5918.4733, 12717.3900, 19889.5000, 8552.4833, 2386.7400, 7032.7833, 5016.3933, 3854.0967, 4548.9100, 6097.8233, 5086.9533, 5543.4767, 8573.7667, 786.8833, 6762.4300, 9149.1700, 6393.4400, 3540.9833, 5311.4733, 6639.3433, 180.3267, 688.5233, 1513.1133, 5171.2700, 11820.6467
##   cohort
## 1      3
## 2      1
## 3      2
## 4      3
## 5      1
## 6      2</code></pre>
<div id="crear-base-limpia" class="section level2" number="4.1">
<h2 number="4.1"><span class="header-section-number">4.1</span> Crear base limpia</h2>
<pre class="r"><code>filtro_pp_c&lt;-function(df_1,general = 0)
{
  #recibe un hijo de un dataframe, para polimorfismo
  # general = 0y regresa un data frame con los datos
  # ordenados del hijo
  if(df_1[&quot;pp&quot;]==1)
  {
    dfn &lt;- df_1%&gt;%
          filter(pp==1)%&gt;%
          select(starts_with(c(&quot;pp&quot;,&quot;p_&quot;)),
             ing_h,edu_h,ocu_h,edad_h,p_edad_2016,
             region,cohort)%&gt;%
          mutate(pp_edad2016 = p_edad_2016)%&gt;%
          rename(
            id_hijo = pp_id_hijo,
            pp_sexo = pp,
            pp_edad = p_edad_2016,
            pp_educ = p_edu,
            pp_educg = p_edug,
            pp_ocup = p_ocu
          )%&gt;%
        mutate(pp_edad = pp_edad + (14-edad_h))
  }
  if(df_1[&quot;pp&quot;]==2)
    {
    dfn&lt;-df_1%&gt;%
        filter(pp==2)%&gt;%
        select(starts_with(c(&quot;pp&quot;,&quot;m_&quot;)),ing_h,edu_h,
            ocu_h,edad_h,m_edad_2016,
            region,cohort)%&gt;%
       mutate(pp_edad2016 = m_edad_2016)%&gt;%
        rename(
          id_hijo = pp_id_hijo,
          pp_sexo = pp,
          pp_edad = m_edad_2016,
          pp_educ = m_edu,
          pp_educg = m_edug,
          pp_ocup = m_ocu
        )%&gt;%
        mutate(pp_edad = pp_edad + (14-edad_h))
  }
  if(is.na(dfn$pp_edad) &amp; general){
    return(&quot;ND&quot;)
  }
  return(dfn)
}

#comporbamos qeu funcione bien
filtro_pp_c(padres_h[1,])</code></pre>
<pre><code>##   pp_estado pp_sexo id_hijo pp_edad pp_educ pp_educg pp_ocup
## 1         1       1       1      40      11        5      21
##                                                                                                                                                                                                                                                                  ing_h
## 1 14673.9100, 4891.3033, 113.3133, 978.2600, 1856.3533, 196.7200, 2360.6533, 12652.1700, 1858.6933, 3391.3033, 7630.4333, 2119.5633, 983.6033, 1967.2100, 2754.0967, 3878.4500, 12082.8700, 6725.9633, 1723.7567, 3815.2167, 847.8233, 5086.9533, 1834.2367, 1695.6500
##   edu_h ocu_h edad_h region cohort pp_edad2016
## 1     6  2815     25      3      3          51</code></pre>
<pre class="r"><code>acomoda_df_c&lt;-function(df){
  #damos un df de una edad,  y
  # nos regresa un data frame acomodado
  aux&lt;-function(i){
    return(df[i,])
  }
  a&lt;-lapply(1:nrow(df),aux)
  L&lt;-lapply(a,filtro_pp_c)
  dfn &lt;-bind_rows(L[1:length(L)])
  return(dfn)
}

dfh&lt;-acomoda_df_c(padres_h)



pro_edad_c &lt;- function(df){
  #le damos el df y nos regresa el promedio de la edade  los padres
  df%&gt;%summarise(
    promedi_edad_padres = mean(pp_edad2016,na.rm=TRUE))
  }

edades_pro&lt;- pro_edad_c(dfh)

edades_pro</code></pre>
<pre><code>##   promedi_edad_padres
## 1            60.12035</code></pre>
<pre class="r"><code>#edades de padres faltantes
sum(is.na(dfh$pp_edad2016))</code></pre>
<pre><code>## [1] 53</code></pre>
<pre class="r"><code># 
head(dfh)</code></pre>
<pre><code>##   pp_estado pp_sexo id_hijo pp_edad pp_educ pp_educg pp_ocup
## 1         1       1       1      40      11        5      21
## 2         1       1       2      51       2        3      52
## 3         1       1       3      45       6        3      61
## 4         1       2       4      51       2        6      82
## 5         1       1       5      59       2        4      71
## 6         1       2       6      33      11        4      13
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ing_h
## 1                                                                                                                                                                                                                                                                                               14673.9100, 4891.3033, 113.3133, 978.2600, 1856.3533, 196.7200, 2360.6533, 12652.1700, 1858.6933, 3391.3033, 7630.4333, 2119.5633, 983.6033, 1967.2100, 2754.0967, 3878.4500, 12082.8700, 6725.9633, 1723.7567, 3815.2167, 847.8233, 5086.9533, 1834.2367, 1695.6500
## 2 4309.390000, 3662.983333, 521.736667, 6281.963333, 9606.553333, 3.276667, 8217.390000, 4695.650000, 3913.043333, 7081.966667, 1515.080000, 5901.636667, 983.603333, 590.163333, 7499.996667, 5409.833333, 3278.686667, 3319.670000, 8902.173333, 7394.016667, 7826.086667, 5478.260000, 5673.910000, 1100.543333, 10628.800000, 2331.520000, 3977.900000, 655.736667, 1573.770000, 311.473333, 6782.606667, 6913.043333, 5673.910000, 3505.433333, 2840.216667, 423.910000, 5901.636667, 5478.260000, 78.260000, 3281.086667, 2724.453333, 782.606667, 2282.606667
## 3                                                                                                                                                                                                                                                                                                                                                                                                                                                                          27540.983, 1544.260, 2360.653, 4327.863, 4309.390, 7624.307, 2469.610, 6464.087, 5171.270
## 4                                                                                                                                                                                                                                                                                                                                                           6065.2167, 7826.0867, 5869.5633, 11739.1300, 10434.7800, 19889.5000, 8552.4833, 2386.7400, 326.0867, 9836.0633, 8852.4567, 7868.8500, 14754.0967, 16721.3100, 14754.0967, 4077.3467, 828.7267, 3934.4233
## 5                                                                                                                                                                                                                                                                            5099.99667, 4820.86333, 3815.21667, 2739.13000, 3717.39000, 11508.19333, 983.60333, 590.16333, 6358.69333, 4695.65000, 269.01667, 4304.34667, 1304.34667, 2543.47667, 717.39000, 4721.31000, 5311.47333, 8524.59000, 3147.54000, 819.67000, 4010.86667, 94.56333, 180.32333, 4721.31000
## 6                                                                                                                                                                                                                             1108.6933, 5086.9533, 4695.6500, 1010.8667, 48.9100, 5918.4733, 12717.3900, 19889.5000, 8552.4833, 2386.7400, 7032.7833, 5016.3933, 3854.0967, 4548.9100, 6097.8233, 5086.9533, 5543.4767, 8573.7667, 786.8833, 6762.4300, 9149.1700, 6393.4400, 3540.9833, 5311.4733, 6639.3433, 180.3267, 688.5233, 1513.1133, 5171.2700, 11820.6467
##   edu_h ocu_h edad_h region cohort pp_edad2016
## 1     6  2815     25      3      3          51
## 2     4  7121     35      3      1          72
## 3     6  3211     40      3      2          71
## 4    11  4111     28      3      3          65
## 5     2  5111     37      3      1          82
## 6     5  4111     29      3      2          48</code></pre>
<pre class="r"><code># 2016-21</code></pre>
</div>
<div id="codificacion-eduación" class="section level2" number="4.2">
<h2 number="4.2"><span class="header-section-number">4.2</span> Codificacion eduación</h2>
<pre class="r"><code>dfh_c&lt;- dfh%&gt;%
   mutate(
   pp_educ_a = ifelse(pp_educ==1,1,    #sin instruccion(1)
          ifelse(pp_educ==2,1+pp_educg,
          ifelse(pp_educ %in% c(3,4),7+pp_educg,
          ifelse(pp_educ %in% c(5,6,7,8,9),10+pp_educg,
          ifelse(pp_educ %in% c(10,11),13+pp_educg,17+pp_educg)))))
  )

  

unique(dfh_c$pp_educ_a)</code></pre>
<pre><code>##  [1] 18  4 13  7  5 17 12  6 10  3  9 16 19  2 20 14 15  1 11  8</code></pre>
<pre class="r"><code>dfh_c&lt;-dfh_c%&gt;%
  mutate(
   pp_educ_ac = ifelse(pp_educ_a %in% 0:5,&quot;C1&quot;,    
          ifelse(pp_educ_a %in% 6:10 ,&quot;C2&quot;,
          ifelse(pp_educ_a %in% 11:12,&quot;C3&quot;,
          ifelse(pp_educ_a %in% 13:14,&quot;C4&quot;,&quot;C5&quot;))))
  )</code></pre>
</div>
</div>
<div id="padres-construcción-ingresos" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Padres construcción ingresos</h1>
<p>Seleccionamos de la ENIGH 1997, no hay entonces 1998</p>
<div id="poblacion-enigh-98" class="section level2" number="5.1">
<h2 number="5.1"><span class="header-section-number">5.1</span> Poblacion enigh 98</h2>
<pre class="r"><code>poblacion&lt;-read.dbf(
              file=&quot;Datos/ENIGH-Historica/1998/POBLA98.dbf&quot;
              )



poblacion_e98&lt;-poblacion%&gt;%
  filter(
    parentesco == &quot;01&quot;,
    between(edad,30,50),
    !is.na(ed_formal),
    !is.na(ed_tecnica),
    !is.na(ocupacion),
    n_empleos==1, # el entrevistado solo proporciona una ocupación
  )%&gt;%
  select(
    folio,
    num_ren,
    edad,
    ed_formal,
    ed_tecnica,
    ocupacion
  )%&gt;%
 mutate(
  ed_formal = as.integer(as.character(ed_formal)),
   ed_tecnica= as.integer(as.character(ed_tecnica)),
  estado = substr(folio,5,6)
 )

#unique(pobla_enigh1998$ed_formal)
#pobla_enigh1998$ed_formal
nrow(poblacion_e98)</code></pre>
<pre><code>## [1] 4173</code></pre>
<pre class="r"><code>head(poblacion_e98$ed_formal)</code></pre>
<pre><code>## [1]  3  8 13 10 15 11</code></pre>
<pre class="r"><code>str(poblacion_e98$ed_formal)#caracter 2 espacios</code></pre>
<pre><code>##  int [1:4173] 3 8 13 10 15 11 8 8 4 14 ...</code></pre>
<pre class="r"><code>unique(poblacion_e98$ed_formal)</code></pre>
<pre><code>##  [1]  3  8 13 10 15 11  4 14  7  1  5 12  6 16  9  2</code></pre>
<pre class="r"><code>#pobla_enigh1998$ed_formal==&quot;03&quot;
head(poblacion_e98$ed_tecnica)</code></pre>
<pre><code>## [1] 1 1 8 1 1 1</code></pre>
<pre class="r"><code>str(poblacion_e98$ed_tecnica)#caracter 1 espacio</code></pre>
<pre><code>##  int [1:4173] 1 1 8 1 1 1 1 1 1 1 ...</code></pre>
<pre class="r"><code>unique(poblacion_e98$ed_tecnica)</code></pre>
<pre><code>## [1] 1 8 9 5 7 6 3 4 2</code></pre>
<pre class="r"><code>#pobla_enigh1998%&gt;%count(n_empleos), se exploro para quitar una ocupacion
names(poblacion)</code></pre>
<pre><code>##  [1] &quot;folio&quot;      &quot;num_ren&quot;    &quot;parentesco&quot; &quot;sexo&quot;       &quot;edad&quot;      
##  [6] &quot;per_ing&quot;    &quot;leer_esc&quot;   &quot;asis_esc_f&quot; &quot;asis_esc_t&quot; &quot;tipo_esc&quot;  
## [11] &quot;ed_formal&quot;  &quot;debe_mat&quot;   &quot;grado_debe&quot; &quot;ed_tecnica&quot; &quot;beca&quot;      
## [16] &quot;prop_beca&quot;  &quot;como_beca&quot;  &quot;edo_civil&quot;  &quot;trabajo&quot;    &quot;no_trabajo&quot;
## [21] &quot;n_empleos&quot;  &quot;emp_dpais&quot;  &quot;posicion&quot;   &quot;ocupacion&quot;  &quot;rama&quot;      
## [26] &quot;nom_empr&quot;   &quot;numper&quot;     &quot;hrs_sem&quot;    &quot;dia_pago&quot;   &quot;hrs_extra&quot; 
## [31] &quot;capacita&quot;   &quot;antigue&quot;    &quot;contrato1&quot;  &quot;sindicato1&quot; &quot;prestacio1&quot;
## [36] &quot;emp_dpais2&quot; &quot;posici_sec&quot; &quot;ocup_sec&quot;   &quot;rama_sec&quot;   &quot;nom_empr2&quot; 
## [41] &quot;num_per2&quot;   &quot;hrs_sec&quot;    &quot;dia_pago2&quot;  &quot;hrs_extra2&quot; &quot;capacita2&quot; 
## [46] &quot;antigue2&quot;   &quot;contrato2&quot;  &quot;sindicato2&quot; &quot;tot_hrs&quot;    &quot;prestacio2&quot;
## [51] &quot;otrotrab&quot;</code></pre>
<pre class="r"><code>str(poblacion$per_ing)</code></pre>
<pre><code>##  Factor w/ 3 levels &quot;0&quot;,&quot;1&quot;,&quot;2&quot;: 2 3 2 2 2 2 2 3 3 2 ...</code></pre>
<div id="codificación-educación-enigh-1998" class="section level3" number="5.1.1">
<h3 number="5.1.1"><span class="header-section-number">5.1.1</span> Codificación educación enigh 1998</h3>
<pre class="r"><code># hacemos la codificación de ENIGH2018 a ESRU
#1  Preescolar o kínder
# 2 Primaria
# 3 Secundaria técnica
# 4 Secundaria general
# 5 Preparatoria técnica
# 6 Preparatoria general
# 7 Técnica o comercial con secundaria
# 8 Técnica o comercial con preparatoria
# 9 Normal básica (con primaria o secundari
# 10 Normal de licenciatura
# 11 Profesional (licenciatura o ingeniería)
# 12 Postgrado (maestría o doctorado)
#_____________________________________________________
# 98 NS, no aplica porque pedimos la edución del pp como instrumento


# vemso las combinaciones de educación para codificar

comb&lt;-poblacion_e98%&gt;%
   mutate( combi = paste(as.character(ed_formal),as.character(ed_tecnica)))%&gt;%
  select(ed_formal,ed_tecnica,combi)

  
sort(unique(comb$combi))</code></pre>
<pre><code>##  [1] &quot;1 1&quot;  &quot;10 1&quot; &quot;10 2&quot; &quot;10 4&quot; &quot;10 5&quot; &quot;11 1&quot; &quot;11 3&quot; &quot;11 4&quot; &quot;11 5&quot; &quot;11 6&quot;
## [11] &quot;11 7&quot; &quot;12 1&quot; &quot;12 3&quot; &quot;12 5&quot; &quot;12 6&quot; &quot;12 7&quot; &quot;13 1&quot; &quot;13 5&quot; &quot;13 6&quot; &quot;13 7&quot;
## [21] &quot;13 8&quot; &quot;13 9&quot; &quot;14 1&quot; &quot;14 3&quot; &quot;14 5&quot; &quot;14 6&quot; &quot;14 7&quot; &quot;14 9&quot; &quot;15 1&quot; &quot;15 3&quot;
## [31] &quot;15 4&quot; &quot;15 5&quot; &quot;15 6&quot; &quot;15 7&quot; &quot;15 9&quot; &quot;16 1&quot; &quot;16 5&quot; &quot;16 7&quot; &quot;16 9&quot; &quot;2 1&quot; 
## [41] &quot;3 1&quot;  &quot;3 2&quot;  &quot;4 1&quot;  &quot;5 1&quot;  &quot;6 1&quot;  &quot;7 1&quot;  &quot;7 2&quot;  &quot;8 1&quot;  &quot;8 2&quot;  &quot;8 3&quot; 
## [51] &quot;8 4&quot;  &quot;8 5&quot;  &quot;9 1&quot;  &quot;9 4&quot;  &quot;9 5&quot;</code></pre>
<pre class="r"><code># [1] &quot;01 1&quot; &quot;02 1&quot; &quot;03 1&quot; &quot;03 2&quot; &quot;04 1&quot; &quot;05 1&quot; &quot;06 1&quot; &quot;07 1&quot; &quot;07 2&quot; &quot;08 1&quot;
# [11] &quot;08 2&quot; &quot;08 3&quot; &quot;08 4&quot; &quot;08 5&quot; &quot;09 1&quot; &quot;09 4&quot; &quot;09 5&quot; &quot;10 1&quot; &quot;10 2&quot; &quot;10 4&quot;
# [21] &quot;10 5&quot; &quot;11 1&quot; &quot;11 3&quot; &quot;11 4&quot; &quot;11 5&quot; &quot;11 6&quot; &quot;11 7&quot; &quot;12 1&quot; &quot;12 3&quot; &quot;12 5&quot;
# [31] &quot;12 6&quot; &quot;12 7&quot; &quot;13 1&quot; &quot;13 5&quot; &quot;13 6&quot; &quot;13 7&quot; &quot;13 8&quot; &quot;13 9&quot; &quot;14 1&quot; &quot;14 3&quot;
# [41] &quot;14 5&quot; &quot;14 6&quot; &quot;14 7&quot; &quot;14 9&quot; &quot;15 1&quot; &quot;15 3&quot; &quot;15 4&quot; &quot;15 5&quot; &quot;15 6&quot; &quot;15 7&quot;
# [51] &quot;15 9&quot; &quot;16 1&quot; &quot;16 5&quot; &quot;16 7&quot; &quot;16 9&quot;




# &quot;16 1&quot; &quot;16 5&quot; &quot;16 7&quot; &quot;16 9&quot;

#codificamos a a años de educación
poblacion_e98c&lt;-poblacion_e98%&gt;%
   mutate(
   edu_a = ifelse(ed_formal==1 &amp; ed_tecnica==1,0,    #sin instruccion(1)
          ifelse((ed_formal %in% c(2,3,4,5,6,7,8,9,10,11,12,13))
                 &amp; (ed_tecnica %in% c(1,2)),ed_formal-1,
          ifelse(ed_formal==8 &amp; (ed_tecnica %in% c(3,4,5)),9,
          ifelse(ed_formal==9 &amp; (ed_tecnica %in% c(4,5)),10,
          ifelse(ed_formal==10 &amp; (ed_tecnica %in% c(2,4,5)),11,
          ifelse(ed_formal==11 &amp; (ed_tecnica %in% c(3,4,5,5,7)),12,
          ifelse((ed_formal %in%c(12)) &amp; (ed_tecnica %in% c(3,5,6,7)),12,
          ifelse(ed_formal==13 &amp; (ed_tecnica %in% c(5,6,7,8,9)),13,
          ifelse(ed_formal==14 &amp; (ed_tecnica %in% c(1,3,5,6,7,9)),14,
          ifelse(ed_formal==15 &amp; (ed_tecnica %in% c(1,3,4,5,6,7,9)),17,19))))))))))
  )

unique(poblacion_e98c$edu_a)</code></pre>
<pre><code>##  [1]  2  7 13  9 17 10  3 14  6  0  4 11 12  5 19  8  1</code></pre>
<pre class="r"><code>#codificamos a coghort de educación

poblacion_e98c&lt;-poblacion_e98c%&gt;%
   mutate(
   edu_ac = ifelse(edu_a %in% 0:5,&quot;C1&quot;,    
          ifelse(edu_a %in% 6:10 ,&quot;C2&quot;,
          ifelse(edu_a %in% 11:12,&quot;C3&quot;,
          ifelse(edu_a %in% 13:14,&quot;C4&quot;,&quot;C5&quot;))))
  )

unique(poblacion_e98c$edu_ac )</code></pre>
<pre><code>## [1] &quot;C1&quot; &quot;C2&quot; &quot;C4&quot; &quot;C5&quot; &quot;C3&quot;</code></pre>
</div>
<div id="creacion-de-region" class="section level3" number="5.1.2">
<h3 number="5.1.2"><span class="header-section-number">5.1.2</span> Creacion de region</h3>
<pre class="r"><code>poblacion_e98c&lt;-poblacion_e98c%&gt;%
          mutate(
            region = ifelse(estado %in% c(&quot;02&quot;,&quot;26&quot;,&quot;08&quot;,&quot;05&quot;,&quot;19&quot;,&quot;28&quot;),1,
                ifelse(estado %in% c(&quot;12&quot;,&quot;20&quot;,&quot;07&quot;,&quot;30&quot;,&quot;27&quot;,&quot;04&quot;,&quot;31&quot;,&quot;23&quot;),5,0))
          )</code></pre>
</div>
</div>
<div id="ingresos-enigh-98" class="section level2" number="5.2">
<h2 number="5.2"><span class="header-section-number">5.2</span> Ingresos enigh 98</h2>
<pre class="r"><code>ingresos&lt;-read.dbf(
              file=&quot;Datos/ENIGH-Historica/1998/ingresos.dbf&quot;
              )

familias_integrantes &lt;- function(df,nr){
  dfn &lt;- df %&gt;%
    filter(NUM_REN %in% nr)
  return(dfn)
} 



ingresos_acu &lt;- function(df,clavs){
 dfn &lt;- df %&gt;%
   group_by(FOLIO, NUM_REN) %&gt;%
   filter(CLAVE %in% clavs)%&gt;%
   summarise(
   claves_a = paste(CLAVE,collapse = &quot;,&quot;),
  ing_tri_t = sum(ING_TRI),
  ing_men_p = ing_tri_t/3,
  ling_men_p = log(ing_men_p)
  ) %&gt;% ungroup()
 
 
 return(dfn)
}

#hogares &lt;- c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;)
personas_h &lt;- c(&#39;01&#39;)

a&lt;-familias_integrantes(ingresos,personas_h)
head(a)</code></pre>
<pre><code>##         FOLIO NUM_REN EMPLEO        MESES CLAVE ING_1 ING_TRI ING_2 ING_3 ING_4
## 1 19980110010      01      1 070605040302  P001  1640    5060  1640  1640  1600
## 2 19980110030      01      1 070605040302  P012  8500   25500  9000  8000  9000
## 3 19980110040      01      1 070605040302  P001  1000    2750  1000  1000   900
## 4 19980110040      01      1 070605040302  P003     0     525   400   400   250
## 5 19980110011      01      1 070605040302  P001  1410    4230  1410  1410  1410
## 6 19980110011      01      2 070605040302  P012   500     250     0     0     0
##   ING_5 ING_6
## 1  1600  2000
## 2  8000  8500
## 3   800   800
## 4     0     0
## 5  1410  1410
## 6     0     0</code></pre>
<pre class="r"><code>claves&lt;-c(&quot;P001&quot;,&quot;P002&quot;,&quot;P003&quot;,&quot;P010&quot;,&quot;P011&quot;,&quot;P012&quot;,&quot;P013&quot;,&quot;P014&quot;,&quot;P015&quot;, &quot;P016&quot;,&quot;P017&quot;,&quot;P018&quot;,&quot;P020&quot;,&quot;P021&quot;,&quot;P026&quot;,&quot;P027&quot;,&quot;P035&quot;,&quot;P040&quot;,&quot;P041&quot;,&quot;P042&quot;,&quot;P044&quot;,&quot;P045&quot;)
ingresos_e98&lt;-ingresos_acu(a,claves) 
ingresos_e98&lt;-ingresos_e98%&gt;%
  select(FOLIO,NUM_REN,claves_a,ling_men_p)%&gt;%
  rename(
    folio = FOLIO,
    num_ren = NUM_REN
  )
head(ingresos_e98)</code></pre>
<pre><code>## # A tibble: 6 x 4
##   folio       num_ren claves_a  ling_men_p
##   &lt;fct&gt;       &lt;fct&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 19980110010 01      P001            7.43
## 2 19980110011 01      P001,P012       7.31
## 3 19980110030 01      P012            9.05
## 4 19980110040 01      P001,P003       7.00
## 5 19980110050 01      P001            8.35
## 6 19980110060 01      P001            9.39</code></pre>
</div>
<div id="base-cruzada-pobla-ing" class="section level2" number="5.3">
<h2 number="5.3"><span class="header-section-number">5.3</span> Base cruzada pobla-ing</h2>
<pre class="r"><code>enigh_98&lt;-full_join(poblacion_e98c,ingresos_e98)%&gt;%
  drop_na()%&gt;%
   mutate(
     ocupacion = substr(ocupacion,1,2)
   )#%&gt;%
  # rename(
  #   EDU=N_INSTR161,
  #   OCU = CMO121
  # )%&gt;%
  # mutate(
  #   EDU = as.character(EDU)
  # )
head(enigh_98)</code></pre>
<pre><code>##         folio num_ren edad ed_formal ed_tecnica ocupacion estado edu_a edu_ac
## 1 19980110010      01   46         3          1        52     01     2     C1
## 2 19980110030      01   43         8          1        81     01     7     C2
## 3 19980110050      01   45        13          8        21     01    13     C4
## 4 19980110080      01   38        10          1        21     01     9     C2
## 5 19980110110      01   41        15          1        41     01    17     C5
## 6 19980110120      01   32        11          1        14     01    10     C2
##   region  claves_a ling_men_p
## 1      0      P001   7.430509
## 2      0      P012   9.047821
## 3      0      P001   8.354674
## 4      0      P011   9.255266
## 5      0      P014   7.762171
## 6      0 P012,P035  10.194290</code></pre>
<pre class="r"><code>unique(enigh_98$edad)</code></pre>
<pre><code>##  [1] 46 43 45 38 41 32 48 30 39 34 50 49 31 47 37 35 42 36 44 33 40</code></pre>
<pre class="r"><code># ajuste para nivel de ecucación ESRU

#data_padres2005$EDU &lt;- factor(data_padres2005$EDU)
#data_padres2005$OCU &lt;- factor(data_padres2005$OCU)

#unique(data_padres2005$OCU)
sum(is.na(enigh_98))</code></pre>
<pre><code>## [1] 0</code></pre>
</div>
</div>
<div id="eslaticidad-integeneracional-de-ingresos" class="section level1" number="6">
<h1 number="6"><span class="header-section-number">6</span> Eslaticidad integeneracional de ingresos</h1>
<div id="deflactamos-ingresos" class="section level2" number="6.1">
<h2 number="6.1"><span class="header-section-number">6.1</span> Deflactamos ingresos</h2>
<p>INPC Feb 2021 = 110.907 <a href="https://www.banxico.org.mx/SieInternet/consultarDirectorioInternetAction.do?accion=consultarCuadro&amp;idCuadro=CP154&amp;locale=es">Consulta</a></p>
<pre class="r"><code>INPC&lt;-110.907

enigh_98&lt;-enigh_98%&gt;%
  mutate(
  ling_men_p=ling_men_p-log(INPC)
  )</code></pre>
<p>Por la porgramación, para los hijos, se hace dentro del sigueinte programa</p>
</div>
<div id="estimación" class="section level2" number="6.2">
<h2 number="6.2"><span class="header-section-number">6.2</span> Estimación</h2>
<p>Sin controlar por ocupación del hijo</p>
<pre class="r"><code>eii&lt;-function(i){
  
  

# BOOSTRAP  
# Regresión de ingresos de padres  
reg_padres&lt;-lm(
  formula = ling_men_p ~ edu_ac + ocupacion + edad +I(edad*edad),
  data = enigh_98[sample(nrow(enigh_98),nrow(enigh_98), replace = TRUE),]
)

#summary(reg_padres)

# numero de padres sin ocupación reportada de hijos
p_socu&lt;-sum(is.na(dfh_c$pp_ocup))
#p_socu


dfh_cna&lt;-dfh_c%&gt;%drop_na(pp_ocup)

# daframe para estimar ingreso padres
data&lt;- data.frame(
   edu_ac= dfh_cna$pp_educ_ac,
   ocupacion= dfh_cna$pp_ocup,
   edad = 0
  )

# BOOSTRAP ingreso HIJOS

# calculamos el ingreso de los hijos con los gemelos
# re-sampleados, ademas codificamos la ocupación del hijo a dos caracteres

auxs&lt;-function(k){
  sample(k,size=length(k),replace=TRUE)
}

dfh_cna &lt;- dfh_cna %&gt;%
  mutate(
   ocu_hc= substring(ocu_h,1,2),
   ing_h=unlist(lapply(
                      lapply(ing_h,auxs),
                      mean
                      )
                ),
   ling_h = log(ing_h)-log(INPC)
  )

dfh_f&lt;-dfh_cna%&gt;%
  mutate(cohort_e = ifelse(ing_h&lt;=2400,1,
                          ifelse(ing_h&lt;=4800,2,
                          ifelse(ing_h&lt;=7200,3,
                          ifelse(ing_h&lt;=12000,4,                          ifelse(ing_h&lt;=24000,5,6))))),
         cohort_dif=cohort-cohort_e)

  
#dfh_cna
#dfh_cna$ocu_hijo
#dfh_cna$ling_h

#str(substr(dfh_cna$ocu_h,1,2))

# estimación ingreso padres
# inputamos al hijo correspondiente

dfhpf&lt;- dfh_f%&gt;%
  mutate(ling_p = predict(
    object = reg_padres,   
    newdata = data)) 
#dfhpf

# Elasticidad intergeneacional del ingreso

reg_hp&lt;-lm(
  formula = ling_h ~ ling_p + edad_h+ I(edad_h*edad_h),#+ ocu_hc,
  data = dfhpf
)
#summary(reg_hp)
beta &lt;- reg_hp$coefficients[2]
cohort_dif&lt;-as.integer(dfhpf%&gt;%count(cohort_dif)%&gt;%
                   filter(cohort_dif==0)%&gt;%
                 select(n))

return(data.frame()%&gt;%summarise(
  cohort_dif=cohort_dif,
  beta=beta))

}
set.seed(123)
a&lt;-lapply(1:1500,eii)
resul&lt;-bind_rows(a[1:length(a)])
head(resul)</code></pre>
<pre><code>##   cohort_dif      beta
## 1        310 0.2583353
## 2        327 0.2593623
## 3        321 0.2709035
## 4        332 0.2753167
## 5        313 0.2967468
## 6        315 0.2676047</code></pre>
<pre class="r"><code>mean(resul$beta)</code></pre>
<pre><code>## [1] 0.2637111</code></pre>
<pre class="r"><code>sd(resul$beta)</code></pre>
<pre><code>## [1] 0.01674104</code></pre>
<pre class="r"><code>hist(resul$beta)</code></pre>
<p><img src="Estimacion_files/figure-html/fun_prin_eii-1.png" width="672" /></p>
<pre class="r"><code>hist(resul$cohort_dif)</code></pre>
<p><img src="Estimacion_files/figure-html/hit_n0-1.png" width="672" /></p>
<pre class="r"><code>mean(resul$cohort_dif)</code></pre>
<pre><code>## [1] 320.6627</code></pre>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiRXN0aWFtY2lvbiIKYXV0aG9yOiAiUmFmYWVsIE1hcnTDrW5leiBNYXJ0w61uZXoiCm91dHB1dDogCiAgaHRtbF9kb2N1bWVudDoKICAgIHRvYzogdHJ1ZQogICAgdG9jX2Zsb2F0OiB0cnVlCiAgICB0b2NfZGVwdGg6IDMKICAgIG51bWJlcl9zZWN0aW9uczogdHJ1ZQogICAgY29kZV9kb3dubG9hZDogdHJ1ZQogICAgY29kZV9mb2xkaW5nOiBzaG93Ci0tLQoKCmBgYHtyIHNldHVwLCBpbmNsdWRlPUZBTFNFfQprbml0cjo6b3B0c19jaHVuayRzZXQoZWNobyA9IFRSVUUsIG1lc3NhZ2UgPSBGQUxTRSkKYGBgCgoKYGBge3IgY2FyZ2FyX2JpbGlvdGVjYXN9CmxpYnJhcnkodGlkeXZlcnNlKQpsaWJyYXJ5KGhhdmVuKSAjIGltcG9ydGEsIGVudHJlIG90cm9zIHNvZnR3YXJlLCBkZSBTdGF0YQpsaWJyYXJ5KHNqbGFiZWxsZWQpICMgbWFuZWphciBsYWJlbHMgZGUgbGFzIHZhcmlhYmxlcyAKbGlicmFyeShvcGVueGxzeCkgIyBsZWVyIGFyY2hpdm9zIGRlIGV4Y2VsCmxpYnJhcnkoRFQpICMgdmlzdWFsaXphciBhIHRhYmxhcwpsaWJyYXJ5KGRhdGEudGFibGUpICMgY29udmVydGlyIGEgdGFibGFzCmxpYnJhcnkoaGlnaGNoYXJ0ZXIpICMgZ3LDoWZpY2FzIGludGVyYWN0aXZhcwpsaWJyYXJ5KGZvcmVpZ24pCmBgYAoKCiMgRnVuY2lvbmVzIGRlIGNhcmdhCgpgYGB7ciBmdW5fY2FyZ19FU1JVfQoKY2FyZ2FyX2VzcnU8LSBmdW5jdGlvbigpewoKcmV0dXJuKHJlYWRfc3RhdGEoCiAgICAgICAgICAgICAgICAgICAgIHBhdGggPSAiRGF0b3MvRVNSVS1FTU9WSS0yMDE3L0VTUlUtRU1PVkktMjAxNy1FbnRyZXZpc3RhZG8uZHRhIiwKICAgICAgICAgICAgICAgICAgICAgYXRvbWljLnRvLmZhYyA9IFRSVUUsCiAgICAgICAgICAgICAgICAgICAgIGVuYyA9IE5VTEwsCiAgICAgICAgICAgICAgICAgICAgICkpCn0KYGBgCgoKYGBge3IgY2FyYWdhcl9lbmlnaH0KY2FyZ2FyX2VuaWdoPC0gZnVuY3Rpb24oZG9jdSl7CgpyZXR1cm4ocmVhZF9zdGF0YSgKICAgICAgICAgICAgICAgICAgICAgcGF0aCA9IHBhc3RlKCJEYXRvcy9FTklHSC0yMDE2LyIsZG9jdSwiLmR0YSIsc2VwPSIiKSwKICAgICAgICAgICAgICAgICAgICAgYXRvbWljLnRvLmZhYyA9IFRSVUUsCiAgICAgICAgICAgICAgICAgICAgIGVuYyA9IE5VTEwsCiAgICAgICAgICAgICAgICAgICAgICkpCn0KCmNhcmdhcl9lbmlnaF9zYXY8LSBmdW5jdGlvbihkb2N1KXsKCnJldHVybihyZWFkX3Nwc3MoCiAgICAgICAgICAgICAgICAgICAgIHBhdGggPSBwYXN0ZSgiRGF0b3MvRU5JR0gtMjAxNi8iLGRvY3UsIi5zYXYiLHNlcD0iIiksCiAgICAgICAgICAgICAgICAgICAgIGF0b21pYy50by5mYWMgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICBlbmMgPSBOVUxMLAogICAgICAgICAgICAgICAgICAgICApKQp9CmBgYAoKCgojIEZpbHRyYXIgaGlqb3MgRVNSVQoKIyMgQ3JlYW1vcyAgcGVyIG1vdmlsaWRhZAoKYGBge3IgY2FyZ2FfZXNydV9jcmVhX21vdn0gCgpkYXRhX2Vtb3ZpMjAxNzwtY2FyZ2FyX2VzcnUoKQoKZGF0YV9lbW92aTIwMTc8LWRhdGFfZW1vdmkyMDE3JT4lCiAgbXV0YXRlKG1vdiA9IGlmZWxzZShwMTQ3PnAxNDgsIm1lam9yIiwKICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShwMTQ3PHAxNDgsInBlb3IiLCJpZ3VhbCIpKSwKICAgICAgICAgaWRfaG8gPSBhcy5pbnRlZ2VyKHJvdy5uYW1lcyhkYXRhX2Vtb3ZpMjAxNykpKQpkYXRhX2Vtb3ZpMjAxNyRtb3Y8LXNldF9sYWJlbHMoCiAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YV9lbW92aTIwMTckbW92LAogICAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVscyA9IGMoIm1lam9yIiA9ICJtZWpvciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAicGVvciIgPSAicGVvciIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaWd1YWwiID0gImlndWFsIikpCgpgYGAKCiMjIENyYW1vcyBjb2hvcnQKCgoKIyMgc2VsZWNjaW9uIGRlIGhpam9zCgpDcml0ZXJpb3MgZGUgZmlsdHJhZG8KLSBwcmVndW50YSBwMiwgY29tcGFydGVuIGVsIG1pbXNvIGdhc3RvIHBhcmEgY29tZXI6IDEgKSBTaSAyICkgTm8KLSBwcmVndW50YSA1IEVkYWRlcyBlbnRyZSAyNSB5IDQ1IGHDsW9zCi0gcHJlZ3VudGEgcDA4LCBlcyBlbCBqZWZlIGRlbCBob2dhcjogMSApIGplZmUgMikgY8Ozbnl1Z2UgTk8gSU1QTEVNRU5UQURPCi0gcHJlZ3VudGEgcDEyLCBhY3R1YWxtZW50ZSBlc3R1ZGlhLCAxKVNpIDIpTm8KLSBwMjYgSGFiw61hIHVuIGplZmUgZGUgaG9nYXIgZW4gbGEgaW5mYW5jaWEgKDEgcGFkcmUgMiBtYWRyZSkKLSBwNDMgeSBwNDNtIFJlcG9ydGEgZWR1Y2FjacOzbiBkZWwgcGFkcmUgbyBtYWRyZSBwcmljaWFwbAotIHA2OCwgUGVyc29uYXMgcXVlIHRyYWJhamFuLCAxLiBTaSwgMi4gTm8KLSBwNjkgc2kgdHJhYmFqYSBwZXJvIGxhIHNlbWFuYSBwYXNhZGEgbm8gCi0gcDEzMiBudW1lcm8gZGUgcGVyc29uYXMgcXVlIGFwb3J0YW4gaW5ncmVzbwotIHAxMzMgY29ob3J0IGRlIHRvZGFzIGxhcyBwZXJzb25hcyB5IHRvZG9zIGxvcyBpbmdyZXNvcyAoMSBpbmdyZXNvKQoKClZhcmlhYmxlcyBkZSBzZWxlY2Npw7NuIHBhcmEgZXN0aW1hciBpbmdyZXNvCgotIEVzdGFkbwoKLSBwcmVndW50YSA1LCBlZGFkCgotIHByZWd1bnRhIDYsIHNleG8KCi0gUHJlZ3VudGEgMTMsIG5pdmVsIGRlIGVzY3VlbGEKCi0gcDc2IG9jdXBhY2nDs24KLS1TSU5DTzMgY29kaWZpY2FjacOzbiBvY3VwYWNpw7NuIGVudHJldmlzdGFkbwoKLSBwMTMzIGNvaG9ydCBkZSB0b2RhcyBsYXMgcGVyc29uYXMgeSB0b2RvcyBsb3MgaW5ncmVzb3MKCgpgYGB7ciBoaWpvc19zZWxfZXNydX0KIyBwZW5zYW1vcyBxdWUgbG9zIGRhdG9zIHNlIGxlZWVuIGNvbW8gZmFjdG9yZXMgY2FuZG8gY29ycmVzcG9uZGEsIHNpIHNlIGxlZW4gY29tbyBlbnRlcm9zIG5vIGRlYmUgaGFjZXJzZSBlbCBjYXN0aW5nCiNkYXRhX2Vtb3ZpMjAxNzwtZGF0b3NfZQpoaWpvcyA8LSBkYXRhX2Vtb3ZpMjAxNyAlPiUKICBmaWx0ZXIocDAyID09IDEpICAlPiUgI2NvbXBhcnRpciBnYXNvdCBwYXJhIGNvbWVyCiAgZmlsdGVyKGJldHdlZW4ocDA1LDI1LDQwKSkgJT4lICMgZWRhZAogICNmaWx0ZXIocDA4ID09IDEpICAlPiUgCiAgZmlsdGVyKHAxMiA9PSAyKSAgJT4lICMgeWEgbm8gZXN0dWRpYQogIGZpbHRlcihwMjYgPT0gMSB8IHAyNj09MiApICU+JSAjIHNvc3RlbiBwcmluY2lwYWwgcGFwYSwgbWFtYSwgCiAgIGZpbHRlcigoIWlzLm5hKHA0MykgJiBwNDMhPTk4ICYgcDI2ID09IDEgKSB8CiAgICAgICAgICAgICghaXMubmEocDQzbSkgJiBwNDNtIT05OCAgJiBwMjYgPT0gMiApKSAlPiUgIyByZXBvcnRhIGVkdWNhY2nDs24gZGUgcHAKICAgZmlsdGVyKCFpcy5uYShwMTMpKSU+JSAjICByZXBvcnRhIGVkdWNhY2nDs24KICBmaWx0ZXIoU0lOQ08zICE9IiIpICU+JSMgcmVwb3J0YSBvZmljaW8gYWN0dWFsCiAgIGZpbHRlcihwNjggPT0gMSB8IHA2OSA9PSAxKSAgJT4lICMgc2kgdHJhYmFqYQogICBmaWx0ZXIocDEzMiAlaW4lIGMoMSkpICU+JSMgcGVyc29uYSBxdWUgYXBvcnRhbiBpbmdyZXNvCiAgZmlsdGVyKCFwMTMzICVpbiUgYyg4LDksTkEpICkgIyByZXBvcnRhIGluZ3Jlc29zCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIyBubyBlc3RhbiBsb3MgaW5ncmVzb3MgIGhvZ2FyIGFpc2xhZG9zLiAKCiNlZGFkX3Byb21lZGlvX3BhZHJlcyA8LSBtZWFuKGhpam9zJHAzOF8xMSwgbmEucm0gPSBUUlVFKQojZWRhZF9wcm9tZWRpb19wYWRyZXMtMjEKCnN0cihoaWpvcyRwMDIpCgp1bmlxdWUoaGlqb3MkcDQzKQpgYGAKIyMgaGlqb3Mgc2VsZWNjaW9uYWRvcwoKSGFjZW1vcyB1biBjb2hvcnQgZGVsIDEgeSBlbCAyIAoKYGBge3IgaGlqb3Nfc2VsX2VzcnVfbW9kfQoKCnZhcjwtYygiRXN0YWRvIiwicDA1IiwicDA2IiwicDEzIiwiU0lOQ08zIiwicDEzMyIsIm1vdiIsImlkX2hvIiwicmVnaW9uIikKaGlqb3NfcGFyYV9zYWw8LWhpam9zJT4lCiAgc2VsZWN0KHZhciklPiUKICBtdXRhdGUocDEzMyA9IGlmZWxzZShwMTMzPT0xLDIscDEzMyktMSkjIGp1bnRhbW9zIGVsIGNvaG9ydCAxIHkgMiAKCmhpam9zX3BhcmFfc2FsIDwtIGhpam9zX3BhcmFfc2FsJT4lCiAgICAgICAgICAgIG11dGF0ZShlc3RyYXRvID0gaWZlbHNlKHAxMzMgJWluJSBjKDEsMiksMSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKHAxMzMgJWluJSBjKDMpLDIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UocDEzMyAlaW4lIGMoNCw1KSwzLDQpKSkpCgoKI3N1bShoaWpvc19wYXJhX3NhbCRwMTMzPT0xKQoKbnJvdyhoaWpvc19wYXJhX3NhbCkKc2F2ZVJEUyhoaWpvc19wYXJhX3NhbCwgZmlsZT0iRGF0b3MvaGlqb3NfZW1vdmkyMDE3LlJkYSIpCgpgYGAKCiMgSGlqb3MgY29uc3RydWNjacOzbiBpbmdyZXNvcwoKYGBge3IsIGNhcmdhcl9lbmlnaDE2fQpwb2JsYWNpb25fZTE2PC1jYXJnYXJfZW5pZ2hfc2F2KCJwb2JsYWNpb24iKSAKdHJhYmFqb3NfZTE2PC1jYXJnYXJfZW5pZ2hfc2F2KCJ0cmFiYWpvcyIpCmluZ3Jlc29zX2UxNjwtY2FyZ2FyX2VuaWdoX3NhdigiaW5ncmVzb3MiKQpgYGAKCiMjIHBvYmxhY2lvbiBlbmlnaCAxNgpgYGB7ciBwb2JsYWNpb25fZTE2fQpwb2JsYWNpb25fZTE2ZjwtIHBvYmxhY2lvbl9lMTYlPiUKICAjZmlsdGVyKGFzaXNfZXNjID09ICIyIiklPiUgIyB5YSBubyBhc2lzdGUgYSBsYSBlc2N1ZWxhCiAgc2VsZWN0KGZvbGlvdml2LGZvbGlvaG9nLG51bXJlbixzZXhvLGVkYWQsbml2ZWxhcHJvYiklPiUKICBmaWx0ZXIoYmV0d2Vlbihhcy5pbnRlZ2VyKGVkYWQpLDI1LDQwKSkKIyBubyBmaWx0cmFtb3MgcG9yIGplZmUgZGUgaG9nYXIKCm5yb3cocG9ibGFjaW9uX2UxNmYpCnN1bShpcy5uYShwb2JsYWNpb25fZTE2ZikpCgpgYGAKCiMjIHRyYWJham9zIGVuaWdoIDE2CgpGaWx0cmFtcyBsb3MgdHJhYmFqb3MKCmBgYHtyIHRyYWJham9zX2UxNn0KdHJhYmFqb3NfZTE2ZjwtdHJhYmFqb3NfZTE2JT4lCnNlbGVjdChmb2xpb3Zpdixmb2xpb2hvZyxudW1yZW4pIyU+JQogIyBmaWx0ZXIoIWlzLm5hKHNpbmNvKSkKTlJPVyh0cmFiYWpvc19lMTZmKQojTlJPVyh0cmFiYWpvcykKc3VtKGlzLm5hKHRyYWJham9zX2UxNmYpKQoKYGBgCgojIyBJbmdyZXNvcyBlbmlnaCAyMDE2CgpgYGB7ciBpbmdyZXNvc19lMTZ9CmZhbWlsaWFzX2ludGVncmFudGVzX2UxNiA8LSBmdW5jdGlvbihkZixmb2xob2csbnIpewogIGRmbiA8LSBkZiAlPiUKICAgIGZpbHRlcihmb2xpb2hvZyAlaW4lIGZvbGhvZyklPiUKICAgIGZpbHRlcihudW1yZW4gJWluJSBucikKICByZXR1cm4oZGZuKQp9IAoKCgppbmdyZXNvc19hY3VfZTE2IDwtIGZ1bmN0aW9uKGRmLGNsYXZzPWdldF9sYWJlbHMoaW5ncmVzb3NfZTE2JGNsYXZlKSl7CiBkZm4gPC0gZGYgJT4lCiAgIGdyb3VwX2J5KGZvbGlvdml2LCBmb2xpb2hvZywgbnVtcmVuKSAlPiUKICAgZmlsdGVyKGNsYXZlICVpbiUgY2xhdnMpJT4lCiAgIHN1bW1hcmlzZSgKICAgY2xhdmVzX2EgPSBwYXN0ZShjbGF2ZSxjb2xsYXBzZSA9ICIsIiksCiAgaW5nX3RyaV90ID0gc3VtKGluZ190cmkpLAogIGluZ19tZW5fcCA9IGluZ190cmlfdC8zCiAgKSAlPiUgdW5ncm91cCgpCiAKIAogcmV0dXJuKGRmbikKfQoKaG9nYXJlcyA8LSBjKCIxIiwiMiIsIjMiLCI0IiwiNSIpCnBlcnNvbmFzX2ggPC0gYygnMDEnLCcwMicsJzAzJywnMDQnLCcwNScpCgphPC1mYW1pbGlhc19pbnRlZ3JhbnRlc19lMTYoaW5ncmVzb3NfZTE2LGhvZ2FyZXMscGVyc29uYXNfaCkKaGVhZChhKQpjbGF2ZXM8LWMoIlAwMDEiLCJQMDAyIiwiUDAwMyIsIlAwMTEiLCJQMDIzIiwiUDAyNCIsIlAwNTQiLCJQMDU1IiwiUDA1NiIsICJQMDU5IiwiUDA2MCIsIlAwNjEiLCJQMDYzIiwiUDA2OCIsIlAwNjAiLCJQMDcwIiwiUDA3MSIsIlAwNzIiLCJQMDczIiwiUDA3NCIsIlAwNzUiLCJQMDc2IiwiUDA3NyIsIlAwNzgiLCJQMDc5IiwiUDA4MCIpCmluZ3Jlc29zX2UxNmE8LWluZ3Jlc29zX2FjdV9lMTYoYSxjbGF2ZXMpIAppbmdyZXNvc19lMTZhCmBgYAoKCiMjIEJhc2UgY3J1emFkYSBwb2ItdHJhCgpgYGB7ciBiYXNlX2NydXphZGF9CmVuaWdoXzE2PC0gZnVsbF9qb2luKHBvYmxhY2lvbl9lMTZmLHRyYWJham9zX2UxNmYpJT4lCiAgIGRyb3BfbmEoKQojZW5pZ2g8LWZ1bGxfam9pbihlbmlnaCxjb25jZW50cmFkbyklPiUKICMgZHJvcF9uYSgpCm5yb3coZW5pZ2hfMTYpCnN1bShpcy5uYShlbmlnaF8xNikpCmBgYAoKIyMgQ2FtYmlvIGV0aXF1ZXRhZG8KUGFzYW1vcyBsYXMgZXRpcWV1dGVhcyBkZSBlZHVjYWNpw7NuIGRlIGVtb3ZpIGEgCgpgYGB7ciBjYW1iaWFfZV9lc3J1X29jdX0KCmhpam9zX2Vtb3ZpIDwtIHJlYWRSRFMoZmlsZT0iRGF0b3MvaGlqb3NfZW1vdmkyMDE3LlJkYSIpCmhpam9zX2Vtb3ZpPC0gaGlqb3NfZW1vdmkgJT4lCiAgbXV0YXRlKHAxM19tID0gaWZlbHNlKHAxMyAlaW4lIGMoMSksIjEiLAogICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKCBwMTMgPT0gMiwiMiIsCiAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UocDEzICVpbiUgYygzLDQpLCIzIiwKICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZSggcDEzICVpbiUgYyg1LDYpLCI0IiwKICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShwMTMgJWluJSBjKDcsOCksIjYiLAogICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKHAxMyAlaW4lIGMoOSwxMCksIjUiLAogICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKHAxMz09MTEsIjciLAogICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKHAxMz09MTIsIjgiLCIwIikpKSkpKSkpKQp1bmlxdWUoaGlqb3NfZW1vdmkkcDEzX20pCgplbmlnaF8xNjwtZW5pZ2hfMTYlPiUKICBtdXRhdGUobml2ZWxhcHJvYj1pZmVsc2Uobml2ZWxhcHJvYj09IjkiLCI4IixuaXZlbGFwcm9iKSkKCmVuaWdoXzE2ZjwtZW5pZ2hfMTYlPiUKICBmaWx0ZXIobml2ZWxhcHJvYiAlaW4lIHVuaXF1ZShoaWpvc19lbW92aSRwMTNfbSkpCgpucm93KGVuaWdoXzE2ZikKYGBgCgoKIyMgQnVzY2FyIGZvbGlvcyBjb24gY2FyYWN0ZXJpc3RpY2FzCgpgYGB7ciBidXNjYV9mb2xpb3NfZTE2fQpidXNjYTwtZnVuY3Rpb24oaSl7CnJldHVybihlbmlnaF8xNmYlPiUKICBmaWx0ZXIoCiAgICBhcy5pbnRlZ2VyKHN1YnN0cihmb2xpb3ZpdiwxLDIpKT09aGlqb3NfZW1vdmlbaSxdJEVzdGFkbyAmCiAgICBzZXhvID09IGhpam9zX2Vtb3ZpW2ksXSRwMDYgJgogICAgZWRhZCA9PSBoaWpvc19lbW92aVtpLF0kcDA1ICYKICAgICNzaW5jbyA9PSBoaWpvc19lbW92aVtpLF0kU0lOQ08zICYKICAgIG5pdmVsYXByb2IgPT0gaGlqb3NfZW1vdmlbaSxdJHAxM19tKSU+JQogIHNlbGVjdChmb2xpb3Zpdixmb2xpb2hvZykpCn0KCiAgCmE8LWxhcHBseSgxOm5yb3coaGlqb3NfZW1vdmkpLCBidXNjYSkKCmNvbnRhZG9yPC0wCmZvcihpIGluIDE6bnJvdyhoaWpvc19lbW92aSkpCntpZihucm93KGFbW2ldXSk+MCkKICBjb250YWRvcjwtY29udGFkb3IgKzEKfQpjb250YWRvcgpzYXZlUkRTKGEsIGZpbGU9IkRhdG9zL2ZvbGhpam9zX2VuaWdoMTZfZW1vdmkuUmRhIikKYGBgCgpEZWwgdG90YWwsIDEwNzcgcGVyc29uYXMgdGllbmVuIGdlbWVsb3MKCiMjIyBmaWx0YW1vcyBzb2xvIGxvcyBoaWpvcyBlbmNvbnRyYWRvcwoKCmBgYHtyIGV0aXF1ZV9oaWpvc19lbmNffSAKIyBldGlxdWV0YW1vcyBwYXJhIG5vIHBlcmRlciBsYSBudW1lcmFjaW9uIHJlc3BlY3RvIGEgbG9zIGhpam9zIG9yaWdpbmFsZXMKZm9saGlqb3NfZTE2X2Vtb3ZpIDwtIHJlYWRSRFMoZmlsZT0iRGF0b3MvZm9saGlqb3NfZW5pZ2gxNl9lbW92aS5SZGEiKQpuYW1lcyhmb2xoaWpvc19lMTZfZW1vdmkpIDwtIGFzLmNoYXJhY3RlcigxOm5yb3coaGlqb3NfZW1vdmkpKQpsZW5ndGgoZm9saGlqb3NfZTE2X2Vtb3ZpKQpgYGAKCmBgYHtyIGZpbHRyYV9oaWpvc19lbmNvbn0KTCA8LSBjKCkKZm9yKGkgaW4gMTpsZW5ndGgoZm9saGlqb3NfZTE2X2Vtb3ZpKSl7CiAgaWYoIShucm93KGZvbGhpam9zX2UxNl9lbW92aVtbaV1dKT4wKSl7CiAgICBMPC1jKEwsaSl9Cn0KIyBTb2xvIGhpam9zIHF1ZSBzZSBsZXMgcHVkbyBlbmNvbnRyYXIgZW4gZW5pZ2gtMjAxNiAxMDc3LzExMzEKZm9saGlqb3NfZTE2X2Vtb3ZpZjwtZm9saGlqb3NfZTE2X2Vtb3ZpWy1MXQogICAgCgpsZW5ndGgoZm9saGlqb3NfZTE2X2Vtb3ZpZikKCiNuYW1lcyhmb2xoaWpvc19lbW92aWYpCiNuYW1lcyhmb2xoaWpvc19lbW92aSkKYGBgCgojIyMgVW5pY29zIGZvbGlvcywgZGlmZXJlbnRlcyB0cmFiYWpvcwoKCgpgYGB7ciBmaWx0cmFfZmlsX2hpal91bml9CnVuaWNvc19mb2xpb3M8LWZ1bmN0aW9uKGkpewpmb2xoaWpvc19lMTZfZW1vdmlmW1tpXV0lPiUKICBkaXN0aW5jdCgpCn0KCiMgZmlsdHJhbW9zIHVuaWNvcyBmb2xpb3MgcG9yIGRpZmVyZW50ZXMgdHJhYmFqb3MgZGUgbGEgbWlzbWEgcGVyc29uYQphPC1sYXBwbHkoMTpsZW5ndGgoZm9saGlqb3NfZTE2X2Vtb3ZpZiksIHVuaWNvc19mb2xpb3MpCm5hbWVzKGEpPC1uYW1lcyhmb2xoaWpvc19lMTZfZW1vdmlmKQpsZW5ndGgoYSkKCmZvbGhpam9zX2UxNl9lbW92aWY8LWEKYGBgCgoKIyMjIE9ic2VydmFtb3MgbGFzIGVkYWRlcyBkZSBsb3MgZW5jb250cmFkb3MKCmBgYHtyIGdyYV9lZGFkZXNfaF9lbmN9CgpteU1lbnVJdGVtcyA8LSBjKCJkb3dubG9hZFBORyIsICJkb3dubG9hZEpQRUciLCAiZG93bmxvYWRQREYiLCAnZG93bmxvYWRTVkcnLCAncHJpbnRDaGFydCcpCgpoaWpvc19lbW92aSU+JQogIHNsaWNlKGFzLmludGVnZXIobmFtZXMoZm9saGlqb3NfZTE2X2Vtb3ZpZikpKSU+JQogIHNlbGVjdChwMDUpJT4lCiAgY291bnQocDA1KSU+JQogICAgaGNoYXJ0KCdjb2x1bW4nLAogICAgICAgICBoY2FlcyggeSA9ICduJykpJT4lCiAgaGNfYWRkX3RoZW1lKGhjX3RoZW1lX2ZmeCgpKSU+JQogIGhjX3RpdGxlKAogICAgdGV4dCA9ICIiCiAgKSAlPiUKICAjaGNfc3VidGl0bGUodGV4dCA9ICJMYXMgZWRhZGVzIGVzdMOhbiBhZ3J1cGFkYXMgZW4gaW50ZXJ2YWxvcyAKICAgIyAgICAgICAgICAgZGUgMTAgYcOxb3MgKGRhIGNsaWMgc29icmUgRiBvIE0pIikgJT4lCiAgIyBoY19jcmVkaXRzKAogICMgIGVuYWJsZWQgPSBUUlVFLCB0ZXh0ID0gIlNvdXJjZTogU1NTIiwKICAjICBzdHlsZSA9IGxpc3QoZm9udFNpemUgPSAiMTJweCIpKSU+JQogIGhjX3lBeGlzKHRpdGxlID0gbGlzdCh0ZXh0ID0gIk7Dum1lcm8gZGUgcGFydGljaXBhbnRlcyIpKSU+JQogIGhjX3hBeGlzKHRpdGxlPWxpc3QodGV4dD0iTsO6bWVybyBkZSBwZXJzb25hcyIpLAogICAgICAgICAgIGNhdGVnb3JpZXMgPSBhcy5jaGFyYWN0ZXIoMjU6NDApKSAlPiUKICAgIGhjX2V4cG9ydGluZyhlbmFibGVkID0gVFJVRSwKICAgICAgICAgICAgICAgZmlsZW5hbWUgPSAiZGF0b3MiLAogICAgICAgICAgICAgICBidXR0b25zID0gbGlzdChjb250ZXh0QnV0dG9uID0gbGlzdChtZW51SXRlbXMgPSBteU1lbnVJdGVtcykpKQoKCmBgYAoKIyMjIE9ic2VydmFtb3MgbGFzIGVzdGFkb3MgZGUgbG9zIGVuY29udHJhZG9zCgpgYGB7ciBncmFfZXN0YWRvc19oX2UxNn0KaGlqb3NfZW1vdmklPiUKICBzbGljZShhcy5pbnRlZ2VyKG5hbWVzKGZvbGhpam9zX2UxNl9lbW92aWYpKSklPiUKICBjb3VudChFc3RhZG8pJT4lCiAgICBoY2hhcnQoJ2NvbHVtbicsCiAgICAgICAgIGhjYWVzKCB5ID0gJ24nKSklPiUKICBoY19hZGRfdGhlbWUoaGNfdGhlbWVfZmZ4KCkpJT4lCiAgaGNfdGl0bGUoCiAgICB0ZXh0ID0gIiIKICApICU+JQogICNoY19zdWJ0aXRsZSh0ZXh0ID0gIkxhcyBlZGFkZXMgZXN0w6FuIGFncnVwYWRhcyBlbiBpbnRlcnZhbG9zIAogICAjICAgICAgICAgICBkZSAxMCBhw7FvcyAoZGEgY2xpYyBzb2JyZSBGIG8gTSkiKSAlPiUKICAjIGhjX2NyZWRpdHMoCiAgIyAgZW5hYmxlZCA9IFRSVUUsIHRleHQgPSAiU291cmNlOiBTU1MiLAogICMgIHN0eWxlID0gbGlzdChmb250U2l6ZSA9ICIxMnB4IikpJT4lCiAgaGNfeUF4aXModGl0bGUgPSBsaXN0KHRleHQgPSAiTsO6bWVybyBkZSBwYXJ0aWNpcGFudGVzIikpJT4lCiAgaGNfeEF4aXModGl0bGU9bGlzdCh0ZXh0PSJOw7ptZXJvIGRlIHBlcnNvbmFzIiksCiAgICAgICAgICAgY2F0ZWdvcmllcyA9IGdldF9sYWJlbHMoaGlqb3NfZW1vdmkkRXN0YWRvKSkgJT4lCiAgICBoY19leHBvcnRpbmcoZW5hYmxlZCA9IFRSVUUsCiAgICAgICAgICAgICAgIGZpbGVuYW1lID0gImRhdG9zIiwKICAgICAgICAgICAgICAgYnV0dG9ucyA9IGxpc3QoY29udGV4dEJ1dHRvbiA9IGxpc3QobWVudUl0ZW1zID0gbXlNZW51SXRlbXMpKSkKCmBgYAoKCiMjIEluZ3Jlc28gaGlqbyBlbmlnaDE2LWVtb3ZpCgpgYGB7ciBpbmdyZV9oaWpvX2UxNl9lbW92aX0KCmluZ3Jlc29faGlqb19lMTZfZW1vdmk8LWZ1bmN0aW9uKGkpewogIGluZ3Jlc29zX2UxNmElPiUKICBmaWx0ZXIoZm9saW92aXYgJWluJSBmb2xoaWpvc19lMTZfZW1vdmlmW1tpXV0kZm9saW92aXYgJgogICAgZm9saW9ob2cgJWluJSBmb2xoaWpvc19lMTZfZW1vdmlmW1tpXV0kZm9saW9ob2cpJT4lc3VtbWFyaXNlKAogICAgIGlkX2hpam8gPSBuYW1lcyhmb2xoaWpvc19lMTZfZW1vdmlmW2ldKSwKICAgICBpZF9obyA9IGhpam9zX2Vtb3ZpW2FzLmludGVnZXIobmFtZXMoZm9saGlqb3NfZTE2X2Vtb3ZpZltpXSkpLCJpZF9obyJdLAogICAgIG1vdj0gaGlqb3NfZW1vdmlbYXMuaW50ZWdlcihuYW1lcyhmb2xoaWpvc19lMTZfZW1vdmlmW2ldKSksIm1vdiJdLAogICAgIHJlZ2lvbmggPSBoaWpvc19lbW92aVthcy5pbnRlZ2VyKG5hbWVzKGZvbGhpam9zX2UxNl9lbW92aWZbaV0pKSwicmVnaW9uIl0sCiAgICAgZWRhZCA9IGhpam9zX2Vtb3ZpW2FzLmludGVnZXIobmFtZXMoZm9saGlqb3NfZTE2X2Vtb3ZpZltpXSkpLCJwMDUiXSwKICAgICAgaW5nX21lbl9wX2ggPWxpc3QoaW5nX21lbl9wKSwKICAgICBjb2hvcnQgPSBoaWpvc19lbW92aVthcy5pbnRlZ2VyKG5hbWVzKGZvbGhpam9zX2UxNl9lbW92aWZbaV0pKSwicDEzMyJdLAogICAgZXN0cmF0byA9IGhpam9zX2Vtb3ZpW2FzLmludGVnZXIobmFtZXMoZm9saGlqb3NfZTE2X2Vtb3ZpZltpXSkpLCJlc3RyYXRvIl0sCiAgICBlc3RhZG8gPSBoaWpvc19lbW92aVthcy5pbnRlZ2VyKG5hbWVzKGZvbGhpam9zX2UxNl9lbW92aWZbaV0pKSwiRXN0YWRvIl0sCiAgICBzZXhvID0gaGlqb3NfZW1vdmlbYXMuaW50ZWdlcihuYW1lcyhmb2xoaWpvc19lMTZfZW1vdmlmW2ldKSksInAwNiJdCiAgICAgKQp9CiMyNzMsMzMyIHNvbiB2YWNpb3MKIyBpbmdyZXNvIGhpam8gcGVybyB1YWxndW5vcyBubyBwb2RyaWFuIGVzdGFyIHBvciBubyB0ZW5lciByZWdpc3RybyBkZSBzYWxhcmlvCgphPC1sYXBwbHkoMTpsZW5ndGgoZm9saGlqb3NfZTE2X2Vtb3ZpZiksIGluZ3Jlc29faGlqb19lMTZfZW1vdmkpCmluZ3Jlc29faGlqb2dfZTE2X2Vtb3ZpPC1hCmxlbmd0aChpbmdyZXNvX2hpam9nX2UxNl9lbW92aSkKaW5ncmVzb19oaWpvZ19lMTZfZW1vdmlbWzMzMl1dCng8LWluZ3Jlc29faGlqb2dfZTE2X2Vtb3ZpW1szMzJdXSRpbmdfbWVuX3BfaFsxXQpzdW0oaW5ncmVzb19oaWpvZ19lMTZfZW1vdmlbWzMzMl1dJGluZ19tZW5fcF9oW1sxXV0sbmEucm0gPSBUUlVFKQpgYGAKIyMgRmlsdHJhbW9zIHNvYnJlIGluZ3Jlc29zIGVuY29udHJhZG9zCgpgYGB7ciBmaWxfaW5ncmVfZW5jX2UxNl9lbW92aX0KCkwgPC0gYygpCmZvcihpIGluIDE6bGVuZ3RoKGluZ3Jlc29faGlqb2dfZTE2X2Vtb3ZpKSl7CiAgaWYoc3VtKGluZ3Jlc29faGlqb2dfZTE2X2Vtb3ZpW1tpXV0kaW5nX21lbl9wX2hbWzFdXSxuYS5ybSA9IFRSVUUpPT0wKXsKICAgIEw8LWMoTCxpKX0KfQpsZW5ndGgoTCkKCmluZ3Jlc29faGlqb2dfZTE2X2Vtb3ZpPC1pbmdyZXNvX2hpam9nX2UxNl9lbW92aVstTF0KCmxlbmd0aChpbmdyZXNvX2hpam9nX2UxNl9lbW92aSkKaW5ncmVzb19oaWpvZ19lMTZfZW1vdmlbMV0KaW5ncmVzb19oaWpvZ19lMTZfZW1vdmlbMl0KCgppbmdyZXNvX2hpam9nX2UxNl9lbW92aWY8LWJpbmRfcm93cyhpbmdyZXNvX2hpam9nX2UxNl9lbW92aVsxOmxlbmd0aChpbmdyZXNvX2hpam9nX2UxNl9lbW92aSldKQoKCm5yb3coaW5ncmVzb19oaWpvZ19lMTZfZW1vdmlmKQoKc2F2ZVJEUyhpbmdyZXNvX2hpam9nX2UxNl9lbW92aWYsIGZpbGU9IkRhdG9zL2luZ3Jlc29faGlqX2ZfZW1vdmkuUmRhIikKYGBgCgojIEhpam9zIGNvbiBpbmdyZXNvCgpgYGB7ciBmaWx0cm9faGlqb3NfeWFfaW5ncmVzb30KaGlqb3NfZW1vdmlfaHAgPC0gcmVhZFJEUyhmaWxlPSJEYXRvcy9pbmdyZXNvX2hpal9mX2Vtb3ZpLlJkYSIpCgpucm93KGhpam9zX2Vtb3ZpX2hwKQpoaWpvc19lbW92aV9ocCAKIyBwMDUgZWRhZCBhY3QKIyBwMDYgc2V4byBhY3QKIyBwMTMgZWR1YyBoaWpvCiMgU0lOQ08zLCBvY3VwYWNpw7NuIGhpam8KIyBwMjMgZW4gcWV1IGVzdGFkbyB2aXZpYSBhIGxvcyAxNAojIHAyNiBwcmluY2lwYWwgc29zdGVuIGVjw7NtaWNvCiMgcDM4XzExIGVkYWQgcGFkcmUgMjAxNgojIHAzOG1fMTEgZWRhZCBtYWRyZSAyMDE2CiMgcDQzIG5pdmVsIGVkdWNhdGl2byBwYWRyZQojcDQzbSBuaXZlbCBlZHVjYXRpdm8gbWFkcmUKIyBjbW8xXzIgb2N1cGFjaW9uIGRlbCBwYWRyZQojIGNtbzJfMiBvY3VwYWNpb24gZGUgbGEgbWFkcmUgCgoKdmFycDwtYygiRXN0YWRvIiwicDA1IiwicDA2IiwicDEzIiwiU0lOQ08zIiwicDIzIiwicDI2IiwicDM4XzExIiwicDM4bV8xMSIsInA0MyIsInA0NCIsCiAgICAgICAgInA0M20iLCJwNDRtIiwiY21vMV8yIiwiY21vMl8yIiwibW92IiwKICAgICAgICAicmVnaW9uIiwicDEzMyIpCnBhZHJlc19oPC1kYXRhX2Vtb3ZpMjAxNyU+JQogICAgZmlsdGVyKHAwMiA9PSAxKSAgJT4lICNjb21wYXJ0aXIgZ2Fzb3QgcGFyYSBjb21lcgogIGZpbHRlcihiZXR3ZWVuKHAwNSwyNSw0MCkpICU+JSAjIGVkYWQKICAjZmlsdGVyKHAwOCA9PSAxKSAgJT4lIAogIGZpbHRlcihwMTIgPT0gMikgICU+JSMgeWEgbm8gZXN0dWRpYQogIGZpbHRlcihwMjYgPT0gMSB8IHAyNj09MiApICU+JSAjIHNvc3RlbiBwcmluY2lwYWwgcGFwYSwgbWFtYSwgCiAgIGZpbHRlcigoIWlzLm5hKHA0MykgJiBwNDMhPTk4ICYgcDI2ID09IDEgKXwKICAgICAgICAgICAgKCFpcy5uYShwNDNtKSAmIHA0M20hPTk4ICAmIHAyNiA9PSAyICkpICU+JSAjIHJlcG9ydGEgZWR1Y2FjacOzbiBkZSBwcAogICBmaWx0ZXIoIWlzLm5hKHAxMykpJT4lICMgIHJlcG9ydGEgZWR1Y2FjacOzbgogIGZpbHRlcihTSU5DTzMgIT0iIikgJT4lIyByZXBvcnRhIG9maWNpbyBhY3R1YWwKICAgZmlsdGVyKHA2OCA9PSAxIHwgcDY5ID09IDEpICAlPiUgIyBzaSB0cmFiYWphCiAgIGZpbHRlcihwMTMyICVpbiUgYygxKSkgJT4lIyBwZXJzb25hIHF1ZSBhcG9ydGFuIGluZ3Jlc28KICBmaWx0ZXIoIXAxMzMgJWluJSBjKDgsOSxOQSkgKSU+JQogIHNlbGVjdCh2YXJwKSU+JQogIHNsaWNlKGFzLmludGVnZXIodW5saXN0KGhpam9zX2Vtb3ZpX2hwJT4lc2VsZWN0KGlkX2hpam8pKSkpJT4lCiAgbXV0YXRlKAogICAgICAgICBwcF9pZF9oaWpvID0gaGlqb3NfZW1vdmlfaHAlPiVwdWxsKGlkX2hpam8pLAogICAgICAgICBpbmdfaCA9IGhpam9zX2Vtb3ZpX2hwJT4lcHVsbChpbmdfbWVuX3BfaCksCiAgICAgICAgIGNvaG9ydCA9IGlmZWxzZShwMTMzPT0xLDIscDEzMyktMQogICAgICAgICApJT4lCiAgcmVuYW1lKAogICAgICAgICAgZWRhZF9oID0gcDA1LAogICAgICAgICAgc2V4b19oID0gcDA2LAogICAgICAgICAgZWR1X2ggPSBwMTMsCiAgICAgICAgICBvY3VfaCA9IFNJTkNPMywKICAgICAgICAgIHBwX2VzdGFkbyA9IHAyMywKICAgICAgICAgIHBwID0gcDI2LAogICAgICAgICAgcF9lZGFkXzIwMTY9IHAzOF8xMSwKICAgICAgICAgIG1fZWRhZF8yMDE2ID0gcDM4bV8xMSwKICAgICAgICAgIHBfZWR1ID0gcDQzLAogICAgICAgICAgcF9lZHVnID0gcDQ0LAogICAgICAgICAgbV9lZHUgPSBwNDNtLAogICAgICAgICAgbV9lZHVnID0gcDQ0bSwKICAgICAgICAgIHBfb2N1ID0gY21vMV8yLAogICAgICAgICAgbV9vY3UgPSBjbW8yXzIKICAgICAgICAgKSU+JQogIG11dGF0ZSgKICAgICAgICBwX2VkdSA9IGFzLmludGVnZXIocF9lZHUpLAogICAgICAgIG1fZWR1ID0gYXMuaW50ZWdlcihtX2VkdSkKICApCiAgCiAKIyBsYXMgb2N1cGFjaW9uZXMgbm8gZW5jb250cmFkYXMgbGFzIHN1c3RpdHVpbW9zIHBvciB1biBOQQpwYWRyZXNfaDwtcGFkcmVzX2glPiUKICBtdXRhdGUocF9vY3UgPSBpZmVsc2UocF9vY3U9PSIuIixOQSxwX29jdSksCiAgICAgICAgIG1fb2N1ID0gaWZlbHNlKG1fb2N1PT0iLiIsTkEsbV9vY3UpKQoKdW5pcXVlKHBhZHJlc19oJHBfb2N1KQp1bmlxdWUocGFkcmVzX2gkbV9vY3UpCmhlYWQocGFkcmVzX2gpCgpgYGAKCiMjIENyZWFyIGJhc2UgbGltcGlhCgpgYGB7ciBiYXNlX2xpbV9oX2luZ30KCgpmaWx0cm9fcHBfYzwtZnVuY3Rpb24oZGZfMSxnZW5lcmFsID0gMCkKewogICNyZWNpYmUgdW4gaGlqbyBkZSB1biBkYXRhZnJhbWUsIHBhcmEgcG9saW1vcmZpc21vCiAgIyBnZW5lcmFsID0gMHkgcmVncmVzYSB1biBkYXRhIGZyYW1lIGNvbiBsb3MgZGF0b3MKICAjIG9yZGVuYWRvcyBkZWwgaGlqbwogIGlmKGRmXzFbInBwIl09PTEpCiAgewogICAgZGZuIDwtIGRmXzElPiUKICAgICAgICAgIGZpbHRlcihwcD09MSklPiUKICAgICAgICAgIHNlbGVjdChzdGFydHNfd2l0aChjKCJwcCIsInBfIikpLAogICAgICAgICAgICAgaW5nX2gsZWR1X2gsb2N1X2gsZWRhZF9oLHBfZWRhZF8yMDE2LAogICAgICAgICAgICAgcmVnaW9uLGNvaG9ydCklPiUKICAgICAgICAgIG11dGF0ZShwcF9lZGFkMjAxNiA9IHBfZWRhZF8yMDE2KSU+JQogICAgICAgICAgcmVuYW1lKAogICAgICAgICAgICBpZF9oaWpvID0gcHBfaWRfaGlqbywKICAgICAgICAgICAgcHBfc2V4byA9IHBwLAogICAgICAgICAgICBwcF9lZGFkID0gcF9lZGFkXzIwMTYsCiAgICAgICAgICAgIHBwX2VkdWMgPSBwX2VkdSwKICAgICAgICAgICAgcHBfZWR1Y2cgPSBwX2VkdWcsCiAgICAgICAgICAgIHBwX29jdXAgPSBwX29jdQogICAgICAgICAgKSU+JQogICAgICAgIG11dGF0ZShwcF9lZGFkID0gcHBfZWRhZCArICgxNC1lZGFkX2gpKQogIH0KICBpZihkZl8xWyJwcCJdPT0yKQogICAgewogICAgZGZuPC1kZl8xJT4lCiAgICAgICAgZmlsdGVyKHBwPT0yKSU+JQogICAgICAgIHNlbGVjdChzdGFydHNfd2l0aChjKCJwcCIsIm1fIikpLGluZ19oLGVkdV9oLAogICAgICAgICAgICBvY3VfaCxlZGFkX2gsbV9lZGFkXzIwMTYsCiAgICAgICAgICAgIHJlZ2lvbixjb2hvcnQpJT4lCiAgICAgICBtdXRhdGUocHBfZWRhZDIwMTYgPSBtX2VkYWRfMjAxNiklPiUKICAgICAgICByZW5hbWUoCiAgICAgICAgICBpZF9oaWpvID0gcHBfaWRfaGlqbywKICAgICAgICAgIHBwX3NleG8gPSBwcCwKICAgICAgICAgIHBwX2VkYWQgPSBtX2VkYWRfMjAxNiwKICAgICAgICAgIHBwX2VkdWMgPSBtX2VkdSwKICAgICAgICAgIHBwX2VkdWNnID0gbV9lZHVnLAogICAgICAgICAgcHBfb2N1cCA9IG1fb2N1CiAgICAgICAgKSU+JQogICAgICAgIG11dGF0ZShwcF9lZGFkID0gcHBfZWRhZCArICgxNC1lZGFkX2gpKQogIH0KICBpZihpcy5uYShkZm4kcHBfZWRhZCkgJiBnZW5lcmFsKXsKICAgIHJldHVybigiTkQiKQogIH0KICByZXR1cm4oZGZuKQp9CgojY29tcG9yYmFtb3MgcWV1IGZ1bmNpb25lIGJpZW4KZmlsdHJvX3BwX2MocGFkcmVzX2hbMSxdKQoKCmFjb21vZGFfZGZfYzwtZnVuY3Rpb24oZGYpewogICNkYW1vcyB1biBkZiBkZSB1bmEgZWRhZCwgIHkKICAjIG5vcyByZWdyZXNhIHVuIGRhdGEgZnJhbWUgYWNvbW9kYWRvCiAgYXV4PC1mdW5jdGlvbihpKXsKICAgIHJldHVybihkZltpLF0pCiAgfQogIGE8LWxhcHBseSgxOm5yb3coZGYpLGF1eCkKICBMPC1sYXBwbHkoYSxmaWx0cm9fcHBfYykKICBkZm4gPC1iaW5kX3Jvd3MoTFsxOmxlbmd0aChMKV0pCiAgcmV0dXJuKGRmbikKfQoKZGZoPC1hY29tb2RhX2RmX2MocGFkcmVzX2gpCgoKCnByb19lZGFkX2MgPC0gZnVuY3Rpb24oZGYpewogICNsZSBkYW1vcyBlbCBkZiB5IG5vcyByZWdyZXNhIGVsIHByb21lZGlvIGRlIGxhIGVkYWRlICBsb3MgcGFkcmVzCiAgZGYlPiVzdW1tYXJpc2UoCiAgICBwcm9tZWRpX2VkYWRfcGFkcmVzID0gbWVhbihwcF9lZGFkMjAxNixuYS5ybT1UUlVFKSkKICB9CgplZGFkZXNfcHJvPC0gcHJvX2VkYWRfYyhkZmgpCgplZGFkZXNfcHJvCiNlZGFkZXMgZGUgcGFkcmVzIGZhbHRhbnRlcwpzdW0oaXMubmEoZGZoJHBwX2VkYWQyMDE2KSkKIyAKaGVhZChkZmgpCgojIDIwMTYtMjEKYGBgCiMjIENvZGlmaWNhY2lvbiBlZHVhY2nDs24KCgpgYGB7ciBjb2RfZWR1X2hpam99CgpkZmhfYzwtIGRmaCU+JQogICBtdXRhdGUoCiAgIHBwX2VkdWNfYSA9IGlmZWxzZShwcF9lZHVjPT0xLDEsICAgICNzaW4gaW5zdHJ1Y2Npb24oMSkKICAgICAgICAgIGlmZWxzZShwcF9lZHVjPT0yLDErcHBfZWR1Y2csCiAgICAgICAgICBpZmVsc2UocHBfZWR1YyAlaW4lIGMoMyw0KSw3K3BwX2VkdWNnLAogICAgICAgICAgaWZlbHNlKHBwX2VkdWMgJWluJSBjKDUsNiw3LDgsOSksMTArcHBfZWR1Y2csCiAgICAgICAgICBpZmVsc2UocHBfZWR1YyAlaW4lIGMoMTAsMTEpLDEzK3BwX2VkdWNnLDE3K3BwX2VkdWNnKSkpKSkKICApCgogIAoKdW5pcXVlKGRmaF9jJHBwX2VkdWNfYSkKCmRmaF9jPC1kZmhfYyU+JQogIG11dGF0ZSgKICAgcHBfZWR1Y19hYyA9IGlmZWxzZShwcF9lZHVjX2EgJWluJSAwOjUsIkMxIiwgICAgCiAgICAgICAgICBpZmVsc2UocHBfZWR1Y19hICVpbiUgNjoxMCAsIkMyIiwKICAgICAgICAgIGlmZWxzZShwcF9lZHVjX2EgJWluJSAxMToxMiwiQzMiLAogICAgICAgICAgaWZlbHNlKHBwX2VkdWNfYSAlaW4lIDEzOjE0LCJDNCIsIkM1IikpKSkKICApCgpgYGAKCiMgUGFkcmVzIGNvbnN0cnVjY2nDs24gaW5ncmVzb3MKClNlbGVjY2lvbmFtb3MgZGUgbGEgRU5JR0ggMTk5Nywgbm8gaGF5IGVudG9uY2VzIDE5OTgKCiMjIFBvYmxhY2lvbiBlbmlnaCA5OAoKYGBge3IgcG9ibGFjaW9uX2U5OH0KCnBvYmxhY2lvbjwtcmVhZC5kYmYoCiAgICAgICAgICAgICAgZmlsZT0iRGF0b3MvRU5JR0gtSGlzdG9yaWNhLzE5OTgvUE9CTEE5OC5kYmYiCiAgICAgICAgICAgICAgKQoKCgpwb2JsYWNpb25fZTk4PC1wb2JsYWNpb24lPiUKICBmaWx0ZXIoCiAgICBwYXJlbnRlc2NvID09ICIwMSIsCiAgICBiZXR3ZWVuKGVkYWQsMzAsNTApLAogICAgIWlzLm5hKGVkX2Zvcm1hbCksCiAgICAhaXMubmEoZWRfdGVjbmljYSksCiAgICAhaXMubmEob2N1cGFjaW9uKSwKICAgIG5fZW1wbGVvcz09MSwgIyBlbCBlbnRyZXZpc3RhZG8gc29sbyBwcm9wb3JjaW9uYSB1bmEgb2N1cGFjacOzbgogICklPiUKICBzZWxlY3QoCiAgICBmb2xpbywKICAgIG51bV9yZW4sCiAgICBlZGFkLAogICAgZWRfZm9ybWFsLAogICAgZWRfdGVjbmljYSwKICAgIG9jdXBhY2lvbgogICklPiUKIG11dGF0ZSgKICBlZF9mb3JtYWwgPSBhcy5pbnRlZ2VyKGFzLmNoYXJhY3RlcihlZF9mb3JtYWwpKSwKICAgZWRfdGVjbmljYT0gYXMuaW50ZWdlcihhcy5jaGFyYWN0ZXIoZWRfdGVjbmljYSkpLAogIGVzdGFkbyA9IHN1YnN0cihmb2xpbyw1LDYpCiApCgojdW5pcXVlKHBvYmxhX2VuaWdoMTk5OCRlZF9mb3JtYWwpCiNwb2JsYV9lbmlnaDE5OTgkZWRfZm9ybWFsCm5yb3cocG9ibGFjaW9uX2U5OCkKaGVhZChwb2JsYWNpb25fZTk4JGVkX2Zvcm1hbCkKc3RyKHBvYmxhY2lvbl9lOTgkZWRfZm9ybWFsKSNjYXJhY3RlciAyIGVzcGFjaW9zCnVuaXF1ZShwb2JsYWNpb25fZTk4JGVkX2Zvcm1hbCkKI3BvYmxhX2VuaWdoMTk5OCRlZF9mb3JtYWw9PSIwMyIKaGVhZChwb2JsYWNpb25fZTk4JGVkX3RlY25pY2EpCnN0cihwb2JsYWNpb25fZTk4JGVkX3RlY25pY2EpI2NhcmFjdGVyIDEgZXNwYWNpbwp1bmlxdWUocG9ibGFjaW9uX2U5OCRlZF90ZWNuaWNhKQojcG9ibGFfZW5pZ2gxOTk4JT4lY291bnQobl9lbXBsZW9zKSwgc2UgZXhwbG9ybyBwYXJhIHF1aXRhciB1bmEgb2N1cGFjaW9uCm5hbWVzKHBvYmxhY2lvbikKc3RyKHBvYmxhY2lvbiRwZXJfaW5nKQpgYGAKCiMjIyBDb2RpZmljYWNpw7NuIGVkdWNhY2nDs24gZW5pZ2ggMTk5OAoKYGBge3IgY29kX2VkX2U5OH0KIyBoYWNlbW9zIGxhIGNvZGlmaWNhY2nDs24gZGUgRU5JR0gyMDE4IGEgRVNSVQojMQlQcmVlc2NvbGFyIG8ga8OtbmRlcgojIDIJUHJpbWFyaWEKIyAzCVNlY3VuZGFyaWEgdMOpY25pY2EKIyA0CVNlY3VuZGFyaWEgZ2VuZXJhbAojIDUJUHJlcGFyYXRvcmlhIHTDqWNuaWNhCiMgNglQcmVwYXJhdG9yaWEgZ2VuZXJhbAojIDcJVMOpY25pY2EgbyBjb21lcmNpYWwgY29uIHNlY3VuZGFyaWEKIyA4CVTDqWNuaWNhIG8gY29tZXJjaWFsIGNvbiBwcmVwYXJhdG9yaWEKIyA5CU5vcm1hbCBiw6FzaWNhIChjb24gcHJpbWFyaWEgbyBzZWN1bmRhcmkKIyAxMCBOb3JtYWwgZGUgbGljZW5jaWF0dXJhCiMgMTEgUHJvZmVzaW9uYWwgKGxpY2VuY2lhdHVyYSBvIGluZ2VuaWVyw61hKQojIDEyIFBvc3RncmFkbyAobWFlc3Ryw61hIG8gZG9jdG9yYWRvKQojX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX18KIyA5OCBOUywgbm8gYXBsaWNhIHBvcnF1ZSBwZWRpbW9zIGxhIGVkdWNpw7NuIGRlbCBwcCBjb21vIGluc3RydW1lbnRvCgoKIyB2ZW1zbyBsYXMgY29tYmluYWNpb25lcyBkZSBlZHVjYWNpw7NuIHBhcmEgY29kaWZpY2FyCgpjb21iPC1wb2JsYWNpb25fZTk4JT4lCiAgIG11dGF0ZSggY29tYmkgPSBwYXN0ZShhcy5jaGFyYWN0ZXIoZWRfZm9ybWFsKSxhcy5jaGFyYWN0ZXIoZWRfdGVjbmljYSkpKSU+JQogIHNlbGVjdChlZF9mb3JtYWwsZWRfdGVjbmljYSxjb21iaSkKCiAgCnNvcnQodW5pcXVlKGNvbWIkY29tYmkpKQojIFsxXSAiMDEgMSIgIjAyIDEiICIwMyAxIiAiMDMgMiIgIjA0IDEiICIwNSAxIiAiMDYgMSIgIjA3IDEiICIwNyAyIiAiMDggMSIKIyBbMTFdICIwOCAyIiAiMDggMyIgIjA4IDQiICIwOCA1IiAiMDkgMSIgIjA5IDQiICIwOSA1IiAiMTAgMSIgIjEwIDIiICIxMCA0IgojIFsyMV0gIjEwIDUiICIxMSAxIiAiMTEgMyIgIjExIDQiICIxMSA1IiAiMTEgNiIgIjExIDciICIxMiAxIiAiMTIgMyIgIjEyIDUiCiMgWzMxXSAiMTIgNiIgIjEyIDciICIxMyAxIiAiMTMgNSIgIjEzIDYiICIxMyA3IiAiMTMgOCIgIjEzIDkiICIxNCAxIiAiMTQgMyIKIyBbNDFdICIxNCA1IiAiMTQgNiIgIjE0IDciICIxNCA5IiAiMTUgMSIgIjE1IDMiICIxNSA0IiAiMTUgNSIgIjE1IDYiICIxNSA3IgojIFs1MV0gIjE1IDkiICIxNiAxIiAiMTYgNSIgIjE2IDciICIxNiA5IgoKCgoKIyAiMTYgMSIgIjE2IDUiICIxNiA3IiAiMTYgOSIKCiNjb2RpZmljYW1vcyBhIGEgYcOxb3MgZGUgZWR1Y2FjacOzbgpwb2JsYWNpb25fZTk4YzwtcG9ibGFjaW9uX2U5OCU+JQogICBtdXRhdGUoCiAgIGVkdV9hID0gaWZlbHNlKGVkX2Zvcm1hbD09MSAmIGVkX3RlY25pY2E9PTEsMCwgICAgI3NpbiBpbnN0cnVjY2lvbigxKQogICAgICAgICAgaWZlbHNlKChlZF9mb3JtYWwgJWluJSBjKDIsMyw0LDUsNiw3LDgsOSwxMCwxMSwxMiwxMykpCiAgICAgICAgICAgICAgICAgJiAoZWRfdGVjbmljYSAlaW4lIGMoMSwyKSksZWRfZm9ybWFsLTEsCiAgICAgICAgICBpZmVsc2UoZWRfZm9ybWFsPT04ICYgKGVkX3RlY25pY2EgJWluJSBjKDMsNCw1KSksOSwKICAgICAgICAgIGlmZWxzZShlZF9mb3JtYWw9PTkgJiAoZWRfdGVjbmljYSAlaW4lIGMoNCw1KSksMTAsCiAgICAgICAgICBpZmVsc2UoZWRfZm9ybWFsPT0xMCAmIChlZF90ZWNuaWNhICVpbiUgYygyLDQsNSkpLDExLAogICAgICAgICAgaWZlbHNlKGVkX2Zvcm1hbD09MTEgJiAoZWRfdGVjbmljYSAlaW4lIGMoMyw0LDUsNSw3KSksMTIsCiAgICAgICAgICBpZmVsc2UoKGVkX2Zvcm1hbCAlaW4lYygxMikpICYgKGVkX3RlY25pY2EgJWluJSBjKDMsNSw2LDcpKSwxMiwKICAgICAgICAgIGlmZWxzZShlZF9mb3JtYWw9PTEzICYgKGVkX3RlY25pY2EgJWluJSBjKDUsNiw3LDgsOSkpLDEzLAogICAgICAgICAgaWZlbHNlKGVkX2Zvcm1hbD09MTQgJiAoZWRfdGVjbmljYSAlaW4lIGMoMSwzLDUsNiw3LDkpKSwxNCwKICAgICAgICAgIGlmZWxzZShlZF9mb3JtYWw9PTE1ICYgKGVkX3RlY25pY2EgJWluJSBjKDEsMyw0LDUsNiw3LDkpKSwxNywxOSkpKSkpKSkpKSkKICApCgp1bmlxdWUocG9ibGFjaW9uX2U5OGMkZWR1X2EpCgojY29kaWZpY2Ftb3MgYSBjb2dob3J0IGRlIGVkdWNhY2nDs24KCnBvYmxhY2lvbl9lOThjPC1wb2JsYWNpb25fZTk4YyU+JQogICBtdXRhdGUoCiAgIGVkdV9hYyA9IGlmZWxzZShlZHVfYSAlaW4lIDA6NSwiQzEiLCAgICAKICAgICAgICAgIGlmZWxzZShlZHVfYSAlaW4lIDY6MTAgLCJDMiIsCiAgICAgICAgICBpZmVsc2UoZWR1X2EgJWluJSAxMToxMiwiQzMiLAogICAgICAgICAgaWZlbHNlKGVkdV9hICVpbiUgMTM6MTQsIkM0IiwiQzUiKSkpKQogICkKCnVuaXF1ZShwb2JsYWNpb25fZTk4YyRlZHVfYWMgKQoKCmBgYAoKIyMjIENyZWFjaW9uIGRlIHJlZ2lvbgpgYGB7ciBjcmVhX3JlZ2lvbl9lOTh9Cgpwb2JsYWNpb25fZTk4YzwtcG9ibGFjaW9uX2U5OGMlPiUKICAgICAgICAgIG11dGF0ZSgKICAgICAgICAgICAgcmVnaW9uID0gaWZlbHNlKGVzdGFkbyAlaW4lIGMoIjAyIiwiMjYiLCIwOCIsIjA1IiwiMTkiLCIyOCIpLDEsCiAgICAgICAgICAgICAgICBpZmVsc2UoZXN0YWRvICVpbiUgYygiMTIiLCIyMCIsIjA3IiwiMzAiLCIyNyIsIjA0IiwiMzEiLCIyMyIpLDUsMCkpCiAgICAgICAgICApCmBgYAoKCiMjIEluZ3Jlc29zIGVuaWdoIDk4CgoKYGBge3IgaW5ncmVzb3NfZTk4fQppbmdyZXNvczwtcmVhZC5kYmYoCiAgICAgICAgICAgICAgZmlsZT0iRGF0b3MvRU5JR0gtSGlzdG9yaWNhLzE5OTgvaW5ncmVzb3MuZGJmIgogICAgICAgICAgICAgICkKCmZhbWlsaWFzX2ludGVncmFudGVzIDwtIGZ1bmN0aW9uKGRmLG5yKXsKICBkZm4gPC0gZGYgJT4lCiAgICBmaWx0ZXIoTlVNX1JFTiAlaW4lIG5yKQogIHJldHVybihkZm4pCn0gCgoKCmluZ3Jlc29zX2FjdSA8LSBmdW5jdGlvbihkZixjbGF2cyl7CiBkZm4gPC0gZGYgJT4lCiAgIGdyb3VwX2J5KEZPTElPLCBOVU1fUkVOKSAlPiUKICAgZmlsdGVyKENMQVZFICVpbiUgY2xhdnMpJT4lCiAgIHN1bW1hcmlzZSgKICAgY2xhdmVzX2EgPSBwYXN0ZShDTEFWRSxjb2xsYXBzZSA9ICIsIiksCiAgaW5nX3RyaV90ID0gc3VtKElOR19UUkkpLAogIGluZ19tZW5fcCA9IGluZ190cmlfdC8zLAogIGxpbmdfbWVuX3AgPSBsb2coaW5nX21lbl9wKQogICkgJT4lIHVuZ3JvdXAoKQogCiAKIHJldHVybihkZm4pCn0KCiNob2dhcmVzIDwtIGMoIjEiLCIyIiwiMyIsIjQiLCI1IikKcGVyc29uYXNfaCA8LSBjKCcwMScpCgphPC1mYW1pbGlhc19pbnRlZ3JhbnRlcyhpbmdyZXNvcyxwZXJzb25hc19oKQpoZWFkKGEpCmNsYXZlczwtYygiUDAwMSIsIlAwMDIiLCJQMDAzIiwiUDAxMCIsIlAwMTEiLCJQMDEyIiwiUDAxMyIsIlAwMTQiLCJQMDE1IiwgIlAwMTYiLCJQMDE3IiwiUDAxOCIsIlAwMjAiLCJQMDIxIiwiUDAyNiIsIlAwMjciLCJQMDM1IiwiUDA0MCIsIlAwNDEiLCJQMDQyIiwiUDA0NCIsIlAwNDUiKQppbmdyZXNvc19lOTg8LWluZ3Jlc29zX2FjdShhLGNsYXZlcykgCmluZ3Jlc29zX2U5ODwtaW5ncmVzb3NfZTk4JT4lCiAgc2VsZWN0KEZPTElPLE5VTV9SRU4sY2xhdmVzX2EsbGluZ19tZW5fcCklPiUKICByZW5hbWUoCiAgICBmb2xpbyA9IEZPTElPLAogICAgbnVtX3JlbiA9IE5VTV9SRU4KICApCmhlYWQoaW5ncmVzb3NfZTk4KQoKYGBgCgojIyBCYXNlIGNydXphZGEgcG9ibGEtaW5nCgpgYGB7ciBiYXNlX2NydXpfZTk4fQoKZW5pZ2hfOTg8LWZ1bGxfam9pbihwb2JsYWNpb25fZTk4YyxpbmdyZXNvc19lOTgpJT4lCiAgZHJvcF9uYSgpJT4lCiAgIG11dGF0ZSgKICAgICBvY3VwYWNpb24gPSBzdWJzdHIob2N1cGFjaW9uLDEsMikKICAgKSMlPiUKICAjIHJlbmFtZSgKICAjICAgRURVPU5fSU5TVFIxNjEsCiAgIyAgIE9DVSA9IENNTzEyMQogICMgKSU+JQogICMgbXV0YXRlKAogICMgICBFRFUgPSBhcy5jaGFyYWN0ZXIoRURVKQogICMgKQpoZWFkKGVuaWdoXzk4KQoKdW5pcXVlKGVuaWdoXzk4JGVkYWQpCgojIGFqdXN0ZSBwYXJhIG5pdmVsIGRlIGVjdWNhY2nDs24gRVNSVQoKI2RhdGFfcGFkcmVzMjAwNSRFRFUgPC0gZmFjdG9yKGRhdGFfcGFkcmVzMjAwNSRFRFUpCiNkYXRhX3BhZHJlczIwMDUkT0NVIDwtIGZhY3RvcihkYXRhX3BhZHJlczIwMDUkT0NVKQoKI3VuaXF1ZShkYXRhX3BhZHJlczIwMDUkT0NVKQpzdW0oaXMubmEoZW5pZ2hfOTgpKQpgYGAKCiMgRXNsYXRpY2lkYWQgaW50ZWdlbmVyYWNpb25hbCBkZSBpbmdyZXNvcwoKCiMjIERlZmxhY3RhbW9zIGluZ3Jlc29zCgpJTlBDIEZlYiAyMDIxID0gMTEwLjkwNyBbQ29uc3VsdGFdW10KCgpgYGB7cn0KSU5QQzwtMTEwLjkwNwoKZW5pZ2hfOTg8LWVuaWdoXzk4JT4lCiAgbXV0YXRlKAogIGxpbmdfbWVuX3A9bGluZ19tZW5fcC1sb2coSU5QQykKICApCmBgYAoKUG9yIGxhIHBvcmdyYW1hY2nDs24sIHBhcmEgbG9zIGhpam9zLCBzZSBoYWNlIGRlbnRybyBkZWwgc2lndWVpbnRlIHByb2dyYW1hIAoKICBbQ29uc3VsdGFdOiBodHRwczovL3d3dy5iYW54aWNvLm9yZy5teC9TaWVJbnRlcm5ldC9jb25zdWx0YXJEaXJlY3RvcmlvSW50ZXJuZXRBY3Rpb24uZG8/YWNjaW9uPWNvbnN1bHRhckN1YWRybyZpZEN1YWRybz1DUDE1NCZsb2NhbGU9ZXMKCgoKCiMjIEVzdGltYWNpw7NuCgpTaW4gY29udHJvbGFyIHBvciBvY3VwYWNpw7NuIGRlbCBoaWpvCgoKYGBge3IgZnVuX3ByaW5fZWlpfQplaWk8LWZ1bmN0aW9uKGkpewogIAogIAoKIyBCT09TVFJBUCAgCiMgUmVncmVzacOzbiBkZSBpbmdyZXNvcyBkZSBwYWRyZXMgIApyZWdfcGFkcmVzPC1sbSgKICBmb3JtdWxhID0gbGluZ19tZW5fcCB+IGVkdV9hYyArIG9jdXBhY2lvbiArIGVkYWQgK0koZWRhZCplZGFkKSwKICBkYXRhID0gZW5pZ2hfOThbc2FtcGxlKG5yb3coZW5pZ2hfOTgpLG5yb3coZW5pZ2hfOTgpLCByZXBsYWNlID0gVFJVRSksXQopCgojc3VtbWFyeShyZWdfcGFkcmVzKQoKIyBudW1lcm8gZGUgcGFkcmVzIHNpbiBvY3VwYWNpw7NuIHJlcG9ydGFkYSBkZSBoaWpvcwpwX3NvY3U8LXN1bShpcy5uYShkZmhfYyRwcF9vY3VwKSkKI3Bfc29jdQoKCmRmaF9jbmE8LWRmaF9jJT4lZHJvcF9uYShwcF9vY3VwKQoKIyBkYWZyYW1lIHBhcmEgZXN0aW1hciBpbmdyZXNvIHBhZHJlcwpkYXRhPC0gZGF0YS5mcmFtZSgKICAgZWR1X2FjPSBkZmhfY25hJHBwX2VkdWNfYWMsCiAgIG9jdXBhY2lvbj0gZGZoX2NuYSRwcF9vY3VwLAogICBlZGFkID0gMAogICkKCiMgQk9PU1RSQVAgaW5ncmVzbyBISUpPUwoKIyBjYWxjdWxhbW9zIGVsIGluZ3Jlc28gZGUgbG9zIGhpam9zIGNvbiBsb3MgZ2VtZWxvcwojIHJlLXNhbXBsZWFkb3MsIGFkZW1hcyBjb2RpZmljYW1vcyBsYSBvY3VwYWNpw7NuIGRlbCBoaWpvIGEgZG9zIGNhcmFjdGVyZXMKCmF1eHM8LWZ1bmN0aW9uKGspewogIHNhbXBsZShrLHNpemU9bGVuZ3RoKGspLHJlcGxhY2U9VFJVRSkKfQoKZGZoX2NuYSA8LSBkZmhfY25hICU+JQogIG11dGF0ZSgKICAgb2N1X2hjPSBzdWJzdHJpbmcob2N1X2gsMSwyKSwKICAgaW5nX2g9dW5saXN0KGxhcHBseSgKICAgICAgICAgICAgICAgICAgICAgIGxhcHBseShpbmdfaCxhdXhzKSwKICAgICAgICAgICAgICAgICAgICAgIG1lYW4KICAgICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICksCiAgIGxpbmdfaCA9IGxvZyhpbmdfaCktbG9nKElOUEMpCiAgKQoKZGZoX2Y8LWRmaF9jbmElPiUKICBtdXRhdGUoY29ob3J0X2UgPSBpZmVsc2UoaW5nX2g8PTI0MDAsMSwKICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoaW5nX2g8PTQ4MDAsMiwKICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoaW5nX2g8PTcyMDAsMywKICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoaW5nX2g8PTEyMDAwLDQsICAgICAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoaW5nX2g8PTI0MDAwLDUsNikpKSkpLAogICAgICAgICBjb2hvcnRfZGlmPWNvaG9ydC1jb2hvcnRfZSkKCiAgCiNkZmhfY25hCiNkZmhfY25hJG9jdV9oaWpvCiNkZmhfY25hJGxpbmdfaAoKI3N0cihzdWJzdHIoZGZoX2NuYSRvY3VfaCwxLDIpKQoKIyBlc3RpbWFjacOzbiBpbmdyZXNvIHBhZHJlcwojIGlucHV0YW1vcyBhbCBoaWpvIGNvcnJlc3BvbmRpZW50ZQoKZGZocGY8LSBkZmhfZiU+JQogIG11dGF0ZShsaW5nX3AgPSBwcmVkaWN0KAogICAgb2JqZWN0ID0gcmVnX3BhZHJlcywgICAKICAgIG5ld2RhdGEgPSBkYXRhKSkgCiNkZmhwZgoKIyBFbGFzdGljaWRhZCBpbnRlcmdlbmVhY2lvbmFsIGRlbCBpbmdyZXNvCgpyZWdfaHA8LWxtKAogIGZvcm11bGEgPSBsaW5nX2ggfiBsaW5nX3AgKyBlZGFkX2grIEkoZWRhZF9oKmVkYWRfaCksIysgb2N1X2hjLAogIGRhdGEgPSBkZmhwZgopCiNzdW1tYXJ5KHJlZ19ocCkKYmV0YSA8LSByZWdfaHAkY29lZmZpY2llbnRzWzJdCmNvaG9ydF9kaWY8LWFzLmludGVnZXIoZGZocGYlPiVjb3VudChjb2hvcnRfZGlmKSU+JQogICAgICAgICAgICAgICAgICAgZmlsdGVyKGNvaG9ydF9kaWY9PTApJT4lCiAgICAgICAgICAgICAgICAgc2VsZWN0KG4pKQoKcmV0dXJuKGRhdGEuZnJhbWUoKSU+JXN1bW1hcmlzZSgKICBjb2hvcnRfZGlmPWNvaG9ydF9kaWYsCiAgYmV0YT1iZXRhKSkKCn0Kc2V0LnNlZWQoMTIzKQphPC1sYXBwbHkoMToxNTAwLGVpaSkKcmVzdWw8LWJpbmRfcm93cyhhWzE6bGVuZ3RoKGEpXSkKaGVhZChyZXN1bCkKbWVhbihyZXN1bCRiZXRhKQpzZChyZXN1bCRiZXRhKQpoaXN0KHJlc3VsJGJldGEpCmBgYAoKCmBgYHtyIGhpdF9uMH0KaGlzdChyZXN1bCRjb2hvcnRfZGlmKQptZWFuKHJlc3VsJGNvaG9ydF9kaWYpCgpgYGAKCgoK</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Estimacion.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
