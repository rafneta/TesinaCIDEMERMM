<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Rafael Martínez Martínez" />


<title>Estiamcion</title>

<script src="site_libs/header-attrs-2.5/header-attrs.js"></script>
<script src="site_libs/jquery-3.5.0/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<script src="site_libs/navigation-1.1/sourceembed.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="site_libs/anchor-sections-1.0/anchor-sections.js"></script>
<script src="site_libs/htmlwidgets-1.5.3.9000/htmlwidgets.js"></script>
<script src="site_libs/proj4js-2.3.15/proj4.js"></script>
<link href="site_libs/highcharts-8.1.2/css/motion.css" rel="stylesheet" />
<script src="site_libs/highcharts-8.1.2/highcharts.js"></script>
<script src="site_libs/highcharts-8.1.2/highcharts-3d.js"></script>
<script src="site_libs/highcharts-8.1.2/highcharts-more.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/stock.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/map.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/annotations.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/data.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/drilldown.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/item-series.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/offline-exporting.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/overlapping-datalabels.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/exporting.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/export-data.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/funnel.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/heatmap.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/treemap.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/sankey.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/dependency-wheel.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/organization.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/solid-gauge.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/streamgraph.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/sunburst.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/vector.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/wordcloud.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/xrange.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/tilemap.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/venn.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/gantt.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/timeline.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/parallel-coordinates.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/bullet.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/coloraxis.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/dumbbell.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/lollipop.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/series-label.js"></script>
<script src="site_libs/highcharts-8.1.2/plugins/motion.js"></script>
<script src="site_libs/highcharts-8.1.2/custom/reset.js"></script>
<script src="site_libs/highcharts-8.1.2/modules/boost.js"></script>
<script src="site_libs/highchart-binding-0.8.2/highchart.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
#rmd-source-code {
  display: none;
}
</style>

<link rel="stylesheet" href="estilo.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Tesina CIDE-ME Rafael Martínez-Martínez</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="Estimacion.html">Estimación</a>
</li>
<li>
  <a href="ESRU2017.html">Datos ESRU - EMOVI 2017</a>
</li>
<li>
  <a href="MMSI2016.html">Datos MMSI 2016</a>
</li>
<li>
  <a href="ENIGH2016.html">Datos ENIGH 2016</a>
</li>
<li>
  <a href="hijos.html">Ingreso Hijos </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">

<div class="btn-group pull-right">
<button type="button" class="btn btn-default btn-xs dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
<li role="separator" class="divider"></li>
<li><a id="rmd-download-source" href="#">Download Rmd</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Estiamcion</h1>
<h4 class="author">Rafael Martínez Martínez</h4>

</div>


<pre class="r"><code>library(tidyverse)
library(haven) # importa, entre otros software, de Stata
library(sjlabelled) # manejar labels de las variables 
library(openxlsx) # leer archivos de excel
library(DT) # visualizar a tablas
library(data.table) # convertir a tablas
library(highcharter) # gráficas interactivas
library(foreign)</code></pre>
<div id="funciones-de-carga" class="section level1" number="1">
<h1 number="1"><span class="header-section-number">1</span> Funciones de carga</h1>
<pre class="r"><code>cargar_esru&lt;- function(){

return(read_stata(
                     path = &quot;Datos/ESRU-EMOVI-2017/ESRU-EMOVI-2017-Entrevistado.dta&quot;,
                     atomic.to.fac = TRUE,
                     enc = NULL,
                     ))
}</code></pre>
<pre class="r"><code>cargar_enigh&lt;- function(docu){

return(read_stata(
                     path = paste(&quot;Datos/ENIGH-2016/&quot;,docu,&quot;.dta&quot;,sep=&quot;&quot;),
                     atomic.to.fac = TRUE,
                     enc = NULL,
                     ))
}

cargar_enigh_sav&lt;- function(docu){

return(read_spss(
                     path = paste(&quot;Datos/ENIGH-2016/&quot;,docu,&quot;.sav&quot;,sep=&quot;&quot;),
                     atomic.to.fac = TRUE,
                     enc = NULL,
                     ))
}</code></pre>
</div>
<div id="filtrar-hijos-esru" class="section level1" number="2">
<h1 number="2"><span class="header-section-number">2</span> Filtrar hijos ESRU</h1>
<div id="creamos-per-movilidad" class="section level2" number="2.1">
<h2 number="2.1"><span class="header-section-number">2.1</span> Creamos per movilidad</h2>
<pre class="r"><code>data_emovi2017&lt;-cargar_esru()

data_emovi2017&lt;-data_emovi2017%&gt;%
  mutate(mov = ifelse(p147&gt;p148,&quot;mejor&quot;,
                      ifelse(p147&lt;p148,&quot;peor&quot;,&quot;igual&quot;)),
         id_ho = as.integer(row.names(data_emovi2017)))
data_emovi2017$mov&lt;-set_labels(
                          data_emovi2017$mov,
                          labels = c(&quot;mejor&quot; = &quot;mejor&quot;,
                                     &quot;peor&quot; = &quot;peor&quot;,
                                     &quot;igual&quot; = &quot;igual&quot;))</code></pre>
</div>
<div id="cramos-cohort" class="section level2" number="2.2">
<h2 number="2.2"><span class="header-section-number">2.2</span> Cramos cohort</h2>
</div>
<div id="seleccion-de-hijos" class="section level2" number="2.3">
<h2 number="2.3"><span class="header-section-number">2.3</span> seleccion de hijos</h2>
<p>Criterios de filtrado - pregunta p2, comparten el mimso gasto para comer: 1 ) Si 2 ) No - pregunta 5 Edades entre 25 y 45 años - pregunta p08, es el jefe del hogar: 1 ) jefe 2) cónyuge NO IMPLEMENTADO - pregunta p12, actualmente estudia, 1)Si 2)No - p26 Había un jefe de hogar en la infancia (1 padre 2 madre) - p43 y p43m Reporta educación del padre o madre priciapl - p68, Personas que trabajan, 1. Si, 2. No - p69 si trabaja pero la semana pasada no - p132 numero de personas que aportan ingreso - p133 cohort de todas las personas y todos los ingresos (1 ingreso)</p>
<p>Variables de selección para estimar ingreso</p>
<ul>
<li><p>Estado</p></li>
<li><p>pregunta 5, edad</p></li>
<li><p>pregunta 6, sexo</p></li>
<li><p>Pregunta 13, nivel de escuela</p></li>
<li><p>p76 ocupación –SINCO3 codificación ocupación entrevistado</p></li>
<li><p>p133 cohort de todas las personas y todos los ingresos</p></li>
</ul>
<pre class="r"><code># pensamos que los datos se leeen como factores cando corresponda, si se leen como enteros no debe hacerse el casting
#data_emovi2017&lt;-datos_e
hijos &lt;- data_emovi2017 %&gt;%
  filter(p02 == 1)  %&gt;% #compartir gasot para comer
  filter(between(p05,25,40)) %&gt;% # edad
  #filter(p08 == 1)  %&gt;% 
  filter(p12 == 2)  %&gt;% # ya no estudia
  filter(p26 == 1 | p26==2 ) %&gt;% # sosten principal papa, mama, 
   filter((!is.na(p43) &amp; p43!=98 &amp; p26 == 1 ) |
            (!is.na(p43m) &amp; p43m!=98  &amp; p26 == 2 )) %&gt;% # reporta educación de pp
   filter(!is.na(p13))%&gt;% #  reporta educación
  filter(SINCO3 !=&quot;&quot;) %&gt;%# reporta oficio actual
   filter(p68 == 1 | p69 == 1)  %&gt;% # si trabaja
   filter(p132 %in% c(1)) %&gt;%# persona que aportan ingreso
  filter(!p133 %in% c(8,9,NA) ) # reporta ingresos
                                # no estan los ingresos  hogar aislados. 

#edad_promedio_padres &lt;- mean(hijos$p38_11, na.rm = TRUE)
#edad_promedio_padres-21

str(hijos$p02)</code></pre>
<pre><code>##  Factor w/ 2 levels &quot;1&quot;,&quot;2&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  - attr(*, &quot;labels&quot;)= Named num [1:2] 1 2
##   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;SÃ­&quot; &quot;No&quot;
##  - attr(*, &quot;label&quot;)= chr &quot;p02 Personas en vivienda comparten un mismo gasto para comer&quot;</code></pre>
<pre class="r"><code>unique(hijos$p43)</code></pre>
<pre><code>##  [1] 11   2    6    &lt;NA&gt; 98   4    3    8    5    7    10   12   9    1   
## Levels: 1 2 3 4 5 6 7 8 9 10 11 12 98</code></pre>
</div>
<div id="hijos-seleccionados" class="section level2" number="2.4">
<h2 number="2.4"><span class="header-section-number">2.4</span> hijos seleccionados</h2>
<p>Hacemos un cohort del 1 y el 2</p>
<pre class="r"><code>var&lt;-c(&quot;Estado&quot;,&quot;p05&quot;,&quot;p06&quot;,&quot;p13&quot;,&quot;SINCO3&quot;,&quot;p133&quot;,&quot;mov&quot;,&quot;id_ho&quot;,&quot;region&quot;)
hijos_para_sal&lt;-hijos%&gt;%
  select(var)%&gt;%
  mutate(p133 = ifelse(p133==1,2,p133)-1)# juntamos el cohort 1 y 2 

hijos_para_sal &lt;- hijos_para_sal%&gt;%
            mutate(estrato = ifelse(p133 %in% c(1,2),1,
                                    ifelse(p133 %in% c(3),2,
                                           ifelse(p133 %in% c(4,5),3,4))))


#sum(hijos_para_sal$p133==1)

nrow(hijos_para_sal)</code></pre>
<pre><code>## [1] 1131</code></pre>
<pre class="r"><code>saveRDS(hijos_para_sal, file=&quot;Datos/hijos_emovi2017.Rda&quot;)</code></pre>
</div>
</div>
<div id="hijos-construcción-ingresos" class="section level1" number="3">
<h1 number="3"><span class="header-section-number">3</span> Hijos construcción ingresos</h1>
<pre class="r"><code>poblacion_e16&lt;-cargar_enigh_sav(&quot;poblacion&quot;) 
trabajos_e16&lt;-cargar_enigh_sav(&quot;trabajos&quot;)
ingresos_e16&lt;-cargar_enigh_sav(&quot;ingresos&quot;)</code></pre>
<div id="poblacion-enigh-16" class="section level2" number="3.1">
<h2 number="3.1"><span class="header-section-number">3.1</span> poblacion enigh 16</h2>
<pre class="r"><code>poblacion_e16f&lt;- poblacion_e16%&gt;%
  #filter(asis_esc == &quot;2&quot;)%&gt;% # ya no asiste a la escuela
  select(folioviv,foliohog,numren,sexo,edad,nivelaprob)%&gt;%
  filter(between(as.integer(edad),25,40))
# no filtramos por jefe de hogar

nrow(poblacion_e16f)</code></pre>
<pre><code>## [1] 58884</code></pre>
<pre class="r"><code>sum(is.na(poblacion_e16f))</code></pre>
<pre><code>## [1] 0</code></pre>
</div>
<div id="trabajos-enigh-16" class="section level2" number="3.2">
<h2 number="3.2"><span class="header-section-number">3.2</span> trabajos enigh 16</h2>
<p>Filtrams los trabajos</p>
<pre class="r"><code>trabajos_e16f&lt;-trabajos_e16%&gt;%
select(folioviv,foliohog,numren)#%&gt;%
 # filter(!is.na(sinco))
NROW(trabajos_e16f)</code></pre>
<pre><code>## [1] 132095</code></pre>
<pre class="r"><code>#NROW(trabajos)
sum(is.na(trabajos_e16f))</code></pre>
<pre><code>## [1] 0</code></pre>
</div>
<div id="ingresos-enigh-2016" class="section level2" number="3.3">
<h2 number="3.3"><span class="header-section-number">3.3</span> Ingresos enigh 2016</h2>
<pre class="r"><code>familias_integrantes_e16 &lt;- function(df,folhog,nr){
  dfn &lt;- df %&gt;%
    filter(foliohog %in% folhog)%&gt;%
    filter(numren %in% nr)
  return(dfn)
} 



ingresos_acu_e16 &lt;- function(df,clavs=get_labels(ingresos_e16$clave)){
 dfn &lt;- df %&gt;%
   group_by(folioviv, foliohog, numren) %&gt;%
   filter(clave %in% clavs)%&gt;%
   summarise(
   claves_a = paste(clave,collapse = &quot;,&quot;),
  ing_tri_t = sum(ing_tri),
  ing_men_p = ing_tri_t/3
  ) %&gt;% ungroup()
 
 
 return(dfn)
}

hogares &lt;- c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;)
personas_h &lt;- c(&#39;01&#39;,&#39;02&#39;,&#39;03&#39;,&#39;04&#39;,&#39;05&#39;)

a&lt;-familias_integrantes_e16(ingresos_e16,hogares,personas_h)
head(a)</code></pre>
<pre><code>##     folioviv foliohog numren clave mes_1 mes_2 mes_3 mes_4 mes_5 mes_6 ing_1
## 1 0100003801        1     02  P009                                      7500
## 2 0100003801        1     01  P001    09    08    07    06    05    04 18000
## 3 0100003801        1     02  P001    09    08    07    06    05    04 15000
## 4 0100003801        1     01  P009                                      6000
## 5 0100003802        1     02  P040    10    09    08    07    06    05     0
## 6 0100003802        1     02  P009                                     19000
##   ing_2 ing_3 ing_4 ing_5 ing_6  ing_tri
## 1    NA    NA    NA    NA    NA  1844.26
## 2 18000 18000 18000 18000 18000 53114.75
## 3 15000 15000 15000 15000 15000 44262.29
## 4    NA    NA    NA    NA    NA  1475.40
## 5     0     0     0  5000     0  2459.01
## 6    NA    NA    NA    NA    NA  4672.13</code></pre>
<pre class="r"><code>claves&lt;-c(&quot;P001&quot;,&quot;P002&quot;,&quot;P003&quot;,&quot;P011&quot;,&quot;P023&quot;,&quot;P024&quot;,&quot;P054&quot;,&quot;P055&quot;,&quot;P056&quot;, &quot;P059&quot;,&quot;P060&quot;,&quot;P061&quot;,&quot;P063&quot;,&quot;P068&quot;,&quot;P060&quot;,&quot;P070&quot;,&quot;P071&quot;,&quot;P072&quot;,&quot;P073&quot;,&quot;P074&quot;,&quot;P075&quot;,&quot;P076&quot;,&quot;P077&quot;,&quot;P078&quot;,&quot;P079&quot;,&quot;P080&quot;)
ingresos_e16a&lt;-ingresos_acu_e16(a,claves) 
ingresos_e16a</code></pre>
<pre><code>## # A tibble: 104,236 x 6
##    folioviv   foliohog numren claves_a  ing_tri_t ing_men_p
##    &lt;chr&gt;      &lt;chr&gt;    &lt;chr&gt;  &lt;chr&gt;         &lt;dbl&gt;     &lt;dbl&gt;
##  1 0100003801 1        01     P001         53115.    17705.
##  2 0100003801 1        02     P001         44262.    14754.
##  3 0100003802 1        01     P001         47213.    15738.
##  4 0100003802 1        02     P001         44262.    14754.
##  5 0100003803 1        01     P001         82623.    27541.
##  6 0100003804 1        01     P001         29508.     9836.
##  7 0100003804 1        02     P001          3934.     1311.
##  8 0100003805 1        01     P001         35410.    11803.
##  9 0100010401 1        03     P063,P001     8560.     2853.
## 10 0100010401 1        04     P001         20837.     6946.
## # … with 104,226 more rows</code></pre>
</div>
<div id="base-cruzada-pob-tra" class="section level2" number="3.4">
<h2 number="3.4"><span class="header-section-number">3.4</span> Base cruzada pob-tra</h2>
<pre class="r"><code>enigh_16&lt;- full_join(poblacion_e16f,trabajos_e16f)%&gt;%
   drop_na()
#enigh&lt;-full_join(enigh,concentrado)%&gt;%
 # drop_na()
nrow(enigh_16)</code></pre>
<pre><code>## [1] 63108</code></pre>
<pre class="r"><code>sum(is.na(enigh_16))</code></pre>
<pre><code>## [1] 0</code></pre>
</div>
<div id="cambio-etiquetado" class="section level2" number="3.5">
<h2 number="3.5"><span class="header-section-number">3.5</span> Cambio etiquetado</h2>
<p>Pasamos las etiqeuteas de educación de emovi a</p>
<pre class="r"><code>hijos_emovi &lt;- readRDS(file=&quot;Datos/hijos_emovi2017.Rda&quot;)
hijos_emovi&lt;- hijos_emovi %&gt;%
  mutate(p13_m = ifelse(p13 %in% c(1),&quot;1&quot;,
                      ifelse( p13 == 2,&quot;2&quot;,
                      ifelse(p13 %in% c(3,4),&quot;3&quot;,
                      ifelse( p13 %in% c(5,6),&quot;4&quot;,
                      ifelse(p13 %in% c(7,8),&quot;6&quot;,
                      ifelse(p13 %in% c(9,10),&quot;5&quot;,
                      ifelse(p13==11,&quot;7&quot;,
                      ifelse(p13==12,&quot;8&quot;,&quot;0&quot;)))))))))
unique(hijos_emovi$p13_m)</code></pre>
<pre><code>## [1] &quot;4&quot; &quot;3&quot; &quot;7&quot; &quot;2&quot; &quot;5&quot; &quot;6&quot; &quot;8&quot; &quot;0&quot;</code></pre>
<pre class="r"><code>enigh_16&lt;-enigh_16%&gt;%
  mutate(nivelaprob=ifelse(nivelaprob==&quot;9&quot;,&quot;8&quot;,nivelaprob))

enigh_16f&lt;-enigh_16%&gt;%
  filter(nivelaprob %in% unique(hijos_emovi$p13_m))

nrow(enigh_16f)</code></pre>
<pre><code>## [1] 63057</code></pre>
</div>
<div id="buscar-folios-con-caracteristicas" class="section level2" number="3.6">
<h2 number="3.6"><span class="header-section-number">3.6</span> Buscar folios con caracteristicas</h2>
<pre class="r"><code>busca&lt;-function(i){
return(enigh_16f%&gt;%
  filter(
    as.integer(substr(folioviv,1,2))==hijos_emovi[i,]$Estado &amp;
    sexo == hijos_emovi[i,]$p06 &amp;
    edad == hijos_emovi[i,]$p05 &amp;
    #sinco == hijos_emovi[i,]$SINCO3 &amp;
    nivelaprob == hijos_emovi[i,]$p13_m)%&gt;%
  select(folioviv,foliohog))
}

  
a&lt;-lapply(1:nrow(hijos_emovi), busca)

contador&lt;-0
for(i in 1:nrow(hijos_emovi))
{if(nrow(a[[i]])&gt;0)
  contador&lt;-contador +1
}
contador</code></pre>
<pre><code>## [1] 1077</code></pre>
<pre class="r"><code>saveRDS(a, file=&quot;Datos/folhijos_enigh16_emovi.Rda&quot;)</code></pre>
<p>Del total, 1077 personas tienen gemelos</p>
<div id="filtamos-solo-los-hijos-encontrados" class="section level3" number="3.6.1">
<h3 number="3.6.1"><span class="header-section-number">3.6.1</span> filtamos solo los hijos encontrados</h3>
<pre class="r"><code># etiquetamos para no perder la numeracion respecto a los hijos originales
folhijos_e16_emovi &lt;- readRDS(file=&quot;Datos/folhijos_enigh16_emovi.Rda&quot;)
names(folhijos_e16_emovi) &lt;- as.character(1:nrow(hijos_emovi))
length(folhijos_e16_emovi)</code></pre>
<pre><code>## [1] 1131</code></pre>
<pre class="r"><code>L &lt;- c()
for(i in 1:length(folhijos_e16_emovi)){
  if(!(nrow(folhijos_e16_emovi[[i]])&gt;0)){
    L&lt;-c(L,i)}
}
# Solo hijos que se les pudo encontrar en enigh-2016 1077/1131
folhijos_e16_emovif&lt;-folhijos_e16_emovi[-L]
    

length(folhijos_e16_emovif)</code></pre>
<pre><code>## [1] 1077</code></pre>
<pre class="r"><code>#names(folhijos_emovif)
#names(folhijos_emovi)</code></pre>
</div>
<div id="unicos-folios-diferentes-trabajos" class="section level3" number="3.6.2">
<h3 number="3.6.2"><span class="header-section-number">3.6.2</span> Unicos folios, diferentes trabajos</h3>
<pre class="r"><code>unicos_folios&lt;-function(i){
folhijos_e16_emovif[[i]]%&gt;%
  distinct()
}

# filtramos unicos folios por diferentes trabajos de la misma persona
a&lt;-lapply(1:length(folhijos_e16_emovif), unicos_folios)
names(a)&lt;-names(folhijos_e16_emovif)
length(a)</code></pre>
<pre><code>## [1] 1077</code></pre>
<pre class="r"><code>folhijos_e16_emovif&lt;-a</code></pre>
</div>
<div id="observamos-las-edades-de-los-encontrados" class="section level3" number="3.6.3">
<h3 number="3.6.3"><span class="header-section-number">3.6.3</span> Observamos las edades de los encontrados</h3>
<pre class="r"><code>myMenuItems &lt;- c(&quot;downloadPNG&quot;, &quot;downloadJPEG&quot;, &quot;downloadPDF&quot;, &#39;downloadSVG&#39;, &#39;printChart&#39;)

hijos_emovi%&gt;%
  slice(as.integer(names(folhijos_e16_emovif)))%&gt;%
  select(p05)%&gt;%
  count(p05)%&gt;%
    hchart(&#39;column&#39;,
         hcaes( y = &#39;n&#39;))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;&quot;
  ) %&gt;%
  #hc_subtitle(text = &quot;Las edades están agrupadas en intervalos 
   #           de 10 años (da clic sobre F o M)&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Número de participantes&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Número de personas&quot;),
           categories = as.character(25:40)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))</code></pre>
<div id="htmlwidget-0d5fad66f6d970104a2d" style="width:100%;height:500px;" class="highchart html-widget"></div>
<script type="application/json" data-for="htmlwidget-0d5fad66f6d970104a2d">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":""},"yAxis":{"title":{"text":"Número de participantes"}},"credits":{"enabled":false},"exporting":{"enabled":true,"filename":"datos","buttons":{"contextButton":{"menuItems":["downloadPNG","downloadJPEG","downloadPDF","downloadSVG","printChart"]}}},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"showInLegend":false},"treemap":{"layoutAlgorithm":"squarified"},"scatter":{"marker":{"symbol":"circle"}}},"series":[{"group":"group","data":[{"p05":25,"n":94,"y":94},{"p05":26,"n":53,"y":53},{"p05":27,"n":69,"y":69},{"p05":28,"n":81,"y":81},{"p05":29,"n":56,"y":56},{"p05":30,"n":84,"y":84},{"p05":31,"n":57,"y":57},{"p05":32,"n":66,"y":66},{"p05":33,"n":47,"y":47},{"p05":34,"n":58,"y":58},{"p05":35,"n":94,"y":94},{"p05":36,"n":54,"y":54},{"p05":37,"n":62,"y":62},{"p05":38,"n":65,"y":65},{"p05":39,"n":58,"y":58},{"p05":40,"n":79,"y":79}],"type":"column"}],"xAxis":{"title":{"text":"Número de personas"},"categories":["25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40"]}},"theme":{"colors":["#00AACC","#FF4E00","#B90000","#5F9B0A","#CD6723"],"chart":{"backgroundColor":{"linearGradient":[0,0,0,150],"stops":[[0,"#CAE1F4"],[1,"#EEEEEE"]]},"style":{"fontFamily":"Open Sans"}},"title":{"align":"left"},"subtitle":{"align":"left"},"legend":{"align":"right","verticalAlign":"bottom"},"xAxis":{"gridLineWidth":1,"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"yAxis":{"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1}},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","drillUpText":"Back to {series.name}","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"thousandsSep":" ","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":"Open+Sans","debug":false},"evals":[],"jsHooks":[]}</script>
</div>
<div id="observamos-las-estados-de-los-encontrados" class="section level3" number="3.6.4">
<h3 number="3.6.4"><span class="header-section-number">3.6.4</span> Observamos las estados de los encontrados</h3>
<pre class="r"><code>hijos_emovi%&gt;%
  slice(as.integer(names(folhijos_e16_emovif)))%&gt;%
  count(Estado)%&gt;%
    hchart(&#39;column&#39;,
         hcaes( y = &#39;n&#39;))%&gt;%
  hc_add_theme(hc_theme_ffx())%&gt;%
  hc_title(
    text = &quot;&quot;
  ) %&gt;%
  #hc_subtitle(text = &quot;Las edades están agrupadas en intervalos 
   #           de 10 años (da clic sobre F o M)&quot;) %&gt;%
  # hc_credits(
  #  enabled = TRUE, text = &quot;Source: SSS&quot;,
  #  style = list(fontSize = &quot;12px&quot;))%&gt;%
  hc_yAxis(title = list(text = &quot;Número de participantes&quot;))%&gt;%
  hc_xAxis(title=list(text=&quot;Número de personas&quot;),
           categories = get_labels(hijos_emovi$Estado)) %&gt;%
    hc_exporting(enabled = TRUE,
               filename = &quot;datos&quot;,
               buttons = list(contextButton = list(menuItems = myMenuItems)))</code></pre>
<div id="htmlwidget-f3dd71e96f58e2e6b377" style="width:100%;height:500px;" class="highchart html-widget"></div>
<script type="application/json" data-for="htmlwidget-f3dd71e96f58e2e6b377">{"x":{"hc_opts":{"chart":{"reflow":true},"title":{"text":""},"yAxis":{"title":{"text":"Número de participantes"}},"credits":{"enabled":false},"exporting":{"enabled":true,"filename":"datos","buttons":{"contextButton":{"menuItems":["downloadPNG","downloadJPEG","downloadPDF","downloadSVG","printChart"]}}},"boost":{"enabled":false},"plotOptions":{"series":{"label":{"enabled":false},"turboThreshold":0,"showInLegend":false},"treemap":{"layoutAlgorithm":"squarified"},"scatter":{"marker":{"symbol":"circle"}}},"series":[{"group":"group","data":[{"Estado":"1","n":30,"y":30},{"Estado":"2","n":12,"y":12},{"Estado":"3","n":50,"y":50},{"Estado":"4","n":30,"y":30},{"Estado":"5","n":30,"y":30},{"Estado":"6","n":26,"y":26},{"Estado":"7","n":39,"y":39},{"Estado":"8","n":38,"y":38},{"Estado":"9","n":253,"y":253},{"Estado":"10","n":27,"y":27},{"Estado":"11","n":31,"y":31},{"Estado":"12","n":15,"y":15},{"Estado":"13","n":27,"y":27},{"Estado":"14","n":34,"y":34},{"Estado":"15","n":24,"y":24},{"Estado":"16","n":26,"y":26},{"Estado":"17","n":20,"y":20},{"Estado":"18","n":20,"y":20},{"Estado":"19","n":47,"y":47},{"Estado":"20","n":20,"y":20},{"Estado":"21","n":12,"y":12},{"Estado":"22","n":13,"y":13},{"Estado":"23","n":23,"y":23},{"Estado":"24","n":33,"y":33},{"Estado":"25","n":22,"y":22},{"Estado":"26","n":31,"y":31},{"Estado":"27","n":21,"y":21},{"Estado":"28","n":40,"y":40},{"Estado":"29","n":10,"y":10},{"Estado":"30","n":18,"y":18},{"Estado":"31","n":23,"y":23},{"Estado":"32","n":32,"y":32}],"type":"column"}],"xAxis":{"title":{"text":"Número de personas"},"categories":["Aguascalientes","Baja California","Baja California Sur","Campeche","Coahuila de Zaragoza","Colima","Chiapas","Chihuahua","Distrito Federal","Durango","Guanajuato","Guerrero","Hidalgo","Jalisco","México","Michoacán de Ocampo","Morelos","Nayarit","Nuevo León","Oaxaca","Puebla","Querétaro","Quintana Roo","San Luis Potosí","Sinaloa","Sonora","Tabasco","Tamaulipas","Tlaxcala","Veracruz de Ignacio de la Llave","Yucatán","Zacatecas"]}},"theme":{"colors":["#00AACC","#FF4E00","#B90000","#5F9B0A","#CD6723"],"chart":{"backgroundColor":{"linearGradient":[0,0,0,150],"stops":[[0,"#CAE1F4"],[1,"#EEEEEE"]]},"style":{"fontFamily":"Open Sans"}},"title":{"align":"left"},"subtitle":{"align":"left"},"legend":{"align":"right","verticalAlign":"bottom"},"xAxis":{"gridLineWidth":1,"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1},"yAxis":{"gridLineColor":"#F3F3F3","lineColor":"#F3F3F3","minorGridLineColor":"#F3F3F3","tickColor":"#F3F3F3","tickWidth":1}},"conf_opts":{"global":{"Date":null,"VMLRadialGradientURL":"http =//code.highcharts.com/list(version)/gfx/vml-radial-gradient.png","canvasToolsURL":"http =//code.highcharts.com/list(version)/modules/canvas-tools.js","getTimezoneOffset":null,"timezoneOffset":0,"useUTC":true},"lang":{"contextButtonTitle":"Chart context menu","decimalPoint":".","downloadJPEG":"Download JPEG image","downloadPDF":"Download PDF document","downloadPNG":"Download PNG image","downloadSVG":"Download SVG vector image","drillUpText":"Back to {series.name}","invalidDate":null,"loading":"Loading...","months":["January","February","March","April","May","June","July","August","September","October","November","December"],"noData":"No data to display","numericSymbols":["k","M","G","T","P","E"],"printChart":"Print chart","resetZoom":"Reset zoom","resetZoomTitle":"Reset zoom level 1:1","shortMonths":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"thousandsSep":" ","weekdays":["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]}},"type":"chart","fonts":"Open+Sans","debug":false},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="ingreso-hijo-enigh16-emovi" class="section level2" number="3.7">
<h2 number="3.7"><span class="header-section-number">3.7</span> Ingreso hijo enigh16-emovi</h2>
<pre class="r"><code>ingreso_hijo_e16_emovi&lt;-function(i){
  ingresos_e16a%&gt;%
  filter(folioviv %in% folhijos_e16_emovif[[i]]$folioviv &amp;
    foliohog %in% folhijos_e16_emovif[[i]]$foliohog)%&gt;%summarise(
     id_hijo = names(folhijos_e16_emovif[i]),
     id_ho = hijos_emovi[as.integer(names(folhijos_e16_emovif[i])),&quot;id_ho&quot;],
     mov= hijos_emovi[as.integer(names(folhijos_e16_emovif[i])),&quot;mov&quot;],
     regionh = hijos_emovi[as.integer(names(folhijos_e16_emovif[i])),&quot;region&quot;],
     edad = hijos_emovi[as.integer(names(folhijos_e16_emovif[i])),&quot;p05&quot;],
      ing_men_p_h =list(ing_men_p),
     cohort = hijos_emovi[as.integer(names(folhijos_e16_emovif[i])),&quot;p133&quot;],
    estrato = hijos_emovi[as.integer(names(folhijos_e16_emovif[i])),&quot;estrato&quot;],
    estado = hijos_emovi[as.integer(names(folhijos_e16_emovif[i])),&quot;Estado&quot;],
    sexo = hijos_emovi[as.integer(names(folhijos_e16_emovif[i])),&quot;p06&quot;]
     )
}
#273,332 son vacios
# ingreso hijo pero ualgunos no podrian estar por no tener registro de salario

a&lt;-lapply(1:length(folhijos_e16_emovif), ingreso_hijo_e16_emovi)
ingreso_hijog_e16_emovi&lt;-a
length(ingreso_hijog_e16_emovi)</code></pre>
<pre><code>## [1] 1077</code></pre>
<pre class="r"><code>ingreso_hijog_e16_emovi[[332]]</code></pre>
<pre><code>## # A tibble: 1 x 10
##   id_hijo id_ho mov   regionh  edad ing_men_p_h cohort estrato estado sexo 
##   &lt;chr&gt;   &lt;int&gt; &lt;chr&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;list&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;
## 1 355      5759 mejor 4          27 &lt;dbl [0]&gt;        1       1 9      2</code></pre>
<pre class="r"><code>x&lt;-ingreso_hijog_e16_emovi[[332]]$ing_men_p_h[1]
sum(ingreso_hijog_e16_emovi[[332]]$ing_men_p_h[[1]],na.rm = TRUE)</code></pre>
<pre><code>## [1] 0</code></pre>
</div>
<div id="filtramos-sobre-ingresos-encontrados" class="section level2" number="3.8">
<h2 number="3.8"><span class="header-section-number">3.8</span> Filtramos sobre ingresos encontrados</h2>
<pre class="r"><code>L &lt;- c()
for(i in 1:length(ingreso_hijog_e16_emovi)){
  if(sum(ingreso_hijog_e16_emovi[[i]]$ing_men_p_h[[1]],na.rm = TRUE)==0){
    L&lt;-c(L,i)}
}
length(L)</code></pre>
<pre><code>## [1] 2</code></pre>
<pre class="r"><code>ingreso_hijog_e16_emovi&lt;-ingreso_hijog_e16_emovi[-L]

length(ingreso_hijog_e16_emovi)</code></pre>
<pre><code>## [1] 1075</code></pre>
<pre class="r"><code>ingreso_hijog_e16_emovi[1]</code></pre>
<pre><code>## [[1]]
## # A tibble: 1 x 10
##   id_hijo id_ho mov   regionh  edad ing_men_p_h cohort estrato estado sexo 
##   &lt;chr&gt;   &lt;int&gt; &lt;chr&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;list&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;
## 1 1           7 peor  3          25 &lt;dbl [24]&gt;       3       2 1      1</code></pre>
<pre class="r"><code>ingreso_hijog_e16_emovi[2]</code></pre>
<pre><code>## [[1]]
## # A tibble: 1 x 10
##   id_hijo id_ho mov   regionh  edad ing_men_p_h cohort estrato estado sexo 
##   &lt;chr&gt;   &lt;int&gt; &lt;chr&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;list&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;
## 1 2          34 mejor 3          35 &lt;dbl [43]&gt;       1       1 1      1</code></pre>
<pre class="r"><code>ingreso_hijog_e16_emovif&lt;-bind_rows(ingreso_hijog_e16_emovi[1:length(ingreso_hijog_e16_emovi)])


nrow(ingreso_hijog_e16_emovif)</code></pre>
<pre><code>## [1] 1075</code></pre>
<pre class="r"><code>saveRDS(ingreso_hijog_e16_emovif, file=&quot;Datos/ingreso_hij_f_emovi.Rda&quot;)</code></pre>
</div>
</div>
<div id="hijos-con-ingreso" class="section level1" number="4">
<h1 number="4"><span class="header-section-number">4</span> Hijos con ingreso</h1>
<pre class="r"><code>hijos_emovi_hp &lt;- readRDS(file=&quot;Datos/ingreso_hij_f_emovi.Rda&quot;)

nrow(hijos_emovi_hp)</code></pre>
<pre><code>## [1] 1075</code></pre>
<pre class="r"><code>hijos_emovi_hp </code></pre>
<pre><code>## # A tibble: 1,075 x 10
##    id_hijo id_ho mov   regionh  edad ing_men_p_h cohort estrato estado sexo 
##    &lt;chr&gt;   &lt;int&gt; &lt;chr&gt; &lt;fct&gt;   &lt;dbl&gt; &lt;list&gt;       &lt;dbl&gt;   &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;
##  1 1           7 peor  3          25 &lt;dbl [24]&gt;       3       2 1      1    
##  2 2          34 mejor 3          35 &lt;dbl [43]&gt;       1       1 1      1    
##  3 3          66 peor  3          40 &lt;dbl [9]&gt;        2       1 1      2    
##  4 4          81 peor  3          28 &lt;dbl [18]&gt;       3       2 1      2    
##  5 5          97 mejor 3          37 &lt;dbl [24]&gt;       1       1 1      2    
##  6 6         104 mejor 3          29 &lt;dbl [30]&gt;       2       1 1      2    
##  7 7         115 mejor 3          35 &lt;dbl [14]&gt;       2       1 1      2    
##  8 8         122 igual 3          30 &lt;dbl [74]&gt;       1       1 1      1    
##  9 9         152 igual 3          40 &lt;dbl [9]&gt;        3       2 1      1    
## 10 10        160 mejor 3          36 &lt;dbl [16]&gt;       3       2 1      1    
## # … with 1,065 more rows</code></pre>
<pre class="r"><code># p05 edad act
# p06 sexo act
# p13 educ hijo
# SINCO3, ocupación hijo
# p23 en qeu estado vivia a los 14
# p26 principal sosten ecómico
# p38_11 edad padre 2016
# p38m_11 edad madre 2016
# p43 nivel educativo padre
#p43m nivel educativo madre
# cmo1_2 ocupacion del padre
# cmo2_2 ocupacion de la madre 


varp&lt;-c(&quot;Estado&quot;,&quot;p05&quot;,&quot;p06&quot;,&quot;p13&quot;,&quot;SINCO3&quot;,&quot;p23&quot;,&quot;p26&quot;,&quot;p38_11&quot;,&quot;p38m_11&quot;,&quot;p43&quot;,&quot;p44&quot;,
        &quot;p43m&quot;,&quot;p44m&quot;,&quot;cmo1_2&quot;,&quot;cmo2_2&quot;,&quot;mov&quot;,
        &quot;region&quot;,&quot;p133&quot;)
padres_h&lt;-data_emovi2017%&gt;%
    filter(p02 == 1)  %&gt;% #compartir gasot para comer
  filter(between(p05,25,40)) %&gt;% # edad
  #filter(p08 == 1)  %&gt;% 
  filter(p12 == 2)  %&gt;%# ya no estudia
  filter(p26 == 1 | p26==2 ) %&gt;% # sosten principal papa, mama, 
   filter((!is.na(p43) &amp; p43!=98 &amp; p26 == 1 )|
            (!is.na(p43m) &amp; p43m!=98  &amp; p26 == 2 )) %&gt;% # reporta educación de pp
   filter(!is.na(p13))%&gt;% #  reporta educación
  filter(SINCO3 !=&quot;&quot;) %&gt;%# reporta oficio actual
   filter(p68 == 1 | p69 == 1)  %&gt;% # si trabaja
   filter(p132 %in% c(1)) %&gt;%# persona que aportan ingreso
  filter(!p133 %in% c(8,9,NA) )%&gt;%
  select(varp)%&gt;%
  slice(as.integer(unlist(hijos_emovi_hp%&gt;%select(id_hijo))))%&gt;%
  mutate(
         pp_id_hijo = hijos_emovi_hp%&gt;%pull(id_hijo),
         ing_h = hijos_emovi_hp%&gt;%pull(ing_men_p_h),
         cohort = ifelse(p133==1,2,p133)-1
         )%&gt;%
  rename(
          edad_h = p05,
          sexo_h = p06,
          edu_h = p13,
          ocu_h = SINCO3,
          pp_estado = p23,
          pp = p26,
          p_edad_2016= p38_11,
          m_edad_2016 = p38m_11,
          p_edu = p43,
          p_edug = p44,
          m_edu = p43m,
          m_edug = p44m,
          p_ocu = cmo1_2,
          m_ocu = cmo2_2
         )%&gt;%
  mutate(
        p_edu = as.integer(p_edu),
        m_edu = as.integer(m_edu)
  )
  
 
# las ocupaciones no encontradas las sustituimos por un NA
padres_h&lt;-padres_h%&gt;%
  mutate(p_ocu = ifelse(p_ocu==&quot;.&quot;,NA,p_ocu),
         m_ocu = ifelse(m_ocu==&quot;.&quot;,NA,m_ocu))

unique(padres_h$p_ocu)</code></pre>
<pre><code>##  [1] &quot;21&quot; &quot;52&quot; &quot;61&quot; NA   &quot;71&quot; &quot;55&quot; &quot;12&quot; &quot;41&quot; &quot;53&quot; &quot;81&quot; &quot;11&quot; &quot;51&quot; &quot;62&quot; &quot;14&quot; &quot;82&quot;
## [16] &quot;83&quot; &quot;54&quot; &quot;99&quot; &quot;13&quot; &quot;72&quot;</code></pre>
<pre class="r"><code>unique(padres_h$m_ocu)</code></pre>
<pre><code>##  [1] &quot;71&quot; NA   &quot;82&quot; &quot;13&quot; &quot;55&quot; &quot;41&quot; &quot;62&quot; &quot;72&quot; &quot;52&quot; &quot;81&quot; &quot;51&quot; &quot;11&quot; &quot;54&quot; &quot;12&quot; &quot;83&quot;
## [16] &quot;61&quot; &quot;14&quot; &quot;53&quot;</code></pre>
<pre class="r"><code>head(padres_h)</code></pre>
<pre><code>##   Estado edad_h sexo_h edu_h ocu_h pp_estado pp p_edad_2016 m_edad_2016 p_edu
## 1      1     25      1     6  2815         1  1          51          53    11
## 2      1     35      1     4  7121         1  1          72          73     2
## 3      1     40      2     6  3211         1  1          71          68     6
## 4      1     28      2    11  4111         1  2          NA          65    NA
## 5      1     37      2     2  5111         1  1          82          72     2
## 6      1     29      2     5  4111         1  2          53          48    13
##   p_edug m_edu m_edug p_ocu m_ocu   mov region p133 pp_id_hijo
## 1      5    11      5    21    71  peor      3    4          1
## 2      3    NA     NA    52  &lt;NA&gt; mejor      3    1          2
## 3      3     6      3    61  &lt;NA&gt;  peor      3    3          3
## 4     NA     2      6  &lt;NA&gt;    82  peor      3    4          4
## 5      4     2      2    71  &lt;NA&gt; mejor      3    2          5
## 6     NA    11      4    55    13 mejor      3    3          6
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ing_h
## 1                                                                                                                                                                                                                                                                                               14673.9100, 4891.3033, 113.3133, 978.2600, 1856.3533, 196.7200, 2360.6533, 12652.1700, 1858.6933, 3391.3033, 7630.4333, 2119.5633, 983.6033, 1967.2100, 2754.0967, 3878.4500, 12082.8700, 6725.9633, 1723.7567, 3815.2167, 847.8233, 5086.9533, 1834.2367, 1695.6500
## 2 4309.390000, 3662.983333, 521.736667, 6281.963333, 9606.553333, 3.276667, 8217.390000, 4695.650000, 3913.043333, 7081.966667, 1515.080000, 5901.636667, 983.603333, 590.163333, 7499.996667, 5409.833333, 3278.686667, 3319.670000, 8902.173333, 7394.016667, 7826.086667, 5478.260000, 5673.910000, 1100.543333, 10628.800000, 2331.520000, 3977.900000, 655.736667, 1573.770000, 311.473333, 6782.606667, 6913.043333, 5673.910000, 3505.433333, 2840.216667, 423.910000, 5901.636667, 5478.260000, 78.260000, 3281.086667, 2724.453333, 782.606667, 2282.606667
## 3                                                                                                                                                                                                                                                                                                                                                                                                                                                                          27540.983, 1544.260, 2360.653, 4327.863, 4309.390, 7624.307, 2469.610, 6464.087, 5171.270
## 4                                                                                                                                                                                                                                                                                                                                                           6065.2167, 7826.0867, 5869.5633, 11739.1300, 10434.7800, 19889.5000, 8552.4833, 2386.7400, 326.0867, 9836.0633, 8852.4567, 7868.8500, 14754.0967, 16721.3100, 14754.0967, 4077.3467, 828.7267, 3934.4233
## 5                                                                                                                                                                                                                                                                            5099.99667, 4820.86333, 3815.21667, 2739.13000, 3717.39000, 11508.19333, 983.60333, 590.16333, 6358.69333, 4695.65000, 269.01667, 4304.34667, 1304.34667, 2543.47667, 717.39000, 4721.31000, 5311.47333, 8524.59000, 3147.54000, 819.67000, 4010.86667, 94.56333, 180.32333, 4721.31000
## 6                                                                                                                                                                                                                             1108.6933, 5086.9533, 4695.6500, 1010.8667, 48.9100, 5918.4733, 12717.3900, 19889.5000, 8552.4833, 2386.7400, 7032.7833, 5016.3933, 3854.0967, 4548.9100, 6097.8233, 5086.9533, 5543.4767, 8573.7667, 786.8833, 6762.4300, 9149.1700, 6393.4400, 3540.9833, 5311.4733, 6639.3433, 180.3267, 688.5233, 1513.1133, 5171.2700, 11820.6467
##   cohort
## 1      3
## 2      1
## 3      2
## 4      3
## 5      1
## 6      2</code></pre>
<div id="crear-base-limpia" class="section level2" number="4.1">
<h2 number="4.1"><span class="header-section-number">4.1</span> Crear base limpia</h2>
<pre class="r"><code>filtro_pp_c&lt;-function(df_1,general = 0)
{
  #recibe un hijo de un dataframe, para polimorfismo
  # general = 0y regresa un data frame con los datos
  # ordenados del hijo
  if(df_1[&quot;pp&quot;]==1)
  {
    dfn &lt;- df_1%&gt;%
          filter(pp==1)%&gt;%
          select(starts_with(c(&quot;pp&quot;,&quot;p_&quot;)),
             ing_h,edu_h,ocu_h,edad_h,p_edad_2016,
             region,cohort)%&gt;%
          mutate(pp_edad2016 = p_edad_2016)%&gt;%
          rename(
            id_hijo = pp_id_hijo,
            pp_sexo = pp,
            pp_edad = p_edad_2016,
            pp_educ = p_edu,
            pp_educg = p_edug,
            pp_ocup = p_ocu
          )%&gt;%
        mutate(pp_edad = pp_edad + (14-edad_h))
  }
  if(df_1[&quot;pp&quot;]==2)
    {
    dfn&lt;-df_1%&gt;%
        filter(pp==2)%&gt;%
        select(starts_with(c(&quot;pp&quot;,&quot;m_&quot;)),ing_h,edu_h,
            ocu_h,edad_h,m_edad_2016,
            region,cohort)%&gt;%
       mutate(pp_edad2016 = m_edad_2016)%&gt;%
        rename(
          id_hijo = pp_id_hijo,
          pp_sexo = pp,
          pp_edad = m_edad_2016,
          pp_educ = m_edu,
          pp_educg = m_edug,
          pp_ocup = m_ocu
        )%&gt;%
        mutate(pp_edad = pp_edad + (14-edad_h))
  }
  if(is.na(dfn$pp_edad) &amp; general){
    return(&quot;ND&quot;)
  }
  return(dfn)
}

#comporbamos qeu funcione bien
filtro_pp_c(padres_h[1,])</code></pre>
<pre><code>##   pp_estado pp_sexo id_hijo pp_edad pp_educ pp_educg pp_ocup
## 1         1       1       1      40      11        5      21
##                                                                                                                                                                                                                                                                  ing_h
## 1 14673.9100, 4891.3033, 113.3133, 978.2600, 1856.3533, 196.7200, 2360.6533, 12652.1700, 1858.6933, 3391.3033, 7630.4333, 2119.5633, 983.6033, 1967.2100, 2754.0967, 3878.4500, 12082.8700, 6725.9633, 1723.7567, 3815.2167, 847.8233, 5086.9533, 1834.2367, 1695.6500
##   edu_h ocu_h edad_h region cohort pp_edad2016
## 1     6  2815     25      3      3          51</code></pre>
<pre class="r"><code>acomoda_df_c&lt;-function(df){
  #damos un df de una edad,  y
  # nos regresa un data frame acomodado
  aux&lt;-function(i){
    return(df[i,])
  }
  a&lt;-lapply(1:nrow(df),aux)
  L&lt;-lapply(a,filtro_pp_c)
  dfn &lt;-bind_rows(L[1:length(L)])
  return(dfn)
}

dfh&lt;-acomoda_df_c(padres_h)



pro_edad_c &lt;- function(df){
  #le damos el df y nos regresa el promedio de la edade  los padres
  df%&gt;%summarise(
    promedi_edad_padres = mean(pp_edad2016,na.rm=TRUE))
  }

edades_pro&lt;- pro_edad_c(dfh)

edades_pro</code></pre>
<pre><code>##   promedi_edad_padres
## 1            60.12035</code></pre>
<pre class="r"><code>#edades de padres faltantes
sum(is.na(dfh$pp_edad2016))</code></pre>
<pre><code>## [1] 53</code></pre>
<pre class="r"><code># 
head(dfh)</code></pre>
<pre><code>##   pp_estado pp_sexo id_hijo pp_edad pp_educ pp_educg pp_ocup
## 1         1       1       1      40      11        5      21
## 2         1       1       2      51       2        3      52
## 3         1       1       3      45       6        3      61
## 4         1       2       4      51       2        6      82
## 5         1       1       5      59       2        4      71
## 6         1       2       6      33      11        4      13
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ing_h
## 1                                                                                                                                                                                                                                                                                               14673.9100, 4891.3033, 113.3133, 978.2600, 1856.3533, 196.7200, 2360.6533, 12652.1700, 1858.6933, 3391.3033, 7630.4333, 2119.5633, 983.6033, 1967.2100, 2754.0967, 3878.4500, 12082.8700, 6725.9633, 1723.7567, 3815.2167, 847.8233, 5086.9533, 1834.2367, 1695.6500
## 2 4309.390000, 3662.983333, 521.736667, 6281.963333, 9606.553333, 3.276667, 8217.390000, 4695.650000, 3913.043333, 7081.966667, 1515.080000, 5901.636667, 983.603333, 590.163333, 7499.996667, 5409.833333, 3278.686667, 3319.670000, 8902.173333, 7394.016667, 7826.086667, 5478.260000, 5673.910000, 1100.543333, 10628.800000, 2331.520000, 3977.900000, 655.736667, 1573.770000, 311.473333, 6782.606667, 6913.043333, 5673.910000, 3505.433333, 2840.216667, 423.910000, 5901.636667, 5478.260000, 78.260000, 3281.086667, 2724.453333, 782.606667, 2282.606667
## 3                                                                                                                                                                                                                                                                                                                                                                                                                                                                          27540.983, 1544.260, 2360.653, 4327.863, 4309.390, 7624.307, 2469.610, 6464.087, 5171.270
## 4                                                                                                                                                                                                                                                                                                                                                           6065.2167, 7826.0867, 5869.5633, 11739.1300, 10434.7800, 19889.5000, 8552.4833, 2386.7400, 326.0867, 9836.0633, 8852.4567, 7868.8500, 14754.0967, 16721.3100, 14754.0967, 4077.3467, 828.7267, 3934.4233
## 5                                                                                                                                                                                                                                                                            5099.99667, 4820.86333, 3815.21667, 2739.13000, 3717.39000, 11508.19333, 983.60333, 590.16333, 6358.69333, 4695.65000, 269.01667, 4304.34667, 1304.34667, 2543.47667, 717.39000, 4721.31000, 5311.47333, 8524.59000, 3147.54000, 819.67000, 4010.86667, 94.56333, 180.32333, 4721.31000
## 6                                                                                                                                                                                                                             1108.6933, 5086.9533, 4695.6500, 1010.8667, 48.9100, 5918.4733, 12717.3900, 19889.5000, 8552.4833, 2386.7400, 7032.7833, 5016.3933, 3854.0967, 4548.9100, 6097.8233, 5086.9533, 5543.4767, 8573.7667, 786.8833, 6762.4300, 9149.1700, 6393.4400, 3540.9833, 5311.4733, 6639.3433, 180.3267, 688.5233, 1513.1133, 5171.2700, 11820.6467
##   edu_h ocu_h edad_h region cohort pp_edad2016
## 1     6  2815     25      3      3          51
## 2     4  7121     35      3      1          72
## 3     6  3211     40      3      2          71
## 4    11  4111     28      3      3          65
## 5     2  5111     37      3      1          82
## 6     5  4111     29      3      2          48</code></pre>
<pre class="r"><code># 2016-21</code></pre>
</div>
<div id="codificacion-eduación" class="section level2" number="4.2">
<h2 number="4.2"><span class="header-section-number">4.2</span> Codificacion eduación</h2>
<pre class="r"><code>dfh_c&lt;- dfh%&gt;%
   mutate(
   pp_educ_a = ifelse(pp_educ==1,1,    #sin instruccion(1)
          ifelse(pp_educ==2,1+pp_educg,
          ifelse(pp_educ %in% c(3,4),7+pp_educg,
          ifelse(pp_educ %in% c(5,6,7,8,9),10+pp_educg,
          ifelse(pp_educ %in% c(10,11),13+pp_educg,17+pp_educg)))))
  )

  

unique(dfh_c$pp_educ_a)</code></pre>
<pre><code>##  [1] 18  4 13  7  5 17 12  6 10  3  9 16 19  2 20 14 15  1 11  8</code></pre>
<pre class="r"><code>dfh_c&lt;-dfh_c%&gt;%
  mutate(
   pp_educ_ac = ifelse(pp_educ_a %in% 0:5,&quot;C1&quot;,    
          ifelse(pp_educ_a %in% 6:10 ,&quot;C2&quot;,
          ifelse(pp_educ_a %in% 11:12,&quot;C3&quot;,
          ifelse(pp_educ_a %in% 13:14,&quot;C4&quot;,&quot;C5&quot;))))
  )</code></pre>
</div>
</div>
<div id="padres-construcción-ingresos" class="section level1" number="5">
<h1 number="5"><span class="header-section-number">5</span> Padres construcción ingresos</h1>
<p>Seleccionamos de la ENIGH 1997, no hay entonces 1998</p>
<div id="poblacion-enigh-98" class="section level2" number="5.1">
<h2 number="5.1"><span class="header-section-number">5.1</span> Poblacion enigh 98</h2>
<pre class="r"><code>poblacion&lt;-read.dbf(
              file=&quot;Datos/ENIGH-Historica/1998/POBLA98.dbf&quot;
              )



poblacion_e98&lt;-poblacion%&gt;%
  filter(
    parentesco == &quot;01&quot;,
    between(edad,30,50),
    !is.na(ed_formal),
    !is.na(ed_tecnica),
    !is.na(ocupacion),
    n_empleos==1, # el entrevistado solo proporciona una ocupación
  )%&gt;%
  select(
    folio,
    num_ren,
    edad,
    ed_formal,
    ed_tecnica,
    ocupacion
  )%&gt;%
 mutate(
  ed_formal = as.integer(as.character(ed_formal)),
   ed_tecnica= as.integer(as.character(ed_tecnica)),
  estado = substr(folio,5,6)
 )

#unique(pobla_enigh1998$ed_formal)
#pobla_enigh1998$ed_formal
nrow(poblacion_e98)</code></pre>
<pre><code>## [1] 4173</code></pre>
<pre class="r"><code>head(poblacion_e98$ed_formal)</code></pre>
<pre><code>## [1]  3  8 13 10 15 11</code></pre>
<pre class="r"><code>str(poblacion_e98$ed_formal)#caracter 2 espacios</code></pre>
<pre><code>##  int [1:4173] 3 8 13 10 15 11 8 8 4 14 ...</code></pre>
<pre class="r"><code>unique(poblacion_e98$ed_formal)</code></pre>
<pre><code>##  [1]  3  8 13 10 15 11  4 14  7  1  5 12  6 16  9  2</code></pre>
<pre class="r"><code>#pobla_enigh1998$ed_formal==&quot;03&quot;
head(poblacion_e98$ed_tecnica)</code></pre>
<pre><code>## [1] 1 1 8 1 1 1</code></pre>
<pre class="r"><code>str(poblacion_e98$ed_tecnica)#caracter 1 espacio</code></pre>
<pre><code>##  int [1:4173] 1 1 8 1 1 1 1 1 1 1 ...</code></pre>
<pre class="r"><code>unique(poblacion_e98$ed_tecnica)</code></pre>
<pre><code>## [1] 1 8 9 5 7 6 3 4 2</code></pre>
<pre class="r"><code>#pobla_enigh1998%&gt;%count(n_empleos), se exploro para quitar una ocupacion
names(poblacion)</code></pre>
<pre><code>##  [1] &quot;folio&quot;      &quot;num_ren&quot;    &quot;parentesco&quot; &quot;sexo&quot;       &quot;edad&quot;      
##  [6] &quot;per_ing&quot;    &quot;leer_esc&quot;   &quot;asis_esc_f&quot; &quot;asis_esc_t&quot; &quot;tipo_esc&quot;  
## [11] &quot;ed_formal&quot;  &quot;debe_mat&quot;   &quot;grado_debe&quot; &quot;ed_tecnica&quot; &quot;beca&quot;      
## [16] &quot;prop_beca&quot;  &quot;como_beca&quot;  &quot;edo_civil&quot;  &quot;trabajo&quot;    &quot;no_trabajo&quot;
## [21] &quot;n_empleos&quot;  &quot;emp_dpais&quot;  &quot;posicion&quot;   &quot;ocupacion&quot;  &quot;rama&quot;      
## [26] &quot;nom_empr&quot;   &quot;numper&quot;     &quot;hrs_sem&quot;    &quot;dia_pago&quot;   &quot;hrs_extra&quot; 
## [31] &quot;capacita&quot;   &quot;antigue&quot;    &quot;contrato1&quot;  &quot;sindicato1&quot; &quot;prestacio1&quot;
## [36] &quot;emp_dpais2&quot; &quot;posici_sec&quot; &quot;ocup_sec&quot;   &quot;rama_sec&quot;   &quot;nom_empr2&quot; 
## [41] &quot;num_per2&quot;   &quot;hrs_sec&quot;    &quot;dia_pago2&quot;  &quot;hrs_extra2&quot; &quot;capacita2&quot; 
## [46] &quot;antigue2&quot;   &quot;contrato2&quot;  &quot;sindicato2&quot; &quot;tot_hrs&quot;    &quot;prestacio2&quot;
## [51] &quot;otrotrab&quot;</code></pre>
<pre class="r"><code>str(poblacion$per_ing)</code></pre>
<pre><code>##  Factor w/ 3 levels &quot;0&quot;,&quot;1&quot;,&quot;2&quot;: 2 3 2 2 2 2 2 3 3 2 ...</code></pre>
<div id="codificación-educación-enigh-1998" class="section level3" number="5.1.1">
<h3 number="5.1.1"><span class="header-section-number">5.1.1</span> Codificación educación enigh 1998</h3>
<pre class="r"><code># hacemos la codificación de ENIGH2018 a ESRU
#1  Preescolar o kínder
# 2 Primaria
# 3 Secundaria técnica
# 4 Secundaria general
# 5 Preparatoria técnica
# 6 Preparatoria general
# 7 Técnica o comercial con secundaria
# 8 Técnica o comercial con preparatoria
# 9 Normal básica (con primaria o secundari
# 10 Normal de licenciatura
# 11 Profesional (licenciatura o ingeniería)
# 12 Postgrado (maestría o doctorado)
#_____________________________________________________
# 98 NS, no aplica porque pedimos la edución del pp como instrumento


# vemso las combinaciones de educación para codificar

comb&lt;-poblacion_e98%&gt;%
   mutate( combi = paste(as.character(ed_formal),as.character(ed_tecnica)))%&gt;%
  select(ed_formal,ed_tecnica,combi)

  
sort(unique(comb$combi))</code></pre>
<pre><code>##  [1] &quot;1 1&quot;  &quot;10 1&quot; &quot;10 2&quot; &quot;10 4&quot; &quot;10 5&quot; &quot;11 1&quot; &quot;11 3&quot; &quot;11 4&quot; &quot;11 5&quot; &quot;11 6&quot;
## [11] &quot;11 7&quot; &quot;12 1&quot; &quot;12 3&quot; &quot;12 5&quot; &quot;12 6&quot; &quot;12 7&quot; &quot;13 1&quot; &quot;13 5&quot; &quot;13 6&quot; &quot;13 7&quot;
## [21] &quot;13 8&quot; &quot;13 9&quot; &quot;14 1&quot; &quot;14 3&quot; &quot;14 5&quot; &quot;14 6&quot; &quot;14 7&quot; &quot;14 9&quot; &quot;15 1&quot; &quot;15 3&quot;
## [31] &quot;15 4&quot; &quot;15 5&quot; &quot;15 6&quot; &quot;15 7&quot; &quot;15 9&quot; &quot;16 1&quot; &quot;16 5&quot; &quot;16 7&quot; &quot;16 9&quot; &quot;2 1&quot; 
## [41] &quot;3 1&quot;  &quot;3 2&quot;  &quot;4 1&quot;  &quot;5 1&quot;  &quot;6 1&quot;  &quot;7 1&quot;  &quot;7 2&quot;  &quot;8 1&quot;  &quot;8 2&quot;  &quot;8 3&quot; 
## [51] &quot;8 4&quot;  &quot;8 5&quot;  &quot;9 1&quot;  &quot;9 4&quot;  &quot;9 5&quot;</code></pre>
<pre class="r"><code># [1] &quot;01 1&quot; &quot;02 1&quot; &quot;03 1&quot; &quot;03 2&quot; &quot;04 1&quot; &quot;05 1&quot; &quot;06 1&quot; &quot;07 1&quot; &quot;07 2&quot; &quot;08 1&quot;
# [11] &quot;08 2&quot; &quot;08 3&quot; &quot;08 4&quot; &quot;08 5&quot; &quot;09 1&quot; &quot;09 4&quot; &quot;09 5&quot; &quot;10 1&quot; &quot;10 2&quot; &quot;10 4&quot;
# [21] &quot;10 5&quot; &quot;11 1&quot; &quot;11 3&quot; &quot;11 4&quot; &quot;11 5&quot; &quot;11 6&quot; &quot;11 7&quot; &quot;12 1&quot; &quot;12 3&quot; &quot;12 5&quot;
# [31] &quot;12 6&quot; &quot;12 7&quot; &quot;13 1&quot; &quot;13 5&quot; &quot;13 6&quot; &quot;13 7&quot; &quot;13 8&quot; &quot;13 9&quot; &quot;14 1&quot; &quot;14 3&quot;
# [41] &quot;14 5&quot; &quot;14 6&quot; &quot;14 7&quot; &quot;14 9&quot; &quot;15 1&quot; &quot;15 3&quot; &quot;15 4&quot; &quot;15 5&quot; &quot;15 6&quot; &quot;15 7&quot;
# [51] &quot;15 9&quot; &quot;16 1&quot; &quot;16 5&quot; &quot;16 7&quot; &quot;16 9&quot;




# &quot;16 1&quot; &quot;16 5&quot; &quot;16 7&quot; &quot;16 9&quot;

#codificamos a a años de educación
poblacion_e98c&lt;-poblacion_e98%&gt;%
   mutate(
   edu_a = ifelse(ed_formal==1 &amp; ed_tecnica==1,0,    #sin instruccion(1)
          ifelse((ed_formal %in% c(2,3,4,5,6,7,8,9,10,11,12,13))
                 &amp; (ed_tecnica %in% c(1,2)),ed_formal-1,
          ifelse(ed_formal==8 &amp; (ed_tecnica %in% c(3,4,5)),9,
          ifelse(ed_formal==9 &amp; (ed_tecnica %in% c(4,5)),10,
          ifelse(ed_formal==10 &amp; (ed_tecnica %in% c(2,4,5)),11,
          ifelse(ed_formal==11 &amp; (ed_tecnica %in% c(3,4,5,5,7)),12,
          ifelse((ed_formal %in%c(12)) &amp; (ed_tecnica %in% c(3,5,6,7)),12,
          ifelse(ed_formal==13 &amp; (ed_tecnica %in% c(5,6,7,8,9)),13,
          ifelse(ed_formal==14 &amp; (ed_tecnica %in% c(1,3,5,6,7,9)),14,
          ifelse(ed_formal==15 &amp; (ed_tecnica %in% c(1,3,4,5,6,7,9)),17,19))))))))))
  )

unique(poblacion_e98c$edu_a)</code></pre>
<pre><code>##  [1]  2  7 13  9 17 10  3 14  6  0  4 11 12  5 19  8  1</code></pre>
<pre class="r"><code>#codificamos a coghort de educación

poblacion_e98c&lt;-poblacion_e98c%&gt;%
   mutate(
   edu_ac = ifelse(edu_a %in% 0:5,&quot;C1&quot;,    
          ifelse(edu_a %in% 6:10 ,&quot;C2&quot;,
          ifelse(edu_a %in% 11:12,&quot;C3&quot;,
          ifelse(edu_a %in% 13:14,&quot;C4&quot;,&quot;C5&quot;))))
  )

unique(poblacion_e98c$edu_ac )</code></pre>
<pre><code>## [1] &quot;C1&quot; &quot;C2&quot; &quot;C4&quot; &quot;C5&quot; &quot;C3&quot;</code></pre>
</div>
<div id="creacion-de-region" class="section level3" number="5.1.2">
<h3 number="5.1.2"><span class="header-section-number">5.1.2</span> Creacion de region</h3>
<pre class="r"><code>poblacion_e98c&lt;-poblacion_e98c%&gt;%
          mutate(
            region = ifelse(estado %in% c(&quot;02&quot;,&quot;26&quot;,&quot;08&quot;,&quot;05&quot;,&quot;19&quot;,&quot;28&quot;),1,
                ifelse(estado %in% c(&quot;12&quot;,&quot;20&quot;,&quot;07&quot;,&quot;30&quot;,&quot;27&quot;,&quot;04&quot;,&quot;31&quot;,&quot;23&quot;),5,0))
          )</code></pre>
</div>
</div>
<div id="ingresos-enigh-98" class="section level2" number="5.2">
<h2 number="5.2"><span class="header-section-number">5.2</span> Ingresos enigh 98</h2>
<pre class="r"><code>ingresos&lt;-read.dbf(
              file=&quot;Datos/ENIGH-Historica/1998/ingresos.dbf&quot;
              )

familias_integrantes &lt;- function(df,nr){
  dfn &lt;- df %&gt;%
    filter(NUM_REN %in% nr)
  return(dfn)
} 



ingresos_acu &lt;- function(df,clavs){
 dfn &lt;- df %&gt;%
   group_by(FOLIO, NUM_REN) %&gt;%
   filter(CLAVE %in% clavs)%&gt;%
   summarise(
   claves_a = paste(CLAVE,collapse = &quot;,&quot;),
  ing_tri_t = sum(ING_TRI),
  ing_men_p = ing_tri_t/3,
  ling_men_p = log(ing_men_p)
  ) %&gt;% ungroup()
 
 
 return(dfn)
}

#hogares &lt;- c(&quot;1&quot;,&quot;2&quot;,&quot;3&quot;,&quot;4&quot;,&quot;5&quot;)
personas_h &lt;- c(&#39;01&#39;)

a&lt;-familias_integrantes(ingresos,personas_h)
head(a)</code></pre>
<pre><code>##         FOLIO NUM_REN EMPLEO        MESES CLAVE ING_1 ING_TRI ING_2 ING_3 ING_4
## 1 19980110010      01      1 070605040302  P001  1640    5060  1640  1640  1600
## 2 19980110030      01      1 070605040302  P012  8500   25500  9000  8000  9000
## 3 19980110040      01      1 070605040302  P001  1000    2750  1000  1000   900
## 4 19980110040      01      1 070605040302  P003     0     525   400   400   250
## 5 19980110011      01      1 070605040302  P001  1410    4230  1410  1410  1410
## 6 19980110011      01      2 070605040302  P012   500     250     0     0     0
##   ING_5 ING_6
## 1  1600  2000
## 2  8000  8500
## 3   800   800
## 4     0     0
## 5  1410  1410
## 6     0     0</code></pre>
<pre class="r"><code>claves&lt;-c(&quot;P001&quot;,&quot;P002&quot;,&quot;P003&quot;,&quot;P010&quot;,&quot;P011&quot;,&quot;P012&quot;,&quot;P013&quot;,&quot;P014&quot;,&quot;P015&quot;, &quot;P016&quot;,&quot;P017&quot;,&quot;P018&quot;,&quot;P020&quot;,&quot;P021&quot;,&quot;P026&quot;,&quot;P027&quot;,&quot;P035&quot;,&quot;P040&quot;,&quot;P041&quot;,&quot;P042&quot;,&quot;P044&quot;,&quot;P045&quot;)
ingresos_e98&lt;-ingresos_acu(a,claves) 
ingresos_e98&lt;-ingresos_e98%&gt;%
  select(FOLIO,NUM_REN,claves_a,ling_men_p)%&gt;%
  rename(
    folio = FOLIO,
    num_ren = NUM_REN
  )
head(ingresos_e98)</code></pre>
<pre><code>## # A tibble: 6 x 4
##   folio       num_ren claves_a  ling_men_p
##   &lt;fct&gt;       &lt;fct&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 19980110010 01      P001            7.43
## 2 19980110011 01      P001,P012       7.31
## 3 19980110030 01      P012            9.05
## 4 19980110040 01      P001,P003       7.00
## 5 19980110050 01      P001            8.35
## 6 19980110060 01      P001            9.39</code></pre>
</div>
<div id="base-cruzada-pobla-ing" class="section level2" number="5.3">
<h2 number="5.3"><span class="header-section-number">5.3</span> Base cruzada pobla-ing</h2>
<pre class="r"><code>enigh_98&lt;-full_join(poblacion_e98c,ingresos_e98)%&gt;%
  drop_na()%&gt;%
   mutate(
     ocupacion = substr(ocupacion,1,2)
   )#%&gt;%
  # rename(
  #   EDU=N_INSTR161,
  #   OCU = CMO121
  # )%&gt;%
  # mutate(
  #   EDU = as.character(EDU)
  # )
head(enigh_98)</code></pre>
<pre><code>##         folio num_ren edad ed_formal ed_tecnica ocupacion estado edu_a edu_ac
## 1 19980110010      01   46         3          1        52     01     2     C1
## 2 19980110030      01   43         8          1        81     01     7     C2
## 3 19980110050      01   45        13          8        21     01    13     C4
## 4 19980110080      01   38        10          1        21     01     9     C2
## 5 19980110110      01   41        15          1        41     01    17     C5
## 6 19980110120      01   32        11          1        14     01    10     C2
##   region  claves_a ling_men_p
## 1      0      P001   7.430509
## 2      0      P012   9.047821
## 3      0      P001   8.354674
## 4      0      P011   9.255266
## 5      0      P014   7.762171
## 6      0 P012,P035  10.194290</code></pre>
<pre class="r"><code>unique(enigh_98$edad)</code></pre>
<pre><code>##  [1] 46 43 45 38 41 32 48 30 39 34 50 49 31 47 37 35 42 36 44 33 40</code></pre>
<pre class="r"><code># ajuste para nivel de ecucación ESRU

#data_padres2005$EDU &lt;- factor(data_padres2005$EDU)
#data_padres2005$OCU &lt;- factor(data_padres2005$OCU)

#unique(data_padres2005$OCU)
sum(is.na(enigh_98))</code></pre>
<pre><code>## [1] 0</code></pre>
</div>
</div>
<div id="eslaticidad-integeneracional-de-ingresos" class="section level1" number="6">
<h1 number="6"><span class="header-section-number">6</span> Eslaticidad integeneracional de ingresos</h1>
<div id="deflactamos-ingresos" class="section level2" number="6.1">
<h2 number="6.1"><span class="header-section-number">6.1</span> Deflactamos ingresos</h2>
<p>INPC Feb 2021 = 110.907 <a href="https://www.banxico.org.mx/SieInternet/consultarDirectorioInternetAction.do?accion=consultarCuadro&amp;idCuadro=CP154&amp;locale=es">Consulta</a></p>
<pre class="r"><code>INPC&lt;-110.907

enigh_98&lt;-enigh_98%&gt;%
  mutate(
  ling_men_p=ling_men_p-log(INPC)
  )</code></pre>
<p>Por la porgramación, para los hijos, se hace dentro del sigueinte programa</p>
</div>
<div id="estimación" class="section level2" number="6.2">
<h2 number="6.2"><span class="header-section-number">6.2</span> Estimación</h2>
<p>Sin controlar por ocupación del hijo</p>
<pre class="r"><code>eii&lt;-function(i){
  
  

# BOOSTRAP  
# Regresión de ingresos de padres  
reg_padres&lt;-lm(
  formula = ling_men_p ~ edu_ac + ocupacion + edad +I(edad*edad),
  data = enigh_98[sample(nrow(enigh_98),nrow(enigh_98), replace = TRUE),]
)

#summary(reg_padres)

# numero de padres sin ocupación reportada de hijos
p_socu&lt;-sum(is.na(dfh_c$pp_ocup))
#p_socu


dfh_cna&lt;-dfh_c%&gt;%drop_na(pp_ocup)

# daframe para estimar ingreso padres
data&lt;- data.frame(
   edu_ac= dfh_cna$pp_educ_ac,
   ocupacion= dfh_cna$pp_ocup,
   edad = 0
  )

# BOOSTRAP ingreso HIJOS

# calculamos el ingreso de los hijos con los gemelos
# re-sampleados, ademas codificamos la ocupación del hijo a dos caracteres

auxs&lt;-function(k){
  sample(k,size=length(k),replace=TRUE)
}

dfh_cna &lt;- dfh_cna %&gt;%
  mutate(
   ocu_hc= substring(ocu_h,1,2),
   ing_h=unlist(lapply(
                      lapply(ing_h,auxs),
                      mean
                      )
                ),
   ling_h = log(ing_h)-log(INPC)
  )

dfh_f&lt;-dfh_cna%&gt;%
  mutate(cohort_e = ifelse(ing_h&lt;=2400,1,
                          ifelse(ing_h&lt;=4800,2,
                          ifelse(ing_h&lt;=7200,3,
                          ifelse(ing_h&lt;=12000,4,                          ifelse(ing_h&lt;=24000,5,6))))),
         cohort_dif=cohort-cohort_e)

  
#dfh_cna
#dfh_cna$ocu_hijo
#dfh_cna$ling_h

#str(substr(dfh_cna$ocu_h,1,2))

# estimación ingreso padres
# inputamos al hijo correspondiente

dfhpf&lt;- dfh_f%&gt;%
  mutate(ling_p = predict(
    object = reg_padres,   
    newdata = data)) 
#dfhpf

# Elasticidad intergeneacional del ingreso

reg_hp&lt;-lm(
  formula = ling_h ~ ling_p + edad_h+ I(edad_h*edad_h),#+ ocu_hc,
  data = dfhpf
)
#summary(reg_hp)
beta &lt;- reg_hp$coefficients[2]
cohort_dif&lt;-as.integer(dfhpf%&gt;%count(cohort_dif)%&gt;%
                   filter(cohort_dif==0)%&gt;%
                 select(n))

return(data.frame()%&gt;%summarise(
  cohort_dif=cohort_dif,
  beta=beta))

}
set.seed(123)
a&lt;-lapply(1:1500,eii)
resul&lt;-bind_rows(a[1:length(a)])
head(resul)</code></pre>
<pre><code>##   cohort_dif      beta
## 1        310 0.2583353
## 2        327 0.2593623
## 3        321 0.2709035
## 4        332 0.2753167
## 5        313 0.2967468
## 6        315 0.2676047</code></pre>
<pre class="r"><code>mean(resul$beta)</code></pre>
<pre><code>## [1] 0.2637111</code></pre>
<pre class="r"><code>sd(resul$beta)</code></pre>
<pre><code>## [1] 0.01674104</code></pre>
<pre class="r"><code>hist(resul$beta)</code></pre>
<p><img src="Estimacion_files/figure-html/fun_prin_eii-1.png" width="672" /></p>
<pre class="r"><code>hist(resul$cohort_dif)</code></pre>
<p><img src="Estimacion_files/figure-html/hit_n0-1.png" width="672" /></p>
<pre class="r"><code>mean(resul$cohort_dif)</code></pre>
<pre><code>## [1] 320.6627</code></pre>
</div>
</div>

<div id="rmd-source-code">LS0tCnRpdGxlOiAiRXN0aWFtY2lvbiIKYXV0aG9yOiAiUmFmYWVsIE1hcnTDrW5leiBNYXJ0w61uZXoiCm91dHB1dDogCiAgaHRtbF9kb2N1bWVudDoKICAgIHRvYzogdHJ1ZQogICAgdG9jX2Zsb2F0OiB0cnVlCiAgICBudW1iZXJfc2VjdGlvbnM6IHRydWUKICAgIGNvZGVfZG93bmxvYWQ6IHRydWUKICAgIGNvZGVfZm9sZGluZzogc2hvdwotLS0KCgpgYGB7ciBzZXR1cCwgaW5jbHVkZT1GQUxTRX0Ka25pdHI6Om9wdHNfY2h1bmskc2V0KGVjaG8gPSBUUlVFLCBtZXNzYWdlID0gRkFMU0UpCmBgYAoKCmBgYHtyIGNhcmdhcl9iaWxpb3RlY2FzfQpsaWJyYXJ5KHRpZHl2ZXJzZSkKbGlicmFyeShoYXZlbikgIyBpbXBvcnRhLCBlbnRyZSBvdHJvcyBzb2Z0d2FyZSwgZGUgU3RhdGEKbGlicmFyeShzamxhYmVsbGVkKSAjIG1hbmVqYXIgbGFiZWxzIGRlIGxhcyB2YXJpYWJsZXMgCmxpYnJhcnkob3Blbnhsc3gpICMgbGVlciBhcmNoaXZvcyBkZSBleGNlbApsaWJyYXJ5KERUKSAjIHZpc3VhbGl6YXIgYSB0YWJsYXMKbGlicmFyeShkYXRhLnRhYmxlKSAjIGNvbnZlcnRpciBhIHRhYmxhcwpsaWJyYXJ5KGhpZ2hjaGFydGVyKSAjIGdyw6FmaWNhcyBpbnRlcmFjdGl2YXMKbGlicmFyeShmb3JlaWduKQpgYGAKCgojIEZ1bmNpb25lcyBkZSBjYXJnYQoKYGBge3IgZnVuX2NhcmdfRVNSVX0KCmNhcmdhcl9lc3J1PC0gZnVuY3Rpb24oKXsKCnJldHVybihyZWFkX3N0YXRhKAogICAgICAgICAgICAgICAgICAgICBwYXRoID0gIkRhdG9zL0VTUlUtRU1PVkktMjAxNy9FU1JVLUVNT1ZJLTIwMTctRW50cmV2aXN0YWRvLmR0YSIsCiAgICAgICAgICAgICAgICAgICAgIGF0b21pYy50by5mYWMgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICBlbmMgPSBOVUxMLAogICAgICAgICAgICAgICAgICAgICApKQp9CmBgYAoKCmBgYHtyIGNhcmFnYXJfZW5pZ2h9CmNhcmdhcl9lbmlnaDwtIGZ1bmN0aW9uKGRvY3UpewoKcmV0dXJuKHJlYWRfc3RhdGEoCiAgICAgICAgICAgICAgICAgICAgIHBhdGggPSBwYXN0ZSgiRGF0b3MvRU5JR0gtMjAxNi8iLGRvY3UsIi5kdGEiLHNlcD0iIiksCiAgICAgICAgICAgICAgICAgICAgIGF0b21pYy50by5mYWMgPSBUUlVFLAogICAgICAgICAgICAgICAgICAgICBlbmMgPSBOVUxMLAogICAgICAgICAgICAgICAgICAgICApKQp9CgpjYXJnYXJfZW5pZ2hfc2F2PC0gZnVuY3Rpb24oZG9jdSl7CgpyZXR1cm4ocmVhZF9zcHNzKAogICAgICAgICAgICAgICAgICAgICBwYXRoID0gcGFzdGUoIkRhdG9zL0VOSUdILTIwMTYvIixkb2N1LCIuc2F2IixzZXA9IiIpLAogICAgICAgICAgICAgICAgICAgICBhdG9taWMudG8uZmFjID0gVFJVRSwKICAgICAgICAgICAgICAgICAgICAgZW5jID0gTlVMTCwKICAgICAgICAgICAgICAgICAgICAgKSkKfQpgYGAKCgoKIyBGaWx0cmFyIGhpam9zIEVTUlUKCiMjIENyZWFtb3MgIHBlciBtb3ZpbGlkYWQKCmBgYHtyIGNhcmdhX2VzcnVfY3JlYV9tb3Z9IAoKZGF0YV9lbW92aTIwMTc8LWNhcmdhcl9lc3J1KCkKCmRhdGFfZW1vdmkyMDE3PC1kYXRhX2Vtb3ZpMjAxNyU+JQogIG11dGF0ZShtb3YgPSBpZmVsc2UocDE0Nz5wMTQ4LCJtZWpvciIsCiAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UocDE0NzxwMTQ4LCJwZW9yIiwiaWd1YWwiKSksCiAgICAgICAgIGlkX2hvID0gYXMuaW50ZWdlcihyb3cubmFtZXMoZGF0YV9lbW92aTIwMTcpKSkKZGF0YV9lbW92aTIwMTckbW92PC1zZXRfbGFiZWxzKAogICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFfZW1vdmkyMDE3JG1vdiwKICAgICAgICAgICAgICAgICAgICAgICAgICBsYWJlbHMgPSBjKCJtZWpvciIgPSAibWVqb3IiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInBlb3IiID0gInBlb3IiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImlndWFsIiA9ICJpZ3VhbCIpKQoKYGBgCgojIyBDcmFtb3MgY29ob3J0CgoKCiMjIHNlbGVjY2lvbiBkZSBoaWpvcwoKQ3JpdGVyaW9zIGRlIGZpbHRyYWRvCi0gcHJlZ3VudGEgcDIsIGNvbXBhcnRlbiBlbCBtaW1zbyBnYXN0byBwYXJhIGNvbWVyOiAxICkgU2kgMiApIE5vCi0gcHJlZ3VudGEgNSBFZGFkZXMgZW50cmUgMjUgeSA0NSBhw7FvcwotIHByZWd1bnRhIHAwOCwgZXMgZWwgamVmZSBkZWwgaG9nYXI6IDEgKSBqZWZlIDIpIGPDs255dWdlIE5PIElNUExFTUVOVEFETwotIHByZWd1bnRhIHAxMiwgYWN0dWFsbWVudGUgZXN0dWRpYSwgMSlTaSAyKU5vCi0gcDI2IEhhYsOtYSB1biBqZWZlIGRlIGhvZ2FyIGVuIGxhIGluZmFuY2lhICgxIHBhZHJlIDIgbWFkcmUpCi0gcDQzIHkgcDQzbSBSZXBvcnRhIGVkdWNhY2nDs24gZGVsIHBhZHJlIG8gbWFkcmUgcHJpY2lhcGwKLSBwNjgsIFBlcnNvbmFzIHF1ZSB0cmFiYWphbiwgMS4gU2ksIDIuIE5vCi0gcDY5IHNpIHRyYWJhamEgcGVybyBsYSBzZW1hbmEgcGFzYWRhIG5vIAotIHAxMzIgbnVtZXJvIGRlIHBlcnNvbmFzIHF1ZSBhcG9ydGFuIGluZ3Jlc28KLSBwMTMzIGNvaG9ydCBkZSB0b2RhcyBsYXMgcGVyc29uYXMgeSB0b2RvcyBsb3MgaW5ncmVzb3MgKDEgaW5ncmVzbykKCgpWYXJpYWJsZXMgZGUgc2VsZWNjacOzbiBwYXJhIGVzdGltYXIgaW5ncmVzbwoKLSBFc3RhZG8KCi0gcHJlZ3VudGEgNSwgZWRhZAoKLSBwcmVndW50YSA2LCBzZXhvCgotIFByZWd1bnRhIDEzLCBuaXZlbCBkZSBlc2N1ZWxhCgotIHA3NiBvY3VwYWNpw7NuCi0tU0lOQ08zIGNvZGlmaWNhY2nDs24gb2N1cGFjacOzbiBlbnRyZXZpc3RhZG8KCi0gcDEzMyBjb2hvcnQgZGUgdG9kYXMgbGFzIHBlcnNvbmFzIHkgdG9kb3MgbG9zIGluZ3Jlc29zCgoKYGBge3IgaGlqb3Nfc2VsX2VzcnV9CiMgcGVuc2Ftb3MgcXVlIGxvcyBkYXRvcyBzZSBsZWVlbiBjb21vIGZhY3RvcmVzIGNhbmRvIGNvcnJlc3BvbmRhLCBzaSBzZSBsZWVuIGNvbW8gZW50ZXJvcyBubyBkZWJlIGhhY2Vyc2UgZWwgY2FzdGluZwojZGF0YV9lbW92aTIwMTc8LWRhdG9zX2UKaGlqb3MgPC0gZGF0YV9lbW92aTIwMTcgJT4lCiAgZmlsdGVyKHAwMiA9PSAxKSAgJT4lICNjb21wYXJ0aXIgZ2Fzb3QgcGFyYSBjb21lcgogIGZpbHRlcihiZXR3ZWVuKHAwNSwyNSw0MCkpICU+JSAjIGVkYWQKICAjZmlsdGVyKHAwOCA9PSAxKSAgJT4lIAogIGZpbHRlcihwMTIgPT0gMikgICU+JSAjIHlhIG5vIGVzdHVkaWEKICBmaWx0ZXIocDI2ID09IDEgfCBwMjY9PTIgKSAlPiUgIyBzb3N0ZW4gcHJpbmNpcGFsIHBhcGEsIG1hbWEsIAogICBmaWx0ZXIoKCFpcy5uYShwNDMpICYgcDQzIT05OCAmIHAyNiA9PSAxICkgfAogICAgICAgICAgICAoIWlzLm5hKHA0M20pICYgcDQzbSE9OTggICYgcDI2ID09IDIgKSkgJT4lICMgcmVwb3J0YSBlZHVjYWNpw7NuIGRlIHBwCiAgIGZpbHRlcighaXMubmEocDEzKSklPiUgIyAgcmVwb3J0YSBlZHVjYWNpw7NuCiAgZmlsdGVyKFNJTkNPMyAhPSIiKSAlPiUjIHJlcG9ydGEgb2ZpY2lvIGFjdHVhbAogICBmaWx0ZXIocDY4ID09IDEgfCBwNjkgPT0gMSkgICU+JSAjIHNpIHRyYWJhamEKICAgZmlsdGVyKHAxMzIgJWluJSBjKDEpKSAlPiUjIHBlcnNvbmEgcXVlIGFwb3J0YW4gaW5ncmVzbwogIGZpbHRlcighcDEzMyAlaW4lIGMoOCw5LE5BKSApICMgcmVwb3J0YSBpbmdyZXNvcwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICMgbm8gZXN0YW4gbG9zIGluZ3Jlc29zICBob2dhciBhaXNsYWRvcy4gCgojZWRhZF9wcm9tZWRpb19wYWRyZXMgPC0gbWVhbihoaWpvcyRwMzhfMTEsIG5hLnJtID0gVFJVRSkKI2VkYWRfcHJvbWVkaW9fcGFkcmVzLTIxCgpzdHIoaGlqb3MkcDAyKQoKdW5pcXVlKGhpam9zJHA0MykKYGBgCiMjIGhpam9zIHNlbGVjY2lvbmFkb3MKCkhhY2Vtb3MgdW4gY29ob3J0IGRlbCAxIHkgZWwgMiAKCmBgYHtyIGhpam9zX3NlbF9lc3J1X21vZH0KCgp2YXI8LWMoIkVzdGFkbyIsInAwNSIsInAwNiIsInAxMyIsIlNJTkNPMyIsInAxMzMiLCJtb3YiLCJpZF9obyIsInJlZ2lvbiIpCmhpam9zX3BhcmFfc2FsPC1oaWpvcyU+JQogIHNlbGVjdCh2YXIpJT4lCiAgbXV0YXRlKHAxMzMgPSBpZmVsc2UocDEzMz09MSwyLHAxMzMpLTEpIyBqdW50YW1vcyBlbCBjb2hvcnQgMSB5IDIgCgpoaWpvc19wYXJhX3NhbCA8LSBoaWpvc19wYXJhX3NhbCU+JQogICAgICAgICAgICBtdXRhdGUoZXN0cmF0byA9IGlmZWxzZShwMTMzICVpbiUgYygxLDIpLDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShwMTMzICVpbiUgYygzKSwyLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKHAxMzMgJWluJSBjKDQsNSksMyw0KSkpKQoKCiNzdW0oaGlqb3NfcGFyYV9zYWwkcDEzMz09MSkKCm5yb3coaGlqb3NfcGFyYV9zYWwpCnNhdmVSRFMoaGlqb3NfcGFyYV9zYWwsIGZpbGU9IkRhdG9zL2hpam9zX2Vtb3ZpMjAxNy5SZGEiKQoKYGBgCgojIEhpam9zIGNvbnN0cnVjY2nDs24gaW5ncmVzb3MKCmBgYHtyLCBjYXJnYXJfZW5pZ2gxNn0KcG9ibGFjaW9uX2UxNjwtY2FyZ2FyX2VuaWdoX3NhdigicG9ibGFjaW9uIikgCnRyYWJham9zX2UxNjwtY2FyZ2FyX2VuaWdoX3NhdigidHJhYmFqb3MiKQppbmdyZXNvc19lMTY8LWNhcmdhcl9lbmlnaF9zYXYoImluZ3Jlc29zIikKYGBgCgojIyBwb2JsYWNpb24gZW5pZ2ggMTYKYGBge3IgcG9ibGFjaW9uX2UxNn0KcG9ibGFjaW9uX2UxNmY8LSBwb2JsYWNpb25fZTE2JT4lCiAgI2ZpbHRlcihhc2lzX2VzYyA9PSAiMiIpJT4lICMgeWEgbm8gYXNpc3RlIGEgbGEgZXNjdWVsYQogIHNlbGVjdChmb2xpb3Zpdixmb2xpb2hvZyxudW1yZW4sc2V4byxlZGFkLG5pdmVsYXByb2IpJT4lCiAgZmlsdGVyKGJldHdlZW4oYXMuaW50ZWdlcihlZGFkKSwyNSw0MCkpCiMgbm8gZmlsdHJhbW9zIHBvciBqZWZlIGRlIGhvZ2FyCgpucm93KHBvYmxhY2lvbl9lMTZmKQpzdW0oaXMubmEocG9ibGFjaW9uX2UxNmYpKQoKYGBgCgojIyB0cmFiYWpvcyBlbmlnaCAxNgoKRmlsdHJhbXMgbG9zIHRyYWJham9zCgpgYGB7ciB0cmFiYWpvc19lMTZ9CnRyYWJham9zX2UxNmY8LXRyYWJham9zX2UxNiU+JQpzZWxlY3QoZm9saW92aXYsZm9saW9ob2csbnVtcmVuKSMlPiUKICMgZmlsdGVyKCFpcy5uYShzaW5jbykpCk5ST1codHJhYmFqb3NfZTE2ZikKI05ST1codHJhYmFqb3MpCnN1bShpcy5uYSh0cmFiYWpvc19lMTZmKSkKCmBgYAoKIyMgSW5ncmVzb3MgZW5pZ2ggMjAxNgoKYGBge3IgaW5ncmVzb3NfZTE2fQpmYW1pbGlhc19pbnRlZ3JhbnRlc19lMTYgPC0gZnVuY3Rpb24oZGYsZm9saG9nLG5yKXsKICBkZm4gPC0gZGYgJT4lCiAgICBmaWx0ZXIoZm9saW9ob2cgJWluJSBmb2xob2cpJT4lCiAgICBmaWx0ZXIobnVtcmVuICVpbiUgbnIpCiAgcmV0dXJuKGRmbikKfSAKCgoKaW5ncmVzb3NfYWN1X2UxNiA8LSBmdW5jdGlvbihkZixjbGF2cz1nZXRfbGFiZWxzKGluZ3Jlc29zX2UxNiRjbGF2ZSkpewogZGZuIDwtIGRmICU+JQogICBncm91cF9ieShmb2xpb3ZpdiwgZm9saW9ob2csIG51bXJlbikgJT4lCiAgIGZpbHRlcihjbGF2ZSAlaW4lIGNsYXZzKSU+JQogICBzdW1tYXJpc2UoCiAgIGNsYXZlc19hID0gcGFzdGUoY2xhdmUsY29sbGFwc2UgPSAiLCIpLAogIGluZ190cmlfdCA9IHN1bShpbmdfdHJpKSwKICBpbmdfbWVuX3AgPSBpbmdfdHJpX3QvMwogICkgJT4lIHVuZ3JvdXAoKQogCiAKIHJldHVybihkZm4pCn0KCmhvZ2FyZXMgPC0gYygiMSIsIjIiLCIzIiwiNCIsIjUiKQpwZXJzb25hc19oIDwtIGMoJzAxJywnMDInLCcwMycsJzA0JywnMDUnKQoKYTwtZmFtaWxpYXNfaW50ZWdyYW50ZXNfZTE2KGluZ3Jlc29zX2UxNixob2dhcmVzLHBlcnNvbmFzX2gpCmhlYWQoYSkKY2xhdmVzPC1jKCJQMDAxIiwiUDAwMiIsIlAwMDMiLCJQMDExIiwiUDAyMyIsIlAwMjQiLCJQMDU0IiwiUDA1NSIsIlAwNTYiLCAiUDA1OSIsIlAwNjAiLCJQMDYxIiwiUDA2MyIsIlAwNjgiLCJQMDYwIiwiUDA3MCIsIlAwNzEiLCJQMDcyIiwiUDA3MyIsIlAwNzQiLCJQMDc1IiwiUDA3NiIsIlAwNzciLCJQMDc4IiwiUDA3OSIsIlAwODAiKQppbmdyZXNvc19lMTZhPC1pbmdyZXNvc19hY3VfZTE2KGEsY2xhdmVzKSAKaW5ncmVzb3NfZTE2YQpgYGAKCgojIyBCYXNlIGNydXphZGEgcG9iLXRyYQoKYGBge3IgYmFzZV9jcnV6YWRhfQplbmlnaF8xNjwtIGZ1bGxfam9pbihwb2JsYWNpb25fZTE2Zix0cmFiYWpvc19lMTZmKSU+JQogICBkcm9wX25hKCkKI2VuaWdoPC1mdWxsX2pvaW4oZW5pZ2gsY29uY2VudHJhZG8pJT4lCiAjIGRyb3BfbmEoKQpucm93KGVuaWdoXzE2KQpzdW0oaXMubmEoZW5pZ2hfMTYpKQpgYGAKCiMjIENhbWJpbyBldGlxdWV0YWRvClBhc2Ftb3MgbGFzIGV0aXFldXRlYXMgZGUgZWR1Y2FjacOzbiBkZSBlbW92aSBhIAoKYGBge3IgY2FtYmlhX2VfZXNydV9vY3V9CgpoaWpvc19lbW92aSA8LSByZWFkUkRTKGZpbGU9IkRhdG9zL2hpam9zX2Vtb3ZpMjAxNy5SZGEiKQpoaWpvc19lbW92aTwtIGhpam9zX2Vtb3ZpICU+JQogIG11dGF0ZShwMTNfbSA9IGlmZWxzZShwMTMgJWluJSBjKDEpLCIxIiwKICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZSggcDEzID09IDIsIjIiLAogICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKHAxMyAlaW4lIGMoMyw0KSwiMyIsCiAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UoIHAxMyAlaW4lIGMoNSw2KSwiNCIsCiAgICAgICAgICAgICAgICAgICAgICBpZmVsc2UocDEzICVpbiUgYyg3LDgpLCI2IiwKICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShwMTMgJWluJSBjKDksMTApLCI1IiwKICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShwMTM9PTExLCI3IiwKICAgICAgICAgICAgICAgICAgICAgIGlmZWxzZShwMTM9PTEyLCI4IiwiMCIpKSkpKSkpKSkKdW5pcXVlKGhpam9zX2Vtb3ZpJHAxM19tKQoKZW5pZ2hfMTY8LWVuaWdoXzE2JT4lCiAgbXV0YXRlKG5pdmVsYXByb2I9aWZlbHNlKG5pdmVsYXByb2I9PSI5IiwiOCIsbml2ZWxhcHJvYikpCgplbmlnaF8xNmY8LWVuaWdoXzE2JT4lCiAgZmlsdGVyKG5pdmVsYXByb2IgJWluJSB1bmlxdWUoaGlqb3NfZW1vdmkkcDEzX20pKQoKbnJvdyhlbmlnaF8xNmYpCmBgYAoKCiMjIEJ1c2NhciBmb2xpb3MgY29uIGNhcmFjdGVyaXN0aWNhcwoKYGBge3IgYnVzY2FfZm9saW9zX2UxNn0KYnVzY2E8LWZ1bmN0aW9uKGkpewpyZXR1cm4oZW5pZ2hfMTZmJT4lCiAgZmlsdGVyKAogICAgYXMuaW50ZWdlcihzdWJzdHIoZm9saW92aXYsMSwyKSk9PWhpam9zX2Vtb3ZpW2ksXSRFc3RhZG8gJgogICAgc2V4byA9PSBoaWpvc19lbW92aVtpLF0kcDA2ICYKICAgIGVkYWQgPT0gaGlqb3NfZW1vdmlbaSxdJHAwNSAmCiAgICAjc2luY28gPT0gaGlqb3NfZW1vdmlbaSxdJFNJTkNPMyAmCiAgICBuaXZlbGFwcm9iID09IGhpam9zX2Vtb3ZpW2ksXSRwMTNfbSklPiUKICBzZWxlY3QoZm9saW92aXYsZm9saW9ob2cpKQp9CgogIAphPC1sYXBwbHkoMTpucm93KGhpam9zX2Vtb3ZpKSwgYnVzY2EpCgpjb250YWRvcjwtMApmb3IoaSBpbiAxOm5yb3coaGlqb3NfZW1vdmkpKQp7aWYobnJvdyhhW1tpXV0pPjApCiAgY29udGFkb3I8LWNvbnRhZG9yICsxCn0KY29udGFkb3IKc2F2ZVJEUyhhLCBmaWxlPSJEYXRvcy9mb2xoaWpvc19lbmlnaDE2X2Vtb3ZpLlJkYSIpCmBgYAoKRGVsIHRvdGFsLCAxMDc3IHBlcnNvbmFzIHRpZW5lbiBnZW1lbG9zCgojIyMgZmlsdGFtb3Mgc29sbyBsb3MgaGlqb3MgZW5jb250cmFkb3MKCgpgYGB7ciBldGlxdWVfaGlqb3NfZW5jX30gCiMgZXRpcXVldGFtb3MgcGFyYSBubyBwZXJkZXIgbGEgbnVtZXJhY2lvbiByZXNwZWN0byBhIGxvcyBoaWpvcyBvcmlnaW5hbGVzCmZvbGhpam9zX2UxNl9lbW92aSA8LSByZWFkUkRTKGZpbGU9IkRhdG9zL2ZvbGhpam9zX2VuaWdoMTZfZW1vdmkuUmRhIikKbmFtZXMoZm9saGlqb3NfZTE2X2Vtb3ZpKSA8LSBhcy5jaGFyYWN0ZXIoMTpucm93KGhpam9zX2Vtb3ZpKSkKbGVuZ3RoKGZvbGhpam9zX2UxNl9lbW92aSkKYGBgCgpgYGB7ciBmaWx0cmFfaGlqb3NfZW5jb259CkwgPC0gYygpCmZvcihpIGluIDE6bGVuZ3RoKGZvbGhpam9zX2UxNl9lbW92aSkpewogIGlmKCEobnJvdyhmb2xoaWpvc19lMTZfZW1vdmlbW2ldXSk+MCkpewogICAgTDwtYyhMLGkpfQp9CiMgU29sbyBoaWpvcyBxdWUgc2UgbGVzIHB1ZG8gZW5jb250cmFyIGVuIGVuaWdoLTIwMTYgMTA3Ny8xMTMxCmZvbGhpam9zX2UxNl9lbW92aWY8LWZvbGhpam9zX2UxNl9lbW92aVstTF0KICAgIAoKbGVuZ3RoKGZvbGhpam9zX2UxNl9lbW92aWYpCgojbmFtZXMoZm9saGlqb3NfZW1vdmlmKQojbmFtZXMoZm9saGlqb3NfZW1vdmkpCmBgYAoKIyMjIFVuaWNvcyBmb2xpb3MsIGRpZmVyZW50ZXMgdHJhYmFqb3MKCgoKYGBge3IgZmlsdHJhX2ZpbF9oaWpfdW5pfQp1bmljb3NfZm9saW9zPC1mdW5jdGlvbihpKXsKZm9saGlqb3NfZTE2X2Vtb3ZpZltbaV1dJT4lCiAgZGlzdGluY3QoKQp9CgojIGZpbHRyYW1vcyB1bmljb3MgZm9saW9zIHBvciBkaWZlcmVudGVzIHRyYWJham9zIGRlIGxhIG1pc21hIHBlcnNvbmEKYTwtbGFwcGx5KDE6bGVuZ3RoKGZvbGhpam9zX2UxNl9lbW92aWYpLCB1bmljb3NfZm9saW9zKQpuYW1lcyhhKTwtbmFtZXMoZm9saGlqb3NfZTE2X2Vtb3ZpZikKbGVuZ3RoKGEpCgpmb2xoaWpvc19lMTZfZW1vdmlmPC1hCmBgYAoKCiMjIyBPYnNlcnZhbW9zIGxhcyBlZGFkZXMgZGUgbG9zIGVuY29udHJhZG9zCgpgYGB7ciBncmFfZWRhZGVzX2hfZW5jfQoKbXlNZW51SXRlbXMgPC0gYygiZG93bmxvYWRQTkciLCAiZG93bmxvYWRKUEVHIiwgImRvd25sb2FkUERGIiwgJ2Rvd25sb2FkU1ZHJywgJ3ByaW50Q2hhcnQnKQoKaGlqb3NfZW1vdmklPiUKICBzbGljZShhcy5pbnRlZ2VyKG5hbWVzKGZvbGhpam9zX2UxNl9lbW92aWYpKSklPiUKICBzZWxlY3QocDA1KSU+JQogIGNvdW50KHAwNSklPiUKICAgIGhjaGFydCgnY29sdW1uJywKICAgICAgICAgaGNhZXMoIHkgPSAnbicpKSU+JQogIGhjX2FkZF90aGVtZShoY190aGVtZV9mZngoKSklPiUKICBoY190aXRsZSgKICAgIHRleHQgPSAiIgogICkgJT4lCiAgI2hjX3N1YnRpdGxlKHRleHQgPSAiTGFzIGVkYWRlcyBlc3TDoW4gYWdydXBhZGFzIGVuIGludGVydmFsb3MgCiAgICMgICAgICAgICAgIGRlIDEwIGHDsW9zIChkYSBjbGljIHNvYnJlIEYgbyBNKSIpICU+JQogICMgaGNfY3JlZGl0cygKICAjICBlbmFibGVkID0gVFJVRSwgdGV4dCA9ICJTb3VyY2U6IFNTUyIsCiAgIyAgc3R5bGUgPSBsaXN0KGZvbnRTaXplID0gIjEycHgiKSklPiUKICBoY195QXhpcyh0aXRsZSA9IGxpc3QodGV4dCA9ICJOw7ptZXJvIGRlIHBhcnRpY2lwYW50ZXMiKSklPiUKICBoY194QXhpcyh0aXRsZT1saXN0KHRleHQ9Ik7Dum1lcm8gZGUgcGVyc29uYXMiKSwKICAgICAgICAgICBjYXRlZ29yaWVzID0gYXMuY2hhcmFjdGVyKDI1OjQwKSkgJT4lCiAgICBoY19leHBvcnRpbmcoZW5hYmxlZCA9IFRSVUUsCiAgICAgICAgICAgICAgIGZpbGVuYW1lID0gImRhdG9zIiwKICAgICAgICAgICAgICAgYnV0dG9ucyA9IGxpc3QoY29udGV4dEJ1dHRvbiA9IGxpc3QobWVudUl0ZW1zID0gbXlNZW51SXRlbXMpKSkKCgpgYGAKCiMjIyBPYnNlcnZhbW9zIGxhcyBlc3RhZG9zIGRlIGxvcyBlbmNvbnRyYWRvcwoKYGBge3IgZ3JhX2VzdGFkb3NfaF9lMTZ9Cmhpam9zX2Vtb3ZpJT4lCiAgc2xpY2UoYXMuaW50ZWdlcihuYW1lcyhmb2xoaWpvc19lMTZfZW1vdmlmKSkpJT4lCiAgY291bnQoRXN0YWRvKSU+JQogICAgaGNoYXJ0KCdjb2x1bW4nLAogICAgICAgICBoY2FlcyggeSA9ICduJykpJT4lCiAgaGNfYWRkX3RoZW1lKGhjX3RoZW1lX2ZmeCgpKSU+JQogIGhjX3RpdGxlKAogICAgdGV4dCA9ICIiCiAgKSAlPiUKICAjaGNfc3VidGl0bGUodGV4dCA9ICJMYXMgZWRhZGVzIGVzdMOhbiBhZ3J1cGFkYXMgZW4gaW50ZXJ2YWxvcyAKICAgIyAgICAgICAgICAgZGUgMTAgYcOxb3MgKGRhIGNsaWMgc29icmUgRiBvIE0pIikgJT4lCiAgIyBoY19jcmVkaXRzKAogICMgIGVuYWJsZWQgPSBUUlVFLCB0ZXh0ID0gIlNvdXJjZTogU1NTIiwKICAjICBzdHlsZSA9IGxpc3QoZm9udFNpemUgPSAiMTJweCIpKSU+JQogIGhjX3lBeGlzKHRpdGxlID0gbGlzdCh0ZXh0ID0gIk7Dum1lcm8gZGUgcGFydGljaXBhbnRlcyIpKSU+JQogIGhjX3hBeGlzKHRpdGxlPWxpc3QodGV4dD0iTsO6bWVybyBkZSBwZXJzb25hcyIpLAogICAgICAgICAgIGNhdGVnb3JpZXMgPSBnZXRfbGFiZWxzKGhpam9zX2Vtb3ZpJEVzdGFkbykpICU+JQogICAgaGNfZXhwb3J0aW5nKGVuYWJsZWQgPSBUUlVFLAogICAgICAgICAgICAgICBmaWxlbmFtZSA9ICJkYXRvcyIsCiAgICAgICAgICAgICAgIGJ1dHRvbnMgPSBsaXN0KGNvbnRleHRCdXR0b24gPSBsaXN0KG1lbnVJdGVtcyA9IG15TWVudUl0ZW1zKSkpCgpgYGAKCgojIyBJbmdyZXNvIGhpam8gZW5pZ2gxNi1lbW92aQoKYGBge3IgaW5ncmVfaGlqb19lMTZfZW1vdml9CgppbmdyZXNvX2hpam9fZTE2X2Vtb3ZpPC1mdW5jdGlvbihpKXsKICBpbmdyZXNvc19lMTZhJT4lCiAgZmlsdGVyKGZvbGlvdml2ICVpbiUgZm9saGlqb3NfZTE2X2Vtb3ZpZltbaV1dJGZvbGlvdml2ICYKICAgIGZvbGlvaG9nICVpbiUgZm9saGlqb3NfZTE2X2Vtb3ZpZltbaV1dJGZvbGlvaG9nKSU+JXN1bW1hcmlzZSgKICAgICBpZF9oaWpvID0gbmFtZXMoZm9saGlqb3NfZTE2X2Vtb3ZpZltpXSksCiAgICAgaWRfaG8gPSBoaWpvc19lbW92aVthcy5pbnRlZ2VyKG5hbWVzKGZvbGhpam9zX2UxNl9lbW92aWZbaV0pKSwiaWRfaG8iXSwKICAgICBtb3Y9IGhpam9zX2Vtb3ZpW2FzLmludGVnZXIobmFtZXMoZm9saGlqb3NfZTE2X2Vtb3ZpZltpXSkpLCJtb3YiXSwKICAgICByZWdpb25oID0gaGlqb3NfZW1vdmlbYXMuaW50ZWdlcihuYW1lcyhmb2xoaWpvc19lMTZfZW1vdmlmW2ldKSksInJlZ2lvbiJdLAogICAgIGVkYWQgPSBoaWpvc19lbW92aVthcy5pbnRlZ2VyKG5hbWVzKGZvbGhpam9zX2UxNl9lbW92aWZbaV0pKSwicDA1Il0sCiAgICAgIGluZ19tZW5fcF9oID1saXN0KGluZ19tZW5fcCksCiAgICAgY29ob3J0ID0gaGlqb3NfZW1vdmlbYXMuaW50ZWdlcihuYW1lcyhmb2xoaWpvc19lMTZfZW1vdmlmW2ldKSksInAxMzMiXSwKICAgIGVzdHJhdG8gPSBoaWpvc19lbW92aVthcy5pbnRlZ2VyKG5hbWVzKGZvbGhpam9zX2UxNl9lbW92aWZbaV0pKSwiZXN0cmF0byJdLAogICAgZXN0YWRvID0gaGlqb3NfZW1vdmlbYXMuaW50ZWdlcihuYW1lcyhmb2xoaWpvc19lMTZfZW1vdmlmW2ldKSksIkVzdGFkbyJdLAogICAgc2V4byA9IGhpam9zX2Vtb3ZpW2FzLmludGVnZXIobmFtZXMoZm9saGlqb3NfZTE2X2Vtb3ZpZltpXSkpLCJwMDYiXQogICAgICkKfQojMjczLDMzMiBzb24gdmFjaW9zCiMgaW5ncmVzbyBoaWpvIHBlcm8gdWFsZ3Vub3Mgbm8gcG9kcmlhbiBlc3RhciBwb3Igbm8gdGVuZXIgcmVnaXN0cm8gZGUgc2FsYXJpbwoKYTwtbGFwcGx5KDE6bGVuZ3RoKGZvbGhpam9zX2UxNl9lbW92aWYpLCBpbmdyZXNvX2hpam9fZTE2X2Vtb3ZpKQppbmdyZXNvX2hpam9nX2UxNl9lbW92aTwtYQpsZW5ndGgoaW5ncmVzb19oaWpvZ19lMTZfZW1vdmkpCmluZ3Jlc29faGlqb2dfZTE2X2Vtb3ZpW1szMzJdXQp4PC1pbmdyZXNvX2hpam9nX2UxNl9lbW92aVtbMzMyXV0kaW5nX21lbl9wX2hbMV0Kc3VtKGluZ3Jlc29faGlqb2dfZTE2X2Vtb3ZpW1szMzJdXSRpbmdfbWVuX3BfaFtbMV1dLG5hLnJtID0gVFJVRSkKYGBgCiMjIEZpbHRyYW1vcyBzb2JyZSBpbmdyZXNvcyBlbmNvbnRyYWRvcwoKYGBge3IgZmlsX2luZ3JlX2VuY19lMTZfZW1vdml9CgpMIDwtIGMoKQpmb3IoaSBpbiAxOmxlbmd0aChpbmdyZXNvX2hpam9nX2UxNl9lbW92aSkpewogIGlmKHN1bShpbmdyZXNvX2hpam9nX2UxNl9lbW92aVtbaV1dJGluZ19tZW5fcF9oW1sxXV0sbmEucm0gPSBUUlVFKT09MCl7CiAgICBMPC1jKEwsaSl9Cn0KbGVuZ3RoKEwpCgppbmdyZXNvX2hpam9nX2UxNl9lbW92aTwtaW5ncmVzb19oaWpvZ19lMTZfZW1vdmlbLUxdCgpsZW5ndGgoaW5ncmVzb19oaWpvZ19lMTZfZW1vdmkpCmluZ3Jlc29faGlqb2dfZTE2X2Vtb3ZpWzFdCmluZ3Jlc29faGlqb2dfZTE2X2Vtb3ZpWzJdCgoKaW5ncmVzb19oaWpvZ19lMTZfZW1vdmlmPC1iaW5kX3Jvd3MoaW5ncmVzb19oaWpvZ19lMTZfZW1vdmlbMTpsZW5ndGgoaW5ncmVzb19oaWpvZ19lMTZfZW1vdmkpXSkKCgpucm93KGluZ3Jlc29faGlqb2dfZTE2X2Vtb3ZpZikKCnNhdmVSRFMoaW5ncmVzb19oaWpvZ19lMTZfZW1vdmlmLCBmaWxlPSJEYXRvcy9pbmdyZXNvX2hpal9mX2Vtb3ZpLlJkYSIpCmBgYAoKIyBIaWpvcyBjb24gaW5ncmVzbwoKYGBge3IgZmlsdHJvX2hpam9zX3lhX2luZ3Jlc299Cmhpam9zX2Vtb3ZpX2hwIDwtIHJlYWRSRFMoZmlsZT0iRGF0b3MvaW5ncmVzb19oaWpfZl9lbW92aS5SZGEiKQoKbnJvdyhoaWpvc19lbW92aV9ocCkKaGlqb3NfZW1vdmlfaHAgCiMgcDA1IGVkYWQgYWN0CiMgcDA2IHNleG8gYWN0CiMgcDEzIGVkdWMgaGlqbwojIFNJTkNPMywgb2N1cGFjacOzbiBoaWpvCiMgcDIzIGVuIHFldSBlc3RhZG8gdml2aWEgYSBsb3MgMTQKIyBwMjYgcHJpbmNpcGFsIHNvc3RlbiBlY8OzbWljbwojIHAzOF8xMSBlZGFkIHBhZHJlIDIwMTYKIyBwMzhtXzExIGVkYWQgbWFkcmUgMjAxNgojIHA0MyBuaXZlbCBlZHVjYXRpdm8gcGFkcmUKI3A0M20gbml2ZWwgZWR1Y2F0aXZvIG1hZHJlCiMgY21vMV8yIG9jdXBhY2lvbiBkZWwgcGFkcmUKIyBjbW8yXzIgb2N1cGFjaW9uIGRlIGxhIG1hZHJlIAoKCnZhcnA8LWMoIkVzdGFkbyIsInAwNSIsInAwNiIsInAxMyIsIlNJTkNPMyIsInAyMyIsInAyNiIsInAzOF8xMSIsInAzOG1fMTEiLCJwNDMiLCJwNDQiLAogICAgICAgICJwNDNtIiwicDQ0bSIsImNtbzFfMiIsImNtbzJfMiIsIm1vdiIsCiAgICAgICAgInJlZ2lvbiIsInAxMzMiKQpwYWRyZXNfaDwtZGF0YV9lbW92aTIwMTclPiUKICAgIGZpbHRlcihwMDIgPT0gMSkgICU+JSAjY29tcGFydGlyIGdhc290IHBhcmEgY29tZXIKICBmaWx0ZXIoYmV0d2VlbihwMDUsMjUsNDApKSAlPiUgIyBlZGFkCiAgI2ZpbHRlcihwMDggPT0gMSkgICU+JSAKICBmaWx0ZXIocDEyID09IDIpICAlPiUjIHlhIG5vIGVzdHVkaWEKICBmaWx0ZXIocDI2ID09IDEgfCBwMjY9PTIgKSAlPiUgIyBzb3N0ZW4gcHJpbmNpcGFsIHBhcGEsIG1hbWEsIAogICBmaWx0ZXIoKCFpcy5uYShwNDMpICYgcDQzIT05OCAmIHAyNiA9PSAxICl8CiAgICAgICAgICAgICghaXMubmEocDQzbSkgJiBwNDNtIT05OCAgJiBwMjYgPT0gMiApKSAlPiUgIyByZXBvcnRhIGVkdWNhY2nDs24gZGUgcHAKICAgZmlsdGVyKCFpcy5uYShwMTMpKSU+JSAjICByZXBvcnRhIGVkdWNhY2nDs24KICBmaWx0ZXIoU0lOQ08zICE9IiIpICU+JSMgcmVwb3J0YSBvZmljaW8gYWN0dWFsCiAgIGZpbHRlcihwNjggPT0gMSB8IHA2OSA9PSAxKSAgJT4lICMgc2kgdHJhYmFqYQogICBmaWx0ZXIocDEzMiAlaW4lIGMoMSkpICU+JSMgcGVyc29uYSBxdWUgYXBvcnRhbiBpbmdyZXNvCiAgZmlsdGVyKCFwMTMzICVpbiUgYyg4LDksTkEpICklPiUKICBzZWxlY3QodmFycCklPiUKICBzbGljZShhcy5pbnRlZ2VyKHVubGlzdChoaWpvc19lbW92aV9ocCU+JXNlbGVjdChpZF9oaWpvKSkpKSU+JQogIG11dGF0ZSgKICAgICAgICAgcHBfaWRfaGlqbyA9IGhpam9zX2Vtb3ZpX2hwJT4lcHVsbChpZF9oaWpvKSwKICAgICAgICAgaW5nX2ggPSBoaWpvc19lbW92aV9ocCU+JXB1bGwoaW5nX21lbl9wX2gpLAogICAgICAgICBjb2hvcnQgPSBpZmVsc2UocDEzMz09MSwyLHAxMzMpLTEKICAgICAgICAgKSU+JQogIHJlbmFtZSgKICAgICAgICAgIGVkYWRfaCA9IHAwNSwKICAgICAgICAgIHNleG9faCA9IHAwNiwKICAgICAgICAgIGVkdV9oID0gcDEzLAogICAgICAgICAgb2N1X2ggPSBTSU5DTzMsCiAgICAgICAgICBwcF9lc3RhZG8gPSBwMjMsCiAgICAgICAgICBwcCA9IHAyNiwKICAgICAgICAgIHBfZWRhZF8yMDE2PSBwMzhfMTEsCiAgICAgICAgICBtX2VkYWRfMjAxNiA9IHAzOG1fMTEsCiAgICAgICAgICBwX2VkdSA9IHA0MywKICAgICAgICAgIHBfZWR1ZyA9IHA0NCwKICAgICAgICAgIG1fZWR1ID0gcDQzbSwKICAgICAgICAgIG1fZWR1ZyA9IHA0NG0sCiAgICAgICAgICBwX29jdSA9IGNtbzFfMiwKICAgICAgICAgIG1fb2N1ID0gY21vMl8yCiAgICAgICAgICklPiUKICBtdXRhdGUoCiAgICAgICAgcF9lZHUgPSBhcy5pbnRlZ2VyKHBfZWR1KSwKICAgICAgICBtX2VkdSA9IGFzLmludGVnZXIobV9lZHUpCiAgKQogIAogCiMgbGFzIG9jdXBhY2lvbmVzIG5vIGVuY29udHJhZGFzIGxhcyBzdXN0aXR1aW1vcyBwb3IgdW4gTkEKcGFkcmVzX2g8LXBhZHJlc19oJT4lCiAgbXV0YXRlKHBfb2N1ID0gaWZlbHNlKHBfb2N1PT0iLiIsTkEscF9vY3UpLAogICAgICAgICBtX29jdSA9IGlmZWxzZShtX29jdT09Ii4iLE5BLG1fb2N1KSkKCnVuaXF1ZShwYWRyZXNfaCRwX29jdSkKdW5pcXVlKHBhZHJlc19oJG1fb2N1KQpoZWFkKHBhZHJlc19oKQoKYGBgCgojIyBDcmVhciBiYXNlIGxpbXBpYQoKYGBge3IgYmFzZV9saW1faF9pbmd9CgoKZmlsdHJvX3BwX2M8LWZ1bmN0aW9uKGRmXzEsZ2VuZXJhbCA9IDApCnsKICAjcmVjaWJlIHVuIGhpam8gZGUgdW4gZGF0YWZyYW1lLCBwYXJhIHBvbGltb3JmaXNtbwogICMgZ2VuZXJhbCA9IDB5IHJlZ3Jlc2EgdW4gZGF0YSBmcmFtZSBjb24gbG9zIGRhdG9zCiAgIyBvcmRlbmFkb3MgZGVsIGhpam8KICBpZihkZl8xWyJwcCJdPT0xKQogIHsKICAgIGRmbiA8LSBkZl8xJT4lCiAgICAgICAgICBmaWx0ZXIocHA9PTEpJT4lCiAgICAgICAgICBzZWxlY3Qoc3RhcnRzX3dpdGgoYygicHAiLCJwXyIpKSwKICAgICAgICAgICAgIGluZ19oLGVkdV9oLG9jdV9oLGVkYWRfaCxwX2VkYWRfMjAxNiwKICAgICAgICAgICAgIHJlZ2lvbixjb2hvcnQpJT4lCiAgICAgICAgICBtdXRhdGUocHBfZWRhZDIwMTYgPSBwX2VkYWRfMjAxNiklPiUKICAgICAgICAgIHJlbmFtZSgKICAgICAgICAgICAgaWRfaGlqbyA9IHBwX2lkX2hpam8sCiAgICAgICAgICAgIHBwX3NleG8gPSBwcCwKICAgICAgICAgICAgcHBfZWRhZCA9IHBfZWRhZF8yMDE2LAogICAgICAgICAgICBwcF9lZHVjID0gcF9lZHUsCiAgICAgICAgICAgIHBwX2VkdWNnID0gcF9lZHVnLAogICAgICAgICAgICBwcF9vY3VwID0gcF9vY3UKICAgICAgICAgICklPiUKICAgICAgICBtdXRhdGUocHBfZWRhZCA9IHBwX2VkYWQgKyAoMTQtZWRhZF9oKSkKICB9CiAgaWYoZGZfMVsicHAiXT09MikKICAgIHsKICAgIGRmbjwtZGZfMSU+JQogICAgICAgIGZpbHRlcihwcD09MiklPiUKICAgICAgICBzZWxlY3Qoc3RhcnRzX3dpdGgoYygicHAiLCJtXyIpKSxpbmdfaCxlZHVfaCwKICAgICAgICAgICAgb2N1X2gsZWRhZF9oLG1fZWRhZF8yMDE2LAogICAgICAgICAgICByZWdpb24sY29ob3J0KSU+JQogICAgICAgbXV0YXRlKHBwX2VkYWQyMDE2ID0gbV9lZGFkXzIwMTYpJT4lCiAgICAgICAgcmVuYW1lKAogICAgICAgICAgaWRfaGlqbyA9IHBwX2lkX2hpam8sCiAgICAgICAgICBwcF9zZXhvID0gcHAsCiAgICAgICAgICBwcF9lZGFkID0gbV9lZGFkXzIwMTYsCiAgICAgICAgICBwcF9lZHVjID0gbV9lZHUsCiAgICAgICAgICBwcF9lZHVjZyA9IG1fZWR1ZywKICAgICAgICAgIHBwX29jdXAgPSBtX29jdQogICAgICAgICklPiUKICAgICAgICBtdXRhdGUocHBfZWRhZCA9IHBwX2VkYWQgKyAoMTQtZWRhZF9oKSkKICB9CiAgaWYoaXMubmEoZGZuJHBwX2VkYWQpICYgZ2VuZXJhbCl7CiAgICByZXR1cm4oIk5EIikKICB9CiAgcmV0dXJuKGRmbikKfQoKI2NvbXBvcmJhbW9zIHFldSBmdW5jaW9uZSBiaWVuCmZpbHRyb19wcF9jKHBhZHJlc19oWzEsXSkKCgphY29tb2RhX2RmX2M8LWZ1bmN0aW9uKGRmKXsKICAjZGFtb3MgdW4gZGYgZGUgdW5hIGVkYWQsICB5CiAgIyBub3MgcmVncmVzYSB1biBkYXRhIGZyYW1lIGFjb21vZGFkbwogIGF1eDwtZnVuY3Rpb24oaSl7CiAgICByZXR1cm4oZGZbaSxdKQogIH0KICBhPC1sYXBwbHkoMTpucm93KGRmKSxhdXgpCiAgTDwtbGFwcGx5KGEsZmlsdHJvX3BwX2MpCiAgZGZuIDwtYmluZF9yb3dzKExbMTpsZW5ndGgoTCldKQogIHJldHVybihkZm4pCn0KCmRmaDwtYWNvbW9kYV9kZl9jKHBhZHJlc19oKQoKCgpwcm9fZWRhZF9jIDwtIGZ1bmN0aW9uKGRmKXsKICAjbGUgZGFtb3MgZWwgZGYgeSBub3MgcmVncmVzYSBlbCBwcm9tZWRpbyBkZSBsYSBlZGFkZSAgbG9zIHBhZHJlcwogIGRmJT4lc3VtbWFyaXNlKAogICAgcHJvbWVkaV9lZGFkX3BhZHJlcyA9IG1lYW4ocHBfZWRhZDIwMTYsbmEucm09VFJVRSkpCiAgfQoKZWRhZGVzX3BybzwtIHByb19lZGFkX2MoZGZoKQoKZWRhZGVzX3BybwojZWRhZGVzIGRlIHBhZHJlcyBmYWx0YW50ZXMKc3VtKGlzLm5hKGRmaCRwcF9lZGFkMjAxNikpCiMgCmhlYWQoZGZoKQoKIyAyMDE2LTIxCmBgYAojIyBDb2RpZmljYWNpb24gZWR1YWNpw7NuCgoKYGBge3IgY29kX2VkdV9oaWpvfQoKZGZoX2M8LSBkZmglPiUKICAgbXV0YXRlKAogICBwcF9lZHVjX2EgPSBpZmVsc2UocHBfZWR1Yz09MSwxLCAgICAjc2luIGluc3RydWNjaW9uKDEpCiAgICAgICAgICBpZmVsc2UocHBfZWR1Yz09MiwxK3BwX2VkdWNnLAogICAgICAgICAgaWZlbHNlKHBwX2VkdWMgJWluJSBjKDMsNCksNytwcF9lZHVjZywKICAgICAgICAgIGlmZWxzZShwcF9lZHVjICVpbiUgYyg1LDYsNyw4LDkpLDEwK3BwX2VkdWNnLAogICAgICAgICAgaWZlbHNlKHBwX2VkdWMgJWluJSBjKDEwLDExKSwxMytwcF9lZHVjZywxNytwcF9lZHVjZykpKSkpCiAgKQoKICAKCnVuaXF1ZShkZmhfYyRwcF9lZHVjX2EpCgpkZmhfYzwtZGZoX2MlPiUKICBtdXRhdGUoCiAgIHBwX2VkdWNfYWMgPSBpZmVsc2UocHBfZWR1Y19hICVpbiUgMDo1LCJDMSIsICAgIAogICAgICAgICAgaWZlbHNlKHBwX2VkdWNfYSAlaW4lIDY6MTAgLCJDMiIsCiAgICAgICAgICBpZmVsc2UocHBfZWR1Y19hICVpbiUgMTE6MTIsIkMzIiwKICAgICAgICAgIGlmZWxzZShwcF9lZHVjX2EgJWluJSAxMzoxNCwiQzQiLCJDNSIpKSkpCiAgKQoKYGBgCgojIFBhZHJlcyBjb25zdHJ1Y2Npw7NuIGluZ3Jlc29zCgpTZWxlY2Npb25hbW9zIGRlIGxhIEVOSUdIIDE5OTcsIG5vIGhheSBlbnRvbmNlcyAxOTk4CgojIyBQb2JsYWNpb24gZW5pZ2ggOTgKCmBgYHtyIHBvYmxhY2lvbl9lOTh9Cgpwb2JsYWNpb248LXJlYWQuZGJmKAogICAgICAgICAgICAgIGZpbGU9IkRhdG9zL0VOSUdILUhpc3RvcmljYS8xOTk4L1BPQkxBOTguZGJmIgogICAgICAgICAgICAgICkKCgoKcG9ibGFjaW9uX2U5ODwtcG9ibGFjaW9uJT4lCiAgZmlsdGVyKAogICAgcGFyZW50ZXNjbyA9PSAiMDEiLAogICAgYmV0d2VlbihlZGFkLDMwLDUwKSwKICAgICFpcy5uYShlZF9mb3JtYWwpLAogICAgIWlzLm5hKGVkX3RlY25pY2EpLAogICAgIWlzLm5hKG9jdXBhY2lvbiksCiAgICBuX2VtcGxlb3M9PTEsICMgZWwgZW50cmV2aXN0YWRvIHNvbG8gcHJvcG9yY2lvbmEgdW5hIG9jdXBhY2nDs24KICApJT4lCiAgc2VsZWN0KAogICAgZm9saW8sCiAgICBudW1fcmVuLAogICAgZWRhZCwKICAgIGVkX2Zvcm1hbCwKICAgIGVkX3RlY25pY2EsCiAgICBvY3VwYWNpb24KICApJT4lCiBtdXRhdGUoCiAgZWRfZm9ybWFsID0gYXMuaW50ZWdlcihhcy5jaGFyYWN0ZXIoZWRfZm9ybWFsKSksCiAgIGVkX3RlY25pY2E9IGFzLmludGVnZXIoYXMuY2hhcmFjdGVyKGVkX3RlY25pY2EpKSwKICBlc3RhZG8gPSBzdWJzdHIoZm9saW8sNSw2KQogKQoKI3VuaXF1ZShwb2JsYV9lbmlnaDE5OTgkZWRfZm9ybWFsKQojcG9ibGFfZW5pZ2gxOTk4JGVkX2Zvcm1hbApucm93KHBvYmxhY2lvbl9lOTgpCmhlYWQocG9ibGFjaW9uX2U5OCRlZF9mb3JtYWwpCnN0cihwb2JsYWNpb25fZTk4JGVkX2Zvcm1hbCkjY2FyYWN0ZXIgMiBlc3BhY2lvcwp1bmlxdWUocG9ibGFjaW9uX2U5OCRlZF9mb3JtYWwpCiNwb2JsYV9lbmlnaDE5OTgkZWRfZm9ybWFsPT0iMDMiCmhlYWQocG9ibGFjaW9uX2U5OCRlZF90ZWNuaWNhKQpzdHIocG9ibGFjaW9uX2U5OCRlZF90ZWNuaWNhKSNjYXJhY3RlciAxIGVzcGFjaW8KdW5pcXVlKHBvYmxhY2lvbl9lOTgkZWRfdGVjbmljYSkKI3BvYmxhX2VuaWdoMTk5OCU+JWNvdW50KG5fZW1wbGVvcyksIHNlIGV4cGxvcm8gcGFyYSBxdWl0YXIgdW5hIG9jdXBhY2lvbgpuYW1lcyhwb2JsYWNpb24pCnN0cihwb2JsYWNpb24kcGVyX2luZykKYGBgCgojIyMgQ29kaWZpY2FjacOzbiBlZHVjYWNpw7NuIGVuaWdoIDE5OTgKCmBgYHtyIGNvZF9lZF9lOTh9CiMgaGFjZW1vcyBsYSBjb2RpZmljYWNpw7NuIGRlIEVOSUdIMjAxOCBhIEVTUlUKIzEJUHJlZXNjb2xhciBvIGvDrW5kZXIKIyAyCVByaW1hcmlhCiMgMwlTZWN1bmRhcmlhIHTDqWNuaWNhCiMgNAlTZWN1bmRhcmlhIGdlbmVyYWwKIyA1CVByZXBhcmF0b3JpYSB0w6ljbmljYQojIDYJUHJlcGFyYXRvcmlhIGdlbmVyYWwKIyA3CVTDqWNuaWNhIG8gY29tZXJjaWFsIGNvbiBzZWN1bmRhcmlhCiMgOAlUw6ljbmljYSBvIGNvbWVyY2lhbCBjb24gcHJlcGFyYXRvcmlhCiMgOQlOb3JtYWwgYsOhc2ljYSAoY29uIHByaW1hcmlhIG8gc2VjdW5kYXJpCiMgMTAgTm9ybWFsIGRlIGxpY2VuY2lhdHVyYQojIDExIFByb2Zlc2lvbmFsIChsaWNlbmNpYXR1cmEgbyBpbmdlbmllcsOtYSkKIyAxMiBQb3N0Z3JhZG8gKG1hZXN0csOtYSBvIGRvY3RvcmFkbykKI19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fCiMgOTggTlMsIG5vIGFwbGljYSBwb3JxdWUgcGVkaW1vcyBsYSBlZHVjacOzbiBkZWwgcHAgY29tbyBpbnN0cnVtZW50bwoKCiMgdmVtc28gbGFzIGNvbWJpbmFjaW9uZXMgZGUgZWR1Y2FjacOzbiBwYXJhIGNvZGlmaWNhcgoKY29tYjwtcG9ibGFjaW9uX2U5OCU+JQogICBtdXRhdGUoIGNvbWJpID0gcGFzdGUoYXMuY2hhcmFjdGVyKGVkX2Zvcm1hbCksYXMuY2hhcmFjdGVyKGVkX3RlY25pY2EpKSklPiUKICBzZWxlY3QoZWRfZm9ybWFsLGVkX3RlY25pY2EsY29tYmkpCgogIApzb3J0KHVuaXF1ZShjb21iJGNvbWJpKSkKIyBbMV0gIjAxIDEiICIwMiAxIiAiMDMgMSIgIjAzIDIiICIwNCAxIiAiMDUgMSIgIjA2IDEiICIwNyAxIiAiMDcgMiIgIjA4IDEiCiMgWzExXSAiMDggMiIgIjA4IDMiICIwOCA0IiAiMDggNSIgIjA5IDEiICIwOSA0IiAiMDkgNSIgIjEwIDEiICIxMCAyIiAiMTAgNCIKIyBbMjFdICIxMCA1IiAiMTEgMSIgIjExIDMiICIxMSA0IiAiMTEgNSIgIjExIDYiICIxMSA3IiAiMTIgMSIgIjEyIDMiICIxMiA1IgojIFszMV0gIjEyIDYiICIxMiA3IiAiMTMgMSIgIjEzIDUiICIxMyA2IiAiMTMgNyIgIjEzIDgiICIxMyA5IiAiMTQgMSIgIjE0IDMiCiMgWzQxXSAiMTQgNSIgIjE0IDYiICIxNCA3IiAiMTQgOSIgIjE1IDEiICIxNSAzIiAiMTUgNCIgIjE1IDUiICIxNSA2IiAiMTUgNyIKIyBbNTFdICIxNSA5IiAiMTYgMSIgIjE2IDUiICIxNiA3IiAiMTYgOSIKCgoKCiMgIjE2IDEiICIxNiA1IiAiMTYgNyIgIjE2IDkiCgojY29kaWZpY2Ftb3MgYSBhIGHDsW9zIGRlIGVkdWNhY2nDs24KcG9ibGFjaW9uX2U5OGM8LXBvYmxhY2lvbl9lOTglPiUKICAgbXV0YXRlKAogICBlZHVfYSA9IGlmZWxzZShlZF9mb3JtYWw9PTEgJiBlZF90ZWNuaWNhPT0xLDAsICAgICNzaW4gaW5zdHJ1Y2Npb24oMSkKICAgICAgICAgIGlmZWxzZSgoZWRfZm9ybWFsICVpbiUgYygyLDMsNCw1LDYsNyw4LDksMTAsMTEsMTIsMTMpKQogICAgICAgICAgICAgICAgICYgKGVkX3RlY25pY2EgJWluJSBjKDEsMikpLGVkX2Zvcm1hbC0xLAogICAgICAgICAgaWZlbHNlKGVkX2Zvcm1hbD09OCAmIChlZF90ZWNuaWNhICVpbiUgYygzLDQsNSkpLDksCiAgICAgICAgICBpZmVsc2UoZWRfZm9ybWFsPT05ICYgKGVkX3RlY25pY2EgJWluJSBjKDQsNSkpLDEwLAogICAgICAgICAgaWZlbHNlKGVkX2Zvcm1hbD09MTAgJiAoZWRfdGVjbmljYSAlaW4lIGMoMiw0LDUpKSwxMSwKICAgICAgICAgIGlmZWxzZShlZF9mb3JtYWw9PTExICYgKGVkX3RlY25pY2EgJWluJSBjKDMsNCw1LDUsNykpLDEyLAogICAgICAgICAgaWZlbHNlKChlZF9mb3JtYWwgJWluJWMoMTIpKSAmIChlZF90ZWNuaWNhICVpbiUgYygzLDUsNiw3KSksMTIsCiAgICAgICAgICBpZmVsc2UoZWRfZm9ybWFsPT0xMyAmIChlZF90ZWNuaWNhICVpbiUgYyg1LDYsNyw4LDkpKSwxMywKICAgICAgICAgIGlmZWxzZShlZF9mb3JtYWw9PTE0ICYgKGVkX3RlY25pY2EgJWluJSBjKDEsMyw1LDYsNyw5KSksMTQsCiAgICAgICAgICBpZmVsc2UoZWRfZm9ybWFsPT0xNSAmIChlZF90ZWNuaWNhICVpbiUgYygxLDMsNCw1LDYsNyw5KSksMTcsMTkpKSkpKSkpKSkpCiAgKQoKdW5pcXVlKHBvYmxhY2lvbl9lOThjJGVkdV9hKQoKI2NvZGlmaWNhbW9zIGEgY29naG9ydCBkZSBlZHVjYWNpw7NuCgpwb2JsYWNpb25fZTk4YzwtcG9ibGFjaW9uX2U5OGMlPiUKICAgbXV0YXRlKAogICBlZHVfYWMgPSBpZmVsc2UoZWR1X2EgJWluJSAwOjUsIkMxIiwgICAgCiAgICAgICAgICBpZmVsc2UoZWR1X2EgJWluJSA2OjEwICwiQzIiLAogICAgICAgICAgaWZlbHNlKGVkdV9hICVpbiUgMTE6MTIsIkMzIiwKICAgICAgICAgIGlmZWxzZShlZHVfYSAlaW4lIDEzOjE0LCJDNCIsIkM1IikpKSkKICApCgp1bmlxdWUocG9ibGFjaW9uX2U5OGMkZWR1X2FjICkKCgpgYGAKCiMjIyBDcmVhY2lvbiBkZSByZWdpb24KYGBge3IgY3JlYV9yZWdpb25fZTk4fQoKcG9ibGFjaW9uX2U5OGM8LXBvYmxhY2lvbl9lOThjJT4lCiAgICAgICAgICBtdXRhdGUoCiAgICAgICAgICAgIHJlZ2lvbiA9IGlmZWxzZShlc3RhZG8gJWluJSBjKCIwMiIsIjI2IiwiMDgiLCIwNSIsIjE5IiwiMjgiKSwxLAogICAgICAgICAgICAgICAgaWZlbHNlKGVzdGFkbyAlaW4lIGMoIjEyIiwiMjAiLCIwNyIsIjMwIiwiMjciLCIwNCIsIjMxIiwiMjMiKSw1LDApKQogICAgICAgICAgKQpgYGAKCgojIyBJbmdyZXNvcyBlbmlnaCA5OAoKCmBgYHtyIGluZ3Jlc29zX2U5OH0KaW5ncmVzb3M8LXJlYWQuZGJmKAogICAgICAgICAgICAgIGZpbGU9IkRhdG9zL0VOSUdILUhpc3RvcmljYS8xOTk4L2luZ3Jlc29zLmRiZiIKICAgICAgICAgICAgICApCgpmYW1pbGlhc19pbnRlZ3JhbnRlcyA8LSBmdW5jdGlvbihkZixucil7CiAgZGZuIDwtIGRmICU+JQogICAgZmlsdGVyKE5VTV9SRU4gJWluJSBucikKICByZXR1cm4oZGZuKQp9IAoKCgppbmdyZXNvc19hY3UgPC0gZnVuY3Rpb24oZGYsY2xhdnMpewogZGZuIDwtIGRmICU+JQogICBncm91cF9ieShGT0xJTywgTlVNX1JFTikgJT4lCiAgIGZpbHRlcihDTEFWRSAlaW4lIGNsYXZzKSU+JQogICBzdW1tYXJpc2UoCiAgIGNsYXZlc19hID0gcGFzdGUoQ0xBVkUsY29sbGFwc2UgPSAiLCIpLAogIGluZ190cmlfdCA9IHN1bShJTkdfVFJJKSwKICBpbmdfbWVuX3AgPSBpbmdfdHJpX3QvMywKICBsaW5nX21lbl9wID0gbG9nKGluZ19tZW5fcCkKICApICU+JSB1bmdyb3VwKCkKIAogCiByZXR1cm4oZGZuKQp9CgojaG9nYXJlcyA8LSBjKCIxIiwiMiIsIjMiLCI0IiwiNSIpCnBlcnNvbmFzX2ggPC0gYygnMDEnKQoKYTwtZmFtaWxpYXNfaW50ZWdyYW50ZXMoaW5ncmVzb3MscGVyc29uYXNfaCkKaGVhZChhKQpjbGF2ZXM8LWMoIlAwMDEiLCJQMDAyIiwiUDAwMyIsIlAwMTAiLCJQMDExIiwiUDAxMiIsIlAwMTMiLCJQMDE0IiwiUDAxNSIsICJQMDE2IiwiUDAxNyIsIlAwMTgiLCJQMDIwIiwiUDAyMSIsIlAwMjYiLCJQMDI3IiwiUDAzNSIsIlAwNDAiLCJQMDQxIiwiUDA0MiIsIlAwNDQiLCJQMDQ1IikKaW5ncmVzb3NfZTk4PC1pbmdyZXNvc19hY3UoYSxjbGF2ZXMpIAppbmdyZXNvc19lOTg8LWluZ3Jlc29zX2U5OCU+JQogIHNlbGVjdChGT0xJTyxOVU1fUkVOLGNsYXZlc19hLGxpbmdfbWVuX3ApJT4lCiAgcmVuYW1lKAogICAgZm9saW8gPSBGT0xJTywKICAgIG51bV9yZW4gPSBOVU1fUkVOCiAgKQpoZWFkKGluZ3Jlc29zX2U5OCkKCmBgYAoKIyMgQmFzZSBjcnV6YWRhIHBvYmxhLWluZwoKYGBge3IgYmFzZV9jcnV6X2U5OH0KCmVuaWdoXzk4PC1mdWxsX2pvaW4ocG9ibGFjaW9uX2U5OGMsaW5ncmVzb3NfZTk4KSU+JQogIGRyb3BfbmEoKSU+JQogICBtdXRhdGUoCiAgICAgb2N1cGFjaW9uID0gc3Vic3RyKG9jdXBhY2lvbiwxLDIpCiAgICkjJT4lCiAgIyByZW5hbWUoCiAgIyAgIEVEVT1OX0lOU1RSMTYxLAogICMgICBPQ1UgPSBDTU8xMjEKICAjICklPiUKICAjIG11dGF0ZSgKICAjICAgRURVID0gYXMuY2hhcmFjdGVyKEVEVSkKICAjICkKaGVhZChlbmlnaF85OCkKCnVuaXF1ZShlbmlnaF85OCRlZGFkKQoKIyBhanVzdGUgcGFyYSBuaXZlbCBkZSBlY3VjYWNpw7NuIEVTUlUKCiNkYXRhX3BhZHJlczIwMDUkRURVIDwtIGZhY3RvcihkYXRhX3BhZHJlczIwMDUkRURVKQojZGF0YV9wYWRyZXMyMDA1JE9DVSA8LSBmYWN0b3IoZGF0YV9wYWRyZXMyMDA1JE9DVSkKCiN1bmlxdWUoZGF0YV9wYWRyZXMyMDA1JE9DVSkKc3VtKGlzLm5hKGVuaWdoXzk4KSkKYGBgCgojIEVzbGF0aWNpZGFkIGludGVnZW5lcmFjaW9uYWwgZGUgaW5ncmVzb3MKCgojIyBEZWZsYWN0YW1vcyBpbmdyZXNvcwoKSU5QQyBGZWIgMjAyMSA9IDExMC45MDcgW0NvbnN1bHRhXVtdCgoKYGBge3J9CklOUEM8LTExMC45MDcKCmVuaWdoXzk4PC1lbmlnaF85OCU+JQogIG11dGF0ZSgKICBsaW5nX21lbl9wPWxpbmdfbWVuX3AtbG9nKElOUEMpCiAgKQpgYGAKClBvciBsYSBwb3JncmFtYWNpw7NuLCBwYXJhIGxvcyBoaWpvcywgc2UgaGFjZSBkZW50cm8gZGVsIHNpZ3VlaW50ZSBwcm9ncmFtYSAKCiAgW0NvbnN1bHRhXTogaHR0cHM6Ly93d3cuYmFueGljby5vcmcubXgvU2llSW50ZXJuZXQvY29uc3VsdGFyRGlyZWN0b3Jpb0ludGVybmV0QWN0aW9uLmRvP2FjY2lvbj1jb25zdWx0YXJDdWFkcm8maWRDdWFkcm89Q1AxNTQmbG9jYWxlPWVzCgoKCgojIyBFc3RpbWFjacOzbgoKU2luIGNvbnRyb2xhciBwb3Igb2N1cGFjacOzbiBkZWwgaGlqbwoKCmBgYHtyIGZ1bl9wcmluX2VpaX0KZWlpPC1mdW5jdGlvbihpKXsKICAKICAKCiMgQk9PU1RSQVAgIAojIFJlZ3Jlc2nDs24gZGUgaW5ncmVzb3MgZGUgcGFkcmVzICAKcmVnX3BhZHJlczwtbG0oCiAgZm9ybXVsYSA9IGxpbmdfbWVuX3AgfiBlZHVfYWMgKyBvY3VwYWNpb24gKyBlZGFkICtJKGVkYWQqZWRhZCksCiAgZGF0YSA9IGVuaWdoXzk4W3NhbXBsZShucm93KGVuaWdoXzk4KSxucm93KGVuaWdoXzk4KSwgcmVwbGFjZSA9IFRSVUUpLF0KKQoKI3N1bW1hcnkocmVnX3BhZHJlcykKCiMgbnVtZXJvIGRlIHBhZHJlcyBzaW4gb2N1cGFjacOzbiByZXBvcnRhZGEgZGUgaGlqb3MKcF9zb2N1PC1zdW0oaXMubmEoZGZoX2MkcHBfb2N1cCkpCiNwX3NvY3UKCgpkZmhfY25hPC1kZmhfYyU+JWRyb3BfbmEocHBfb2N1cCkKCiMgZGFmcmFtZSBwYXJhIGVzdGltYXIgaW5ncmVzbyBwYWRyZXMKZGF0YTwtIGRhdGEuZnJhbWUoCiAgIGVkdV9hYz0gZGZoX2NuYSRwcF9lZHVjX2FjLAogICBvY3VwYWNpb249IGRmaF9jbmEkcHBfb2N1cCwKICAgZWRhZCA9IDAKICApCgojIEJPT1NUUkFQIGluZ3Jlc28gSElKT1MKCiMgY2FsY3VsYW1vcyBlbCBpbmdyZXNvIGRlIGxvcyBoaWpvcyBjb24gbG9zIGdlbWVsb3MKIyByZS1zYW1wbGVhZG9zLCBhZGVtYXMgY29kaWZpY2Ftb3MgbGEgb2N1cGFjacOzbiBkZWwgaGlqbyBhIGRvcyBjYXJhY3RlcmVzCgphdXhzPC1mdW5jdGlvbihrKXsKICBzYW1wbGUoayxzaXplPWxlbmd0aChrKSxyZXBsYWNlPVRSVUUpCn0KCmRmaF9jbmEgPC0gZGZoX2NuYSAlPiUKICBtdXRhdGUoCiAgIG9jdV9oYz0gc3Vic3RyaW5nKG9jdV9oLDEsMiksCiAgIGluZ19oPXVubGlzdChsYXBwbHkoCiAgICAgICAgICAgICAgICAgICAgICBsYXBwbHkoaW5nX2gsYXV4cyksCiAgICAgICAgICAgICAgICAgICAgICBtZWFuCiAgICAgICAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICApLAogICBsaW5nX2ggPSBsb2coaW5nX2gpLWxvZyhJTlBDKQogICkKCmRmaF9mPC1kZmhfY25hJT4lCiAgbXV0YXRlKGNvaG9ydF9lID0gaWZlbHNlKGluZ19oPD0yNDAwLDEsCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGluZ19oPD00ODAwLDIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGluZ19oPD03MjAwLDMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGluZ19oPD0xMjAwMCw0LCAgICAgICAgICAgICAgICAgICAgICAgICAgaWZlbHNlKGluZ19oPD0yNDAwMCw1LDYpKSkpKSwKICAgICAgICAgY29ob3J0X2RpZj1jb2hvcnQtY29ob3J0X2UpCgogIAojZGZoX2NuYQojZGZoX2NuYSRvY3VfaGlqbwojZGZoX2NuYSRsaW5nX2gKCiNzdHIoc3Vic3RyKGRmaF9jbmEkb2N1X2gsMSwyKSkKCiMgZXN0aW1hY2nDs24gaW5ncmVzbyBwYWRyZXMKIyBpbnB1dGFtb3MgYWwgaGlqbyBjb3JyZXNwb25kaWVudGUKCmRmaHBmPC0gZGZoX2YlPiUKICBtdXRhdGUobGluZ19wID0gcHJlZGljdCgKICAgIG9iamVjdCA9IHJlZ19wYWRyZXMsICAgCiAgICBuZXdkYXRhID0gZGF0YSkpIAojZGZocGYKCiMgRWxhc3RpY2lkYWQgaW50ZXJnZW5lYWNpb25hbCBkZWwgaW5ncmVzbwoKcmVnX2hwPC1sbSgKICBmb3JtdWxhID0gbGluZ19oIH4gbGluZ19wICsgZWRhZF9oKyBJKGVkYWRfaCplZGFkX2gpLCMrIG9jdV9oYywKICBkYXRhID0gZGZocGYKKQojc3VtbWFyeShyZWdfaHApCmJldGEgPC0gcmVnX2hwJGNvZWZmaWNpZW50c1syXQpjb2hvcnRfZGlmPC1hcy5pbnRlZ2VyKGRmaHBmJT4lY291bnQoY29ob3J0X2RpZiklPiUKICAgICAgICAgICAgICAgICAgIGZpbHRlcihjb2hvcnRfZGlmPT0wKSU+JQogICAgICAgICAgICAgICAgIHNlbGVjdChuKSkKCnJldHVybihkYXRhLmZyYW1lKCklPiVzdW1tYXJpc2UoCiAgY29ob3J0X2RpZj1jb2hvcnRfZGlmLAogIGJldGE9YmV0YSkpCgp9CnNldC5zZWVkKDEyMykKYTwtbGFwcGx5KDE6MTUwMCxlaWkpCnJlc3VsPC1iaW5kX3Jvd3MoYVsxOmxlbmd0aChhKV0pCmhlYWQocmVzdWwpCm1lYW4ocmVzdWwkYmV0YSkKc2QocmVzdWwkYmV0YSkKaGlzdChyZXN1bCRiZXRhKQpgYGAKCgpgYGB7ciBoaXRfbjB9Cmhpc3QocmVzdWwkY29ob3J0X2RpZikKbWVhbihyZXN1bCRjb2hvcnRfZGlmKQoKYGBgCgoKCg==</div>


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeSourceEmbed("Estimacion.Rmd");
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
